{"version":3,"sources":["FreeResources/FreeResources.ts"],"names":[],"mappings":"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","file":"FreeResources.js","sourcesContent":["import { isAbsolute } from \"sparqler/iri\";\nimport { Context } from \"../Context/Context\";\nimport { IllegalArgumentError } from \"../Errors/IllegalArgumentError\";\n\nimport { GeneralRegistry } from \"../GeneralRegistry/GeneralRegistry\";\n\nimport { ModelDecorator } from \"../Model/ModelDecorator\";\nimport { ModelFactory } from \"../Model/ModelFactory\";\nimport { ModelPrototype } from \"../Model/ModelPrototype\";\nimport { ModelTypeGuard } from \"../Model/ModelTypeGuard\";\n\nimport { DigestedObjectSchema } from \"../ObjectSchema/DigestedObjectSchema\";\n\nimport { Pointer } from \"../Pointer/Pointer\";\n\nimport { RDFNode } from \"../RDF/Node\";\nimport { URI } from \"../RDF/URI\";\n\nimport { BaseRegistry } from \"../Registry/BaseRegistry\";\nimport { Registry } from \"../Registry/Registry\";\n\nimport { Resource } from \"../Resource/Resource\";\n\nimport { BaseFreeResources } from \"./BaseFreeResources\";\n\n\n/**\n * Model that represents resources that doesn't have a context.\n */\nexport interface FreeResources extends Registry<Resource> {\n\t/**\n\t * Registry where the {@link FreeResources} scope is in.\n\t */\n\treadonly registry:GeneralRegistry<any>;\n\n\t/**\n\t * @see {@link Registry._getLocalID}\n\t */\n\t_getLocalID( id:string ):string;\n\n\t/**\n\t * @see {@link Registry._addPointer}\n\t */\n\t_addPointer<T extends object>( base:T & Partial<Pointer> ):T & Resource;\n\n\n\t/**\n\t * Returns the JSON-LD representation of the every resources inside an array.\n\t * @param contextOrKey A specific context to use for expand the data into JSON-LD instead of the internal one.\n\t */\n\ttoJSON( contextOrKey?:Context | string ):RDFNode[];\n}\n\n\nexport type OverriddenMembers =\n\t| \"_getLocalID\"\n\t| \"_addPointer\"\n\t;\n\n/**\n * Utils for {@link FreeResources}.\n */\nexport interface FreeResourcesUtils {\n\tparseFreeNodes( registry:GeneralRegistry<any>, freeNodes:RDFNode[] ):FreeResources;\n}\n\n/**\n * Factory, decorator and utils for {@link FreeResources}.\n */\nexport type FreeResourcesFactory =\n\t& ModelPrototype<FreeResources, Registry, OverriddenMembers>\n\t& ModelDecorator<FreeResources, BaseFreeResources>\n\t& ModelTypeGuard<FreeResources>\n\t& ModelFactory<FreeResources, BaseFreeResources>\n\t& FreeResourcesUtils\n\t;\n\n/**\n * Constant that implements {@link FreeResourcesFactory}.\n */\nexport const FreeResources:FreeResourcesFactory = {\n\tPROTOTYPE: {\n\t\t_getLocalID( this:FreeResources, id:string ):string {\n\t\t\tif( isAbsolute( id ) && ! URI.hasProtocol( id ) ) return id;\n\t\t\tthrow new IllegalArgumentError( `\"${id}\" is out of scope.` );\n\t\t},\n\n\t\t_addPointer<T extends object>( this:FreeResources, base:T & Partial<Pointer> ):T & Resource {\n\t\t\tif( ! base.$id ) base.$id = URI.generateBNodeID();\n\t\t\ttype FilledID = typeof base & { $id:string };\n\t\t\treturn Registry.PROTOTYPE._addPointer.call( this, base as FilledID );\n\t\t},\n\n\n\t\ttoJSON( this:FreeResources, contextOrKey?:Context | string ):RDFNode[] {\n\t\t\treturn this\n\t\t\t\t.getPointers( true )\n\t\t\t\t.map( resource => resource.toJSON( contextOrKey ) )\n\t\t\t\t;\n\t\t},\n\t},\n\n\n\tis( value:any ):value is FreeResources {\n\t\treturn Registry.isDecorated( value )\n\t\t\t&& FreeResources.isDecorated( value )\n\t\t\t;\n\t},\n\n\tisDecorated( object:object ):object is FreeResources {\n\t\treturn ModelDecorator\n\t\t\t.hasPropertiesFrom( FreeResources.PROTOTYPE, object );\n\t},\n\n\n\tcreate<T extends object>( data:T & BaseFreeResources ):T & FreeResources {\n\t\tconst copy:T & BaseFreeResources = Object.assign( {}, data );\n\t\treturn FreeResources.createFrom( copy );\n\t},\n\n\tcreateFrom<T extends object>( object:T & BaseFreeResources ):T & FreeResources {\n\t\treturn FreeResources.decorate( object );\n\t},\n\n\tdecorate<T extends BaseFreeResources>( object:T ):T & FreeResources {\n\t\tif( FreeResources.isDecorated( object ) ) return object;\n\n\t\tconst base:T & BaseRegistry<Resource> = Object.assign<T, Pick<FreeResources, \"__modelDecorator\">>( object, {\n\t\t\t__modelDecorator: Resource,\n\t\t} );\n\n\t\tconst resource:T & Registry<Resource> = ModelDecorator\n\t\t\t.decorateMultiple( base, Registry );\n\n\t\treturn ModelDecorator\n\t\t\t.definePropertiesFrom( FreeResources.PROTOTYPE, resource );\n\t},\n\n\n\tparseFreeNodes( this:void, registry:GeneralRegistry<any>, freeNodes:RDFNode[] ):FreeResources {\n\t\tconst freeResources:FreeResources = FreeResources\n\t\t\t.createFrom( { registry: registry } );\n\n\t\tfreeNodes\n\t\t\t.forEach( node => {\n\t\t\t\tconst digestedSchema:DigestedObjectSchema = registry.getSchemaFor( node );\n\n\t\t\t\tconst target:object = freeResources.getPointer( node[ \"@id\" ], true );\n\t\t\t\tregistry.context.jsonldConverter.compact( node, target, digestedSchema, freeResources );\n\t\t\t} );\n\n\t\treturn freeResources;\n\t},\n};\n\n"],"sourceRoot":"../../src"}