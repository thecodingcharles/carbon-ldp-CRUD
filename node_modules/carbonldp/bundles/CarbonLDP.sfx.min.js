!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CarbonLDP=t()}(this,function(){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function e(r,n){var o,i,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(r,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function t(e){return-1!==e.indexOf(":")}function a(e){return-1!==e.indexOf("://")}function r(e){return!t(e)}function o(e){return/^_:/.test(e)}function c(e){return/^(?!_:)[^]*?:/.test(e)&&!a(e)}function s(e,t){return"function"==typeof e[t]}function p(e,t){return!!e&&_(e[t])}function u(e,t){return!!e&&!!Object.getOwnPropertyDescriptor(e,t)}function _(e){return void 0!==e}function l(e){return null===e}function P(e){return Array.isArray(e)}function T(e){return"string"==typeof e||e instanceof String}function h(e){return"boolean"==typeof e}function f(e){return"number"==typeof e||e instanceof Number}function g(e){return!!f(e)&&e%1==0}function y(e){return e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function E(e){return"object"==typeof e&&!!e}function v(e){return E(e)&&!P(e)&&!y(e)&&!b(e)&&!("undefined"!=typeof Blob&&e instanceof Blob)&&!("[object Set]"===Object.prototype.toString.call(e))}function m(e){return"function"==typeof e}function b(e){return E(e)&&s(e,"get")&&s(e,"has")&&p(e,"size")&&s(e,"clear")&&s(e,"delete")&&s(e,"entries")&&s(e,"forEach")&&s(e,"get")&&s(e,"has")&&s(e,"keys")&&s(e,"set")&&s(e,"values")}function w(e){if(!T(e))return!1;switch(e.toLowerCase()){case"true":case"yes":case"y":case"1":return!0;case"false":case"no":case"n":case"0":default:return!1}}function S(t){return new Promise(function(e){return e(t?t():void 0)})}var O=function(){function e(){}return e.from=function(e){for(var t=[],r=e.next();!r.done;)t.push(r.value),r=e.next();return t},e.joinWithoutDuplicates=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e[0].slice(),n=1,o=e.length;n<o;n++)r=r.concat(e[n].filter(function(e){return r.indexOf(e)<0}));return r},e}(),C=function(){function s(){}return s.extend=function(e,t,r){if(void 0===r&&(r={arrays:!1,objects:!1}),(P(t)||v(t))&&(P(e)||v(e))){t.__CarbonSDK_circularReferenceFlag=e;for(var n=0,o=Object.keys(t);n<o.length;n++){var i=o[n];if(!m(t[i])&&"__CarbonSDK_circularReferenceFlag"!==i){var a=t[i];(P(a)&&r.arrays||v(a)&&r.objects)&&(a="__CarbonSDK_circularReferenceFlag"in a?a.__CarbonSDK_circularReferenceFlag:i in e&&e[i].constructor===a.constructor?s.extend(e[i],a,r):s.clone(a,r)),null!==a?e[i]=a:e[i]&&delete e[i]}}return delete t.__CarbonSDK_circularReferenceFlag,e}},s.clone=function(e,t){void 0===t&&(t={arrays:!1,objects:!1});var r=P(e);if(r||v(e)){var n=r?[]:Object.create(Object.getPrototypeOf(e));return s.extend(n,e,t)}},s.areEqual=function(e,t,r,n){return void 0===r&&(r={arrays:!1,objects:!1}),void 0===n&&(n={}),function e(t,r,n,o,i,a){void 0===a&&(a={});if(t===r)return!0;if(!E(t)||!E(r))return!1;if(y(t))return t.getTime()===r.getTime();var s=O.joinWithoutDuplicates(Object.keys(t),Object.keys(r));for(var u=0,c=s;u<c.length;u++){var l=c[u];if(!(l in a)){if(!(l in t&&l in r))return!1;if(typeof t[l]!=typeof r[l])return!1;if(!m(t[l])){var p=v(t[l]);if(P(t[l])&&n.arrays||p&&n.objects||y(t[l])){if(p){for(var h=o.length;h--;)if(o[h]===t[l])return i[h]===r[l];o.push(t[l]),i.push(r[l])}if(!e(t[l],r[l],n,o,i))return!1;p&&(o.pop(),i.pop())}else if(t[l]!==r[l])return!1}}}return!0}(e,t,r,[e],[t],n)},s.areShallowlyEqual=function(e,t){if(e===t)return!0;if(!E(e)||!E(t))return!1;var r=[];for(var n in e)if(e.hasOwnProperty(n)&&!m(e[n])){if(!(n in t))return!1;if(e[n]!==t[n])return!1;r.push(n)}for(var n in t)if(t.hasOwnProperty(n)&&!m(t[n])){if(!(n in e))return!1;if(-1===r.indexOf(n))return!1}return!0},s}();var x=function(){function e(){}return e.startsWith=function(e,t){return 0===e.lastIndexOf(t,0)},e.endsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},e.contains=function(e,t){return-1!==e.indexOf(t)},e}(),R=function(){function e(){}return e.from=function(e){for(var t=new Map,r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];t.set(o,e[o])}return t},e.extend=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0,o=e;n<o.length;n++){var i=o[n];i&&i.forEach(function(e,t){return r.set(t,e)})}return r},e}(),j=function(){function t(){}return t.is=function(e){return t.regExp.test(e)},t.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},t.regExp=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,t}();function F(e){return null!=e}var I=Object.freeze({hasFunction:s,hasProperty:p,hasPropertyDefined:u,isDefined:_,isNull:l,isArray:P,isString:T,isBoolean:h,isNumber:f,isInteger:g,isDouble:function(e){return!!f(e)&&e%1!=0},isDate:y,isObject:E,isPlainObject:v,isFunction:m,isMap:b,parseBoolean:w,promiseMethod:S,ArrayUtils:O,ObjectUtils:C,StringUtils:x,MapUtils:R,UUIDUtils:j,_isExistingValue:F}),D={hasPropertiesFrom:function(o,i){var e=Object.keys(o),a="$id"in i&&!e.some(function(e){return e.startsWith("$")});return e.every(function(e){var t=a?"$"+e:e,r=Object.getOwnPropertyDescriptor(o,e);if(!r)return!1;var n=Object.getOwnPropertyDescriptor(i,t);return!!n&&(m(r.value)?m(n.value):!n.enumerable)})},definePropertiesFrom:function(o,i){var e=Object.keys(o),a="$id"in i&&!e.some(function(e){return e.startsWith("$")});return e.forEach(function(e){var t=a?"$"+e:e,r=Object.getOwnPropertyDescriptor(o,e),n={enumerable:!1,configurable:!0};m(r.value)?(n.writable=!1,n.value=r.value):r.set?(n.get=r.get,n.set=r.set):(n.writable=!0,n.value=i.hasOwnProperty(t)?i[t]:r.get?r.get():r.value),Object.defineProperty(i,t,n)}),i},decorateMultiple:function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.forEach(function(e){return e.decorate(t)}),t}},A=function(n){function e(e){var t=this.constructor,r=n.call(this,e)||this;return Object.setPrototypeOf(r,t.prototype),"captureStackTrace"in Error&&Error.captureStackTrace(r,r.constructor),r}return i(e,n),Object.defineProperty(e.prototype,"name",{get:function(){return"AbstractError"},enumerable:!0,configurable:!0}),e}(Error),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalArgumentError"},enumerable:!0,configurable:!0}),t}(A),k={hasFragment:function(e){return-1!==e.indexOf("#")},hasQuery:function(e){return-1!==e.indexOf("?")},hasProtocol:function(e){return x.startsWith(e,"https://")||x.startsWith(e,"http://")},isAbsolute:function(e){return x.startsWith(e,"http://")||x.startsWith(e,"https://")||x.startsWith(e,"://")},isRelative:function(e){return!k.isAbsolute(e)},isBNodeID:function(e){return x.startsWith(e,"_:")},generateBNodeID:function(){return"_:"+j.generate()},isPrefixed:function(e){return!k.isAbsolute(e)&&!k.isBNodeID(e)&&x.contains(e,":")},isFragmentOf:function(e,t){if(!k.hasFragment(e))return!1;var r=k.getDocumentURI(e);return""===r||r===t},isBaseOf:function(e,t){if(e===t)return!0;if(""===e)return!0;if(k.isRelative(t)&&!k.isPrefixed(t))return!0;if(t.startsWith(e)){if(x.endsWith(e,"/")||x.endsWith(e,"#"))return!0;var r=t.substring(e.length);if(x.startsWith(r,"/")||x.startsWith(r,"#"))return!0}return!1},getRelativeURI:function(e,t){return e.startsWith(t)?e.substring(t.length):e},getDocumentURI:function(e){var t=e.split("#");if(2<t.length)throw new M("The URI provided has more than one # sign.");return t[0]},getFragment:function(e){var t=e.split("#");if(t.length<2)throw new M("The URI provided hasn't a # sign.");if(2<t.length)throw new M("The URI provided has more than one # sign.");return t[1]},getSlug:function(e){var t=e.split("#");if(2===t.length)return k.getSlug(t[1]);if(2<t.length)throw new M("Invalid URI: The uri contains two '#' symbols.");if(""===(e=t[0]))return e;if("/"===e)return"";var r=e.split("/");return""===r[r.length-1]?r[r.length-2]:r[r.length-1]},getParameters:function(e){var o=new Map;return k.hasQuery(e)&&e.replace(/^.*\?/,"").split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),r=t.shift(),n=0<t.length?t.join("="):"";o.has(r)?o.set(r,(new Array).concat(o.get(r),n)):o.set(r,n)}),o},resolve:function(e,t){if(!e||k.isAbsolute(t)||k.isBNodeID(t)||k.isPrefixed(t))return t;var r=e.substr(0,e.indexOf("://")+3),n=e.substr(e.indexOf("://")+3,e.length-1);return-1===n.lastIndexOf("/")&&(n+="/"),x.startsWith(t,"?")||x.startsWith(t,"#")?(k.hasQuery(n)&&(n=n.substr(0,n.indexOf("?"))),!k.hasFragment(n)||x.startsWith(t,"?")&&!x.endsWith(n,"#")||(n=k.getDocumentURI(n))):(n=n.substr(0,n.lastIndexOf("/")+1),x.endsWith(n,"?")||x.endsWith(n,"#")||x.endsWith(n,"/")||(n+="/")),x.startsWith(t,"/")&&(t=t.substr(1,t.length)),r+n+t},removeProtocol:function(e){return k.hasProtocol(e)?e.substring(e.indexOf("://")+3):e},prefix:function(e,t,r){if(!T(t))return function(e,t){var r=t.prefixes.entries();for(;;){var n=r.next();if(n.done)return e;var o=n.value,i=o[0],a=o[1];if(k.isAbsolute(a)&&e.startsWith(a))return k.prefix(e,i,a)}}(e,t);var n=t;return k.isPrefixed(e)||!e.startsWith(r)?e:n+":"+e.substring(r.length)}};var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IDAlreadyInUseError"},enumerable:!0,configurable:!0}),t}(A),N={PROTOTYPE:{get $id(){return""}},isDecorated:function(e){return D.hasPropertiesFrom(N.PROTOTYPE,e)},decorate:function(e){return N.isDecorated(e)?e:D.definePropertiesFrom(N.PROTOTYPE,e)},is:function(e){return E(e)&&N.isDecorated(e)},create:function(e){var t=Object.assign({},e);return N.createFrom(t)},createFrom:function(e){return N.decorate(e)},areEqual:function(e,t){return e.$id===t.$id},getIDs:function(e){return e.map(function(e){return e.$id})},getID:function(e){return E(e)?e.$id:e}},$=function(e,t){return D.hasPropertiesFrom(e,t)},U=function(e,t){return"$id"in t&&N.decorate(t),D.definePropertiesFrom(e,t)};function q(e){return"$id"in e?e.$__resourcesMap:e.__resourcesMap}function Y(e){return"$id"in e?e.$registry:e.registry}function V(e,t){return"$id"in e?e.$_getLocalID(t):e._getLocalID(t)}function H(t,r){if(!this)return!1;try{return V(this,N.getID(t)),!0}catch(e){if(!0===r)return!1;var n=Y(this);return H.call(n,t)}}function B(e,t){if(!this)return!1;if(H.call(this,e,!0)){var r=V(this,e);if(q(this).has(r))return!0}if(!0===t)return!1;var n=Y(this);return B.call(n,e)}var z,G,W={PROTOTYPE:{registry:void 0,get __modelDecorator(){throw new M('Property "__modelDecorator" is required')},get __resourcesMap(){return new Map},inScope:H,hasPointer:B,getPointer:function e(t,r){var n=Y(this);if(!H.call(this,t,!0)){if(!0===r||!n)throw new M('"'+t+'" is out of scope.');return e.call(n,t)}var o,i,a=V(this,t),s=q(this);return s.has(a)?s.get(a):!0!==r&&B.call(n,t)?e.call(n,t):(i={$id:t},"$id"in(o=this)?o.$_addPointer(i):o._addPointer(i))},getPointers:function e(t){var r=q(this),n=Array.from(r.values()),o=Y(this);return!0!==t&&o?e.call(o).concat(n):n},removePointer:function e(t,r){if(!this)return!1;var n=N.getID(t);if(H.call(this,n,!0)){var o=V(this,n);if(q(this).delete(o))return!0}if(!0===r)return!1;var i=Y(this);return e.call(i,t)},_addPointer:function(e){if(!e.$id)throw new M("The pointer $id cannot be empty.");var t=V(this,e.$id),r=q(this);if(r.has(t))throw new L('"'+e.$id+'" is already being used.');var n,o=(n=this,"$id"in n?n.$__modelDecorator:n.__modelDecorator).decorate(Object.assign(e,{$registry:this}));return r.set(t,o),o},_getLocalID:function(e){return e}},isDecorated:function(e){return $(W.PROTOTYPE,e)},decorate:function(e){return W.isDecorated(e)?e:U(W.PROTOTYPE,e)}};function X(e,t){return"$id"in e?e.$getPointer(t):e.getPointer(t)}(G=z||(z={}))[G.SET=0]="SET",G[G.LIST=1]="LIST",G[G.LANGUAGE=2]="LANGUAGE";var Q={is:function(e){return u(e,"@list")}};function J(e){var t=String(e);return 1===t.length&&(t="0"+t),t}var K="The value is not a number.",Z=function(){function e(){}return e.prototype.serialize=function(e){if(!y(e))throw new M("The value is not a Date object.");return e.getUTCFullYear()+"-"+J(e.getUTCMonth()+1)+"-"+J(e.getUTCDate())},e}(),ee=new Z,te=function(){function e(){}return e.prototype.serialize=function(e){if(!y(e))throw new M("The value is not a Date object.");return e.toISOString()},e}(),re=new te,ne=function(){function e(){}return e.prototype.serialize=function(e){if(!y(e))throw new M("The value is not a Date object.");return J(e.getUTCHours())+":"+J(e.getUTCMinutes())+":"+J(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},e}(),oe=new ne,ie=function(){function e(){}return e.prototype.serialize=function(e){if(!f(e))throw new M(K);return(~~e).toString()},e}(),ae=new ie,se=function(){function e(){}return e.prototype.serialize=function(e){if(!f(e))throw new M(K);return e===Number.POSITIVE_INFINITY?"0":e===Number.NEGATIVE_INFINITY?"0":Number.isNaN(e)?"0":Math.trunc(e).toString()},e}(),ue=new se,ce=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return i(e,r),e.prototype.serialize=function(e){var t=r.prototype.serialize.call(this,e);return t=x.startsWith(t,"-")?t.substring(1):t},e}(ie),le=new ce,pe=function(){function e(){}return e.prototype.serialize=function(e){if(!f(e))throw new M(K);return e===Number.POSITIVE_INFINITY?"0":e===Number.NEGATIVE_INFINITY?"0":Number.isNaN(e)?"0":Math.trunc(Math.abs(e)).toString()},e}(),he=new pe,fe=function(){function e(){}return e.prototype.serialize=function(e){if(e===Number.POSITIVE_INFINITY)return"INF";if(e===Number.NEGATIVE_INFINITY)return"-INF";if(!f(e))throw new M(K);return e.toString()},e}(),de=new fe,ge=function(){function e(){}return e.prototype.serialize=function(e){return(!!e).toString()},e}(),ye=new ge,ve=function(){function e(){}return e.prototype.serialize=function(e){return String(e)},e}(),me=new ve,be={namespace:"http://www.w3.org/2001/XMLSchema#",boolean:"http://www.w3.org/2001/XMLSchema#boolean",byte:"http://www.w3.org/2001/XMLSchema#byte",date:"http://www.w3.org/2001/XMLSchema#date",dateTime:"http://www.w3.org/2001/XMLSchema#dateTime",decimal:"http://www.w3.org/2001/XMLSchema#decimal",double:"http://www.w3.org/2001/XMLSchema#double",duration:"http://www.w3.org/2001/XMLSchema#duration",float:"http://www.w3.org/2001/XMLSchema#float",gDay:"http://www.w3.org/2001/XMLSchema#gDay",gMonth:"http://www.w3.org/2001/XMLSchema#gMonth",gMonthDay:"http://www.w3.org/2001/XMLSchema#gMonthDay",gYear:"http://www.w3.org/2001/XMLSchema#gYear",gYearMonth:"http://www.w3.org/2001/XMLSchema#gYearMonth",int:"http://www.w3.org/2001/XMLSchema#int",integer:"http://www.w3.org/2001/XMLSchema#integer",long:"http://www.w3.org/2001/XMLSchema#long",negativeInteger:"http://www.w3.org/2001/XMLSchema#negativeInteger",nonNegativeInteger:"http://www.w3.org/2001/XMLSchema#nonNegativeInteger",nonPositiveInteger:"http://www.w3.org/2001/XMLSchema#nonPositiveInteger",object:"http://www.w3.org/2001/XMLSchema#object",positiveInteger:"http://www.w3.org/2001/XMLSchema#positiveInteger",short:"http://www.w3.org/2001/XMLSchema#short",string:"http://www.w3.org/2001/XMLSchema#string",time:"http://www.w3.org/2001/XMLSchema#time",unsignedByte:"http://www.w3.org/2001/XMLSchema#unsignedByte",unsignedInt:"http://www.w3.org/2001/XMLSchema#unsignedInt",unsignedLong:"http://www.w3.org/2001/XMLSchema#unsignedLong",unsignedShort:"http://www.w3.org/2001/XMLSchema#unsignedShort"},we=Object.freeze({DateSerializer:Z,dateSerializer:ee,DateTimeSerializer:te,dateTimeSerializer:re,TimeSerializer:ne,timeSerializer:oe,IntegerSerializer:ie,integerSerializer:ae,LongSerializer:se,longSerializer:ue,UnsignedIntegerSerializer:ce,unsignedIntegerSerializer:le,UnsignedLongSerializer:pe,unsignedLongSerializer:he,FloatSerializer:fe,floatSerializer:de,BooleanSerializer:ge,booleanSerializer:ye,StringSerializer:ve,stringSerializer:me}),_e={from:function(e){if(l(e))throw new M("Null cannot be converted into a Literal");if(!_(e))throw new M("The value is undefined");var t;switch(!0){case y(e):t=be.dateTime,e=e.toISOString();break;case f(e):t=g(e)?be.integer:be.double;break;case T(e):t=be.string;break;case h(e):t=be.boolean;break;default:t=be.object,e=JSON.stringify(e)}var r={"@value":e.toString()};return t&&(r["@type"]=t),r},parse:function(e,t){var r;if(T(e))r=e;else{var n=e;if(!n)return null;if(!p(n,"@value"))return null;t="@type"in n?n["@type"]:null,r=n["@value"]}var o=r;switch(t){case be.date:case be.dateTime:o=new Date(r);break;case be.time:var i=r.match(/(\d+):(\d+):(\d+)\.(\d+)Z/);if(!i)throw new M("Invalid value for type "+be.time+".");(o=new Date).setUTCHours(parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]),parseFloat(i[4]));break;case be.duration:break;case be.gDay:case be.gMonth:case be.gMonthDay:case be.gYear:case be.gYearMonth:break;case be.byte:case be.decimal:case be.int:case be.integer:case be.long:case be.negativeInteger:case be.nonNegativeInteger:case be.nonPositiveInteger:case be.positiveInteger:case be.short:case be.unsignedLong:case be.unsignedInt:case be.unsignedShort:case be.unsignedByte:case be.double:case be.float:o=parseFloat(r);break;case be.boolean:o=w(r);break;case be.string:o=r;break;case be.object:o=JSON.parse(r)}return o},is:function(e){return p(e,"@value")&&T(e["@value"])},hasType:function(e,t){return!e["@type"]&&t===be.string||e["@type"]===t}},Pe={is:function(e){return p(e,"@id")&&T(e["@id"])},create:function(e){return{"@id":e}},getID:function(e){return e["@id"]},getRelativeID:function(e){var t=Pe.getID(e);return k.hasFragment(t)?k.getFragment(t):t},areEqual:function(e,t){return Pe.getID(e)===Pe.getID(t)},isFragment:function(e){var t=Pe.getID(e);return k.hasFragment(t)||k.isBNodeID(t)},hasType:function(e,t){return-1!==Pe.getTypes(e).indexOf(t)},getTypes:function(e){return"@type"in e?e["@type"]:[]},getList:function(e){if(Array.isArray(e))return e.find(Q.is)},getPropertyLiterals:function(e,t){if(Array.isArray(e))return e.filter(_e.is).filter(function(e){return _e.hasType(e,t)}).map(_e.parse)},getPropertyLanguageMap:function(e){if(Array.isArray(e)){for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];if(_e.is(o)&&_e.hasType(o,be.string)){var i=o["@language"];i&&(t[i]=_e.parse(o))}}return t}}},Te={parse:function(e,t){return T(t)?t:_e.is(t)?_e.parse(t):Pe.is(t)?X(e,t["@id"]):Q.is(t)?t["@list"].map(Te.parse.bind(null,e)):null}};function Ee(e){return m(e)?null:T(e)?be.string:y(e)?be.dateTime:f(e)?be.float:h(e)?be.boolean:null}var Se=function(){function t(e){this._literalSerializers=e?R.extend(new Map,e):t.getDefaultSerializers()}return Object.defineProperty(t.prototype,"literalSerializers",{get:function(){return this._literalSerializers},enumerable:!0,configurable:!0}),t.getDefaultSerializers=function(){var e=new Map;return e.set(be.date,ee),e.set(be.dateTime,re),e.set(be.time,oe),e.set(be.integer,ae),e.set(be.int,ae),e.set(be.unsignedInt,le),e.set(be.long,ue),e.set(be.unsignedLong,he),e.set(be.float,de),e.set(be.double,de),e.set(be.boolean,ye),e.set(be.string,me),e},t.prototype.compact=function(e,t,r,n,o){var i=n?t:null,a=n?r:t;if(n=n||r,!Array.isArray(e))return this.__compactSingle(e,i,a,n,o);for(var s=e,u=i||[],c=0,l=s.length;c<l;c++){var p=s[c],h=u[c]=u[c]?u[c]:{};this.__compactSingle(p,h,a,n,o)}return u},t.prototype.expand=function(e,t,r){if(!Array.isArray(e))return this.__expandSingle(e,t,r)},t.prototype.update=function(n,e,o,t,i){var a=this.compact(e,{},o,t,i);new Set(Object.getOwnPropertyNames(n).concat(Object.keys(a))).forEach(function(e){var t;if(!e.startsWith("$")&&!m(n[e]))if(a.hasOwnProperty(e))if(Array.isArray(n[e])){var r=Array.isArray(a[e])?a[e]:[a[e]];n[e].length=0,(t=n[e]).push.apply(t,r)}else n[e]=a[e];else i&&!o.properties.has(e)||delete n[e]})},t.prototype.__expandSingle=function(e,t,r){var n={};if(n["@id"]=e.$id?e.$id:"",e.types){var o=Array.isArray(e.types)?e.types:[e.types];o.length&&(n["@type"]=o.map(function(e){return t.resolveURI(e,{vocab:!0,base:!0})}))}for(var i=0,a=Object.keys(e);i<a.length;i++){var s=a[i];if("$id"!==s&&"types"!==s){var u=r.resolveURI(s,{vocab:!0});if(!k.isRelative(u)){var c=this.__expandProperty(s,e[s],r,t);null!==c&&(n[u]=c)}}}return n},t.prototype.__expandProperty=function(e,t,r,n){var o=r.properties.get(e),i=o?o.containerType:void 0;if(i===z.LANGUAGE)return this.__expandPropertyLanguageMap(t);t=Array.isArray(t)?t:[t],null===i&&(t=[t[0]]);var a=o?o.literal:null,s=(!0===a?this.__expandPropertyLiteral(t,o,r):!1===a?this.__expandPropertyPointer(t,r,n):this.__expandPropertyValue(t,r,n)).filter(function(e){return null!==e});return s.length?i===z.LIST?[{"@list":s}]:s:null},t.prototype.__expandPropertyValue=function(e,t,r){var n=this;return e.map(function(e){return n.__expandValue(e,t,r)})},t.prototype.__expandPropertyPointer=function(e,t,r){var n=this;return e.map(function(e){return n.__expandPointerValue(e,t,r)})},t.prototype.__expandPropertyLiteral=function(e,t,r){var n=this,o=r.resolveURI(t.literalType,{vocab:!0,base:!0}),i=e.map(function(e){return n.__expandLiteralValue(e,o)});return t.language&&i.forEach(function(e){return e["@language"]=t.language}),i},t.prototype.__expandPropertyLanguageMap=function(e){if(!E(e))return null;for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=this.literalSerializers.get(be.string).serialize(e[o]);t.push({"@value":i,"@type":be.string,"@language":o})}return t},t.prototype.__expandPointerValue=function(e,t,r){var n=T(e),o=N.is(e)?e.$id:n?e:null;return o?{"@id":r.resolveURI(o,{vocab:n})}:null},t.prototype.__expandValue=function(e,t,r){return Array.isArray(e)?null:N.is(e)?this.__expandPointerValue(e,r,t):this.__expandLiteralValue(e,Ee(e))},t.prototype.__expandLiteralValue=function(e,t){return null===t?null:this.literalSerializers.has(t)?{"@value":this.literalSerializers.get(t).serialize(e),"@type":t}:null},t.prototype.__compactSingle=function(e,t,r,n,o){if(!e["@id"])throw new M("The expandedObject doesn't have an @id defined.");t.$id=e["@id"],t.types=e["@type"]?e["@type"]:[];for(var i=this.__getPropertyURINameMap(r),a=0,s=Object.keys(e);a<s.length;a++){var u=s[a];if("@id"!==u&&"@type"!==u){var c=e[u];if(F(c)&&(i.has(u)||!o)){var l=i.has(u)?i.get(u):r.vocab?k.getRelativeURI(u,r.vocab):u,p=this.__getPropertyValue(l,c,r,n);null!=p&&(t[l]=p)}}}return t},t.prototype.__getPropertyContainerType=function(e){return 1!==e.length?z.SET:Q.is(e[0])?z.LIST:null},t.prototype.__getPropertyValue=function(e,t,r,n){var o=r.properties.get(e),i=o?o.containerType:this.__getPropertyContainerType(t);if(i===z.LANGUAGE)return Pe.getPropertyLanguageMap(t);if(i===z.LIST){var a=Pe.getList(t);if(!a)return null;t=a["@list"]}var s=o?o.literal:null;!0===s&&o&&o.language&&(t=t.filter(function(e){return e["@language"]===o.language})),null===i&&(t=[t[0]]);var u=!0===s?this.__compactPropertyLiteral(t,o,r):!1===s?this.__getPropertyPointers(t,n):this.__getProperties(t,n);if(!u)return null;var c=u.filter(function(e){return null!==e});return c.length?null===i?c[0]:c:null},t.prototype.__getPropertyURINameMap=function(n){var o=new Map;return n.properties.forEach(function(e,t){var r=n.resolveURI(e.uri,{vocab:!0});o.set(r,t)}),o},t.prototype.__compactPropertyLiteral=function(e,t,r){var n=null===t.literalType?be.string:r.resolveURI(t.literalType,{vocab:!0,base:!0});return Pe.getPropertyLiterals(e,n)},t.prototype.__getProperties=function(e,t){if(Array.isArray(e))return e.map(Te.parse.bind(null,t)).filter(function(e){return!l(e)})},t.prototype.__getPropertyPointers=function(e,t){if(Array.isArray(e))return e.filter(Pe.is).map(Pe.getID).map(X.bind(null,t)).filter(function(e){return!l(e)})},t}(),Oe=function(){this.uri=null,this.literal=null,this.literalType=null,this.pointerType=null,this.containerType=null},Ce=function(){function e(){}return e._resolveProperty=function(e,t,r){var n=t.uri,o=t.literalType,i=e.resolveURI(n,{vocab:!0}),a=e.resolveURI(o,{vocab:!0,base:!0});return i===n&&a===o||(r||(t=Object.assign(new Oe,t)),t.uri=i,t.literalType=a),t},e}(),xe=function(){function e(){this.base="",this.vocab=void 0,this.language=null,this.prefixes=new Map,this.properties=new Map}return e.prototype.resolveURI=function(e,t){if(void 0===t&&(t={}),null===e||k.isAbsolute(e)||k.isBNodeID(e))return e;var r=e.split(":"),n=r[0],o=r[1],i=void 0===o?"":o,a=this.prefixes.has(n)?this.prefixes.get(n):this.properties.has(n)?this.properties.get(n).uri:null;return null!==a&&a!==n?this.resolveURI(a+i,{vocab:!0}):i?e:t.vocab&&this.vocab?this.vocab+e:t.base?k.resolve(this.base,e):e},e.prototype.getProperty=function(e){if(this.properties.has(e))return Ce._resolveProperty(this,this.properties.get(e))},e}(),Re={PROTOTYPE:{get $registry(){throw new M('Property "$registry" is required.')}},isDecorated:function(e){return D.hasPropertiesFrom(Re.PROTOTYPE,e)},decorate:function(e){if(Re.isDecorated(e))return e;var t=D.decorateMultiple(e,N);return D.definePropertiesFrom(Re.PROTOTYPE,t)},create:function(e){var t=Object.assign({},e);return Re.createFrom(t)},createFrom:function(e){return Re.decorate(e)},is:function(e){return N.is(e)&&Re.isDecorated(e)}};function je(e){if(e)return"context"in e&&e.context?e.context:je("$id"in e?e.$registry:e.registry)}function Fe(e,t){if(k.isAbsolute(t))return t;var r=je(e.$registry);return r?r.getObjectSchema().resolveURI(t,{vocab:!0}):t}var Ie={PROTOTYPE:{get types(){return[]},get $slug(){return k.isBNodeID(this.$id)?this.$id:k.getSlug(this.$id)},set $slug(e){},$addType:function(e){e=Fe(this,e),-1===this.types.indexOf(e)&&this.types.push(e)},$hasType:function(e){return e=Fe(this,e),-1!==this.types.indexOf(e)},$removeType:function(e){e=Fe(this,e);var t=this.types.indexOf(e);-1!==t&&this.types.splice(t,1)},toJSON:function(e){var t="object"==typeof e?e:je(this.$registry),r=t?t.registry.getGeneralSchema():new xe,n=t&&t.registry?t.registry.getSchemaFor(this):r;return(t?t.jsonldConverter:new Se).expand(this,r,n)}},isDecorated:function(e){return E(e)&&D.hasPropertiesFrom(Ie.PROTOTYPE,e)},is:function(e){return N.is(e)&&Ie.isDecorated(e)},create:function(e){var t=Object.assign({},e);return Ie.createFrom(t)},createFrom:function(e){return Ie.decorate(e)},decorate:function(e){if(Ie.isDecorated(e))return e;e.hasOwnProperty("$registry")||(e.$registry=void 0);var t=D.decorateMultiple(e,Re);return D.definePropertiesFrom(Ie.PROTOTYPE,t)}},De={PROTOTYPE:{_getLocalID:function(e){if(t(e)&&!k.hasProtocol(e))return e;throw new M('"'+e+'" is out of scope.')},_addPointer:function(e){return e.$id||(e.$id=k.generateBNodeID()),W.PROTOTYPE._addPointer.call(this,e)},toJSON:function(t){return this.getPointers(!0).map(function(e){return e.toJSON(t)})}},is:function(e){return W.isDecorated(e)&&De.isDecorated(e)},isDecorated:function(e){return D.hasPropertiesFrom(De.PROTOTYPE,e)},create:function(e){var t=Object.assign({},e);return De.createFrom(t)},createFrom:function(e){return De.decorate(e)},decorate:function(e){if(De.isDecorated(e))return e;var t=Object.assign(e,{__modelDecorator:Ie}),r=D.decorateMultiple(t,W);return D.definePropertiesFrom(De.PROTOTYPE,r)},parseFreeNodes:function(n,e){var o=De.createFrom({registry:n});return e.forEach(function(e){var t=n.getSchemaFor(e),r=o.getPointer(e["@id"],!0);n.context.jsonldConverter.compact(e,r,t,o)}),o}},Ae=function(){function e(){}return e.prototype.parse=function(t){return new Promise(function(e){return e(JSON.parse(t))})},e}(),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"InvalidJSONLDSyntaxError"},enumerable:!0,configurable:!0}),t}(A),ke=function(t){function e(e){return void 0===e&&(e=""),t.call(this,e)||this}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"NotImplementedError"},enumerable:!0,configurable:!0}),e}(A),Le=function(n){function e(e,t){var r=n.call(this,e)||this;return r.response=t,r}return i(e,n),Object.defineProperty(e,"statusCode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return"HTTPError"},enumerable:!0,configurable:!0}),e}(A),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 400},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"BadRequestError"},enumerable:!0,configurable:!0}),t}(Le),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 409},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"ConflictError"},enumerable:!0,configurable:!0}),t}(Le),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 403},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"ForbiddenError"},enumerable:!0,configurable:!0}),t}(Le),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 405},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"MethodNotAllowedError"},enumerable:!0,configurable:!0}),t}(Le),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 406},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"NotAcceptableError"},enumerable:!0,configurable:!0}),t}(Le),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 404},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"NotFoundError"},enumerable:!0,configurable:!0}),t}(Le),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 412},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"PreconditionFailedError"},enumerable:!0,configurable:!0}),t}(Le),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 428},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"PreconditionRequiredError"},enumerable:!0,configurable:!0}),t}(Le),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 413},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"RequestEntityTooLargeError"},enumerable:!0,configurable:!0}),t}(Le),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 431},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"RequestHeaderFieldsTooLargeError"},enumerable:!0,configurable:!0}),t}(Le),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 414},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"RequestURITooLongError"},enumerable:!0,configurable:!0}),t}(Le),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 429},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"TooManyRequestsError"},enumerable:!0,configurable:!0}),t}(Le),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 401},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"UnauthorizedError"},enumerable:!0,configurable:!0}),t}(Le),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 415},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"UnsupportedMediaTypeError"},enumerable:!0,configurable:!0}),t}(Le),Ke=Object.freeze({BadRequestError:Ne,ConflictError:$e,ForbiddenError:Ue,MethodNotAllowedError:qe,NotAcceptableError:Ye,NotFoundError:Ve,PreconditionFailedError:He,PreconditionRequiredError:Be,RequestEntityTooLargeError:ze,RequestHeaderFieldsTooLargeError:Ge,RequestURITooLongError:We,TooManyRequestsError:Xe,UnauthorizedError:Qe,UnsupportedMediaTypeError:Je}),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"BadResponseError"},enumerable:!0,configurable:!0}),t}(Le),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 502},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"BadGatewayError"},enumerable:!0,configurable:!0}),t}(Le),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 504},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"GatewayTimeoutError"},enumerable:!0,configurable:!0}),t}(Le),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 505},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"HTTPVersionNotSupportedError"},enumerable:!0,configurable:!0}),t}(Le),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 500},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"InternalServerErrorError"},enumerable:!0,configurable:!0}),t}(Le),ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 501},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"NotImplementedError"},enumerable:!0,configurable:!0}),t}(Le),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t,"statusCode",{get:function(){return 503},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return"ServiceUnavailableError"},enumerable:!0,configurable:!0}),t}(Le),at=Object.freeze({BadResponseError:Ze,BadGatewayError:et,GatewayTimeoutError:tt,HTTPVersionNotSupportedError:rt,InternalServerErrorError:nt,NotImplementedError:ot,ServiceUnavailableError:it}),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"UnknownError"},enumerable:!0,configurable:!0}),t}(Le),ut=new Map,ct=function(t){return Object.keys(t).map(function(e){return t[e]}).forEach(function(e){return ut.set(e.statusCode,e)})};ct(Ke),ct(at);var lt,pt,ht=Object.freeze({statusCodeMap:ut,BadRequestError:Ne,ConflictError:$e,ForbiddenError:Ue,MethodNotAllowedError:qe,NotAcceptableError:Ye,NotFoundError:Ve,PreconditionFailedError:He,PreconditionRequiredError:Be,RequestEntityTooLargeError:ze,RequestHeaderFieldsTooLargeError:Ge,RequestURITooLongError:We,TooManyRequestsError:Xe,UnauthorizedError:Qe,UnsupportedMediaTypeError:Je,BadResponseError:Ze,BadGatewayError:et,GatewayTimeoutError:tt,HTTPVersionNotSupportedError:rt,InternalServerErrorError:nt,NotImplementedError:ot,ServiceUnavailableError:it,HTTPError:Le,UnknownError:st}),ft=function(){function a(e){this.values=Array.isArray(e)?e:a.__parseValues(e)}return a.parseHeaders=function(e){var i=new Map;return e.split(/\r?\n/).forEach(function(e){var t;if(e.trim()){var r=e.split(":");if(r.length<2)throw new M("The header couldn't be parsed.");var n=r[0].trim().toLowerCase(),o=a.__parseValues(r.slice(1).join(":"));i.has(n)?(t=i.get(n).values).push.apply(t,o):i.set(n,new a(o))}}),i},a.__parseValues=function(e){return e?e.split(",").map(function(e){return e.trim()}):[]},a.prototype.hasValue=function(e){return-1!==this.values.indexOf(e)},a.prototype.addValue=function(e){var t,r=a.__parseValues(e);(t=this.values).push.apply(t,r)},a.prototype.toString=function(){return this.values.join(", ")},a}();(pt=lt||(lt={}))[pt.OPTIONS=0]="OPTIONS",pt[pt.HEAD=1]="HEAD",pt[pt.GET=2]="GET",pt[pt.POST=3]="POST",pt[pt.PUT=4]="PUT",pt[pt.PATCH=5]="PATCH",pt[pt.DELETE=6]="DELETE";var dt=function(){function e(e,t,r){if(this.request=e,"undefined"!=typeof XMLHttpRequest&&e instanceof XMLHttpRequest)this.status=e.status,this.data=e.responseText,this.headers=ft.parseHeaders(e.getAllResponseHeaders());else{if(this.data=t||"",this.status=r&&r.statusCode||0,this.headers=new Map,!r)return;for(var n in r.headers){var o=new ft(r.headers[n]);this.headers.set(n.toLowerCase(),o)}}}return e.prototype.getHeader=function(e){return e=e.toLowerCase(),this.headers.get(e)||null},e.prototype.getETag=function(){var e=this.getHeader("ETag");if(!e||!e.values.length)throw new Ze("The response doesn't contain an ETag",this);return e.values[0]},e}();function gt(e,t,r){if(200<=r.status&&r.status<=299)e(r);else{if(!ut.has(r.status))return t(new st(r.data,r));t(new(ut.get(r.status))(r.data,r))}}function yt(o,e,l,p){return new Promise(function(s,u){var c=0;!function t(i){var e=(void 0).parse(i),r=void e.protocol,n={protocol:e.protocol,hostname:e.hostname,port:e.port,path:e.path,method:o,headers:{}};p.headers&&p.headers.forEach(function(e,t){return n.headers[t]=e.toString()});var a=r.request(n);p.timeout&&a.setTimeout(p.timeout),a.on("response",function(e){if(300<=e.statusCode&&e.statusCode<=399&&"location"in e.headers&&++c<10)return t((void 0).resolve(i,e.headers.location));var r,n,o;r=a,o=[],(n=e).on("data",function(e){"string"==typeof e&&(e=Buffer.from(e,"utf-8")),o.push(e)}).on("end",function(){var e=Buffer.concat(o).toString("utf8"),t=new dt(r,e,n);gt(s,u,t)})}),a.on("error",function(e){var t=new dt(a,e.message);gt(s,u,t)}),l&&("DELETE"===o&&(a.useChunkedEncodingByDefault=!0),a.write(l)),a.end()}(e)})}function vt(e,t,r,n){return"undefined"!=typeof XMLHttpRequest?(o=e,i=t,a=r,s=n,new Promise(function(t,r){var n=s.request?s.request:new XMLHttpRequest;n.open(o,i,!0),s.headers&&s.headers.forEach(function(e,t){return n.setRequestHeader(t,e.toString())}),n.withCredentials=!!s.sendCredentialsOnCORS,s.timeout&&(n.timeout=s.timeout),n.onload=n.onerror=function(){var e=new dt(n);gt(t,r,e)},a?n.send(a):n.send()})):yt(e,t,r,n);var o,i,a,s}var mt,bt,wt=function(){function l(){}return l.send=function(t,r,e,n,o){var i,a=this,s=void 0,u=p(n,"parse")?e:n;o=p(n,"parse")?n:o,!e||(T(i=e)||"undefined"!=typeof Blob&&i instanceof Blob||"undefined"!=typeof Buffer&&i instanceof Buffer)?s=e:u=e||u,u=Object.assign({},l.defaultOptions,u),f(t)&&(t=lt[t]);var c=vt(t,r,s,u).then(function(e){return"GET"===t&&u.headers?a.__handleGETResponse(r,u,e):e});return o?c.then(function(t){return o.parse(t.data).then(function(e){return[e,t]})}):c},l.options=function(e,t){return void 0===t&&(t=l.defaultOptions),l.send(lt.OPTIONS,e,t)},l.head=function(e,t){return void 0===t&&(t=l.defaultOptions),l.send(lt.HEAD,e,t)},l.get=function(e,t,r){return void 0===t&&(t=l.defaultOptions),l.send(lt.GET,e,void 0,t,r)},l.post=function(e,t,r,n){return void 0===t&&(t=l.defaultOptions),void 0===r&&(r=l.defaultOptions),l.send(lt.POST,e,t,r,n)},l.put=function(e,t,r,n){return void 0===t&&(t=l.defaultOptions),void 0===r&&(r=l.defaultOptions),l.send(lt.PUT,e,t,r,n)},l.patch=function(e,t,r,n){return void 0===t&&(t=l.defaultOptions),void 0===r&&(r=l.defaultOptions),l.send(lt.PATCH,e,t,r,n)},l.delete=function(e,t,r,n){return void 0===t&&(t=l.defaultOptions),void 0===r&&(r=l.defaultOptions),l.send(lt.DELETE,e,t,r,n)},l.__handleGETResponse=function(e,t,r){var n=this;return Promise.resolve().then(function(){return n.__contentTypeIsAccepted(t,r)?r:(n.__setNoCacheHeaders(t),n.__isChromiumAgent()||n.__setFalseETag(t),vt("GET",e,void 0,t).then(function(e){if(!n.__contentTypeIsAccepted(t,r))throw new Ze("The server responded with an unacceptable Content-Type",r);return e}))})},l.__contentTypeIsAccepted=function(e,t){if(!e.headers)return!0;var r=e.headers.has("accept")?e.headers.get("accept").values:[],n=t.headers.has("content-type")?t.headers.get("content-type"):void 0;return!n||r.some(n.hasValue,n)},l.__setNoCacheHeaders=function(e){e.headers.set("pragma",new ft("no-cache")).set("cache-control",new ft("no-cache, max-age=0"))},l.__isChromiumAgent=function(){return"undefined"!=typeof window&&!!window.chrome},l.__setFalseETag=function(e){e.headers.set("if-none-match",new ft)},l.defaultOptions={sendCredentialsOnCORS:!0},l}(),_t=function(){function s(){}return s.getHeader=function(e,t,r){if(!t.headers){if(!r)return;t.headers=new Map}e=e.toLowerCase();var n=t.headers.get(e);if(!n){if(!r)return;n=new ft,t.headers.set(e,n)}return n},s.setAcceptHeader=function(e,t){return s.__addHeaderValue("accept",e,t),t},s.setContentTypeHeader=function(e,t){return s.__addHeaderValue("content-type",e,t),t},s.setIfMatchHeader=function(e,t){return e&&s.__addHeaderValue("if-match",e,t),t},s.setIfNoneMatchHeader=function(e,t){return e&&s.__addHeaderValue("if-none-match",e,t),t},s.setPreferredInteractionModel=function(e,t){return s.__addHeaderValue("prefer",e+"; rel=interaction-model",t),t},s.setPreferredRetrieval=function(e,t){return s.__addHeaderValue("prefer","return="+e,t),t},s.setRetrievalPreferences=function(e,t){for(var r=s.getHeader("prefer",t,!0),n=0,o=["include","omit"];n<o.length;n++){var i=o[n];if(i in e&&!(e[i].length<=0)){var a=e[i].join(" ");r.values.push(i+'="'+a+'"')}}return t},s.setSlug=function(e,t){return s.__addHeaderValue("slug",e,t),t},s.isOptions=function(e){return u(e,"headers")||u(e,"sendCredentialsOnCORS")||u(e,"timeout")||u(e,"request")},s.cloneOptions=function(e){var r=d({},e,{headers:new Map});return e.headers&&e.headers.forEach(function(e,t){return r.headers.set(t,new ft(e.values.slice()))}),r},s.__addHeaderValue=function(e,t,r){s.getHeader(e,r,!0).addValue(t)},s}();(bt=mt||(mt={}))[bt.ID=0]="ID",bt[bt.VOCAB=1]="VOCAB";var Pt=function(){function u(){}return u.digestSchema=function(e){if(!Array.isArray(e))return u._digestSchema(e);var t=e.map(function(e){return u._digestSchema(e)});return u._combineSchemas(t)},u.digestProperty=function(e,t,r){var n=new Oe;if("@id"in t){var o=t["@id"];if(k.isPrefixed(e))throw new M("A prefixed property cannot have assigned another URI.");if(!T(o))throw new M("@id needs to point to a string");n.uri=o}else n.uri=e;if("@type"in t){var i=t["@type"];if(!T(i))throw new M("@type needs to point to a string");"@id"===i||"@vocab"===i?(n.literal=!1,n.pointerType="@id"===i?mt.ID:mt.VOCAB):(k.isRelative(i)&&i in be&&(i=be[i]),n.literal=!0,n.literalType=i)}if("@language"in t){var a=t["@language"];if(null!==a&&!T(a))throw new M("@language needs to point to a string or null.");n.literal=!0,n.language=a}if("@container"in t)switch(t["@container"]){case"@set":n.containerType=z.SET;break;case"@list":n.containerType=z.LIST;break;case"@language":if(T(n.language))throw new M("@container cannot be set to @language when the property definition already contains an @language tag.");n.containerType=z.LANGUAGE;break;default:throw new M("@container needs to be equal to '@list', '@set', or '@language'")}return r?Ce._resolveProperty(r,n,!0):n},u.combineDigestedObjectSchemas=function(e){if(0===e.length)throw new M("At least one DigestedObjectSchema needs to be specified.");return e.unshift(new xe),u._combineSchemas(e)},u._digestSchema=function(e){for(var t=new xe,r=0,n=["@base","@vocab"];r<n.length;r++){if((i=n[r])in e){if(null!==(o=e[i])&&!T(o))throw new M("The value of '"+i+"' must be a string or null.");if("@vocab"===i&&""===o||o&&!k.isAbsolute(o)&&!k.isBNodeID(o))throw new M("The value of '"+i+"' must be an absolute URI"+("@base"===i?" or an empty string":"")+".");t[i.substr(1)]=o}}if(t.base=t.base||"","@language"in e){var o;if(null!==(o=e["@language"])&&!T(o))throw new Me("The value of '@language' must be a string or null.");t.language=o}for(var i in e)if(e.hasOwnProperty(i)&&"@reverse"!==i&&"@index"!==i&&"@base"!==i&&"@vocab"!==i&&"@language"!==i){var a=e[i];if(T(a)){if(k.isPrefixed(i))throw new M("A prefixed property cannot be equal to another URI.");t.prefixes.set(i,a)}else{if(!a||!E(a))throw new M("ObjectSchema Properties can only have string values or object values.");var s=u.digestProperty(i,a);t.properties.set(i,s)}}return t},u._combineSchemas=function(e){var t=e[0];return e.slice(1).forEach(function(e){void 0!==e.vocab&&(t.vocab=e.vocab),""!==e.base&&(t.base=e.base),null!==e.language&&(t.language=e.language),R.extend(t.prefixes,e.prefixes),R.extend(t.properties,e.properties)}),t},u}(),Tt=function(){function w(){}return w.expand=function(t){return w.__retrieveContexts(t,Object.create(null),"").then(function(){var e=w.__process(new xe,t);return E(e)&&"@graph"in e&&1===Object.keys(e).length?e=e["@graph"]:null===e&&(e=[]),P(e)||(e=[e]),e})},w.__getTargetFromLinkHeader=function(e){for(var t=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,r=0,n=e.values;r<n.length;r++){var o=n[r].toString().match(t);if(o){for(var i=o[1],a=o[2],s=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,u={};o=s.exec(a);)u[o[1]]=void 0===o[2]?o[3]:o[2];if("http://www.w3.org/ns/json-ld#context"===u.rel)return i}}},w.__findContextURLs=function(e,t,r,n){void 0===n&&(n=!1);var o=Object.keys(t).length;if(P(e))for(var i=0,a=e;i<a.length;i++){var s=a[i];w.__findContextURLs(s,t,r)}else if(v(e))for(var u in e)if("@context"===u){var c=e[u];if(P(c))for(var l=c,p=0,h=l.length;p<h;++p){var f=l[p];if(T(f)){var d=f;d=k.resolve(r,d),n?P(t[d])?(l.splice.apply(l,[p,1].concat([].concat(t[d]))),p+=t[d].length-1,h=l.length):l[p]=t[d]:d in t||(t[d]=!0)}}else if(T(c)){d=c;d=k.resolve(r,d),n?e[u]=t[d]:d in t||(t[d]=null)}}else w.__findContextURLs(e[u],t,r);return o<Object.keys(t).length},w.__retrieveContexts=function(e,u,t){if(10<Object.keys(u).length)return Promise.reject(new Me("Maximum number of @context URLs exceeded."));var c=Object.create(null);if(!w.__findContextURLs(e,c,t))return Promise.resolve();var n=[],r=function(t){if(t in u)return{value:Promise.reject(new Me("Cyclical @context URLs detected."))};var e={sendCredentialsOnCORS:!1};_t.setAcceptHeader("application/ld+json, application/json",e);var s,r=wt.get(t,e,new Ae).catch(function(e){return Promise.reject(new Me('Unable to resolve context from "'+t+'". Status code: '+e.status))});n.push((s=t,r.then(function(e){var t=e[0],r=e[1],n=C.clone(u);n[s]=!0;var o={"@context":{}},i=r.getHeader("Content-Type");if(i&&i.toString().includes("application/ld+json"))o["@context"]="@context"in t?t["@context"]:{};else{var a=void 0;(i=r.getHeader("Link"))&&(a=w.__getTargetFromLinkHeader(i)),a&&(o["@context"]=a)}return c[s]=o["@context"],w.__retrieveContexts(o,n,s)})))};for(var o in c){var i=r(o);if("object"==typeof i)return i.value}return Promise.all(n).then(function(){w.__findContextURLs(e,c,t,!0)})},w.__isKeyword=function(e){if(!T(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0;default:return!1}},w.__isValidType=function(e){if(T(e))return!0;if(!P(e))return!1;for(var t=0,r=e;t<r.length;t++){if(!T(r[t]))return!1}return!0},w.__expandURI=function(e,t,r){return w.__isKeyword(t)?t:e.resolveURI(t,r)},w.__expandLanguageMap=function(e){for(var t=[],r=0,n=Object.keys(e).sort();r<n.length;r++){var o=n[r],i=e[o];P(i)||(i=[i]);for(var a=0,s=i;a<s.length;a++){var u=s[a];if(null!==u){if(!T(u))throw new Me("Language map values must be strings.");t.push({"@value":u,"@language":o.toLowerCase()})}}}return t},w.__getContainer=function(e,t){return t&&e.properties.has(t)?e.properties.get(t).containerType:null},w.__expandValue=function(e,t,r){if(null===t||!_(t))return null;if("@id"===r)return w.__expandURI(e,t,{base:!0});if("@type"===r)return w.__expandURI(e,t,{vocab:!0,base:!0});var n=r&&e.properties.has(r)?e.properties.get(r):new Oe;if(!1===n.literal||"@graph"===r&&T(t)){var o={base:!0};return n.pointerType===mt.VOCAB&&(o.vocab=!0),{"@id":w.__expandURI(e,t,o)}}if(w.__isKeyword(r))return t;var i={};if(n.literalType)i["@type"]=e.resolveURI(n.literalType,{vocab:!0,base:!0});else if(T(t)){var a=_(n.language)?n.language:e.language;a&&(i["@language"]=a)}return-1===["boolean","number","string"].indexOf(typeof t)&&(t=t.toString()),i["@value"]=t,i},w.__process=function(e,t,r,n){if(null===t||!_(t))return null;if(!P(t)&&!E(t))return n||null!==r&&"@graph"!==r?w.__expandValue(e,t,r):null;if(P(t)){var o=w.__getContainer(e,r);n=n||o===z.LIST;for(var i=[],a=0,s=t;a<s.length;a++){var u=s[a],c=w.__process(e,u,r);if(null!==c){if(n&&(P(c)||Q.is(c)))throw new Me("Lists of lists are not permitted.");P(c)||(c=[c]),i.push.apply(i,c)}}return i}"@context"in t&&(e=Pt.combineDigestedObjectSchemas([e,Pt.digestSchema(t["@context"])]));for(var l={},p=0,h=Object.keys(t);p<h.length;p++){var f=h[p];if("@context"!==f){var d=w.__expandURI(e,f,{vocab:!0});if(d&&(k.isAbsolute(d)||k.isBNodeID(d)||w.__isKeyword(d))){var g=t[f];if(w.__isKeyword(d)){if("@id"===d&&!T(g))throw new Me('"@id" value must a string.');if("@type"===d&&!w.__isValidType(g))throw new Me('"@type" value must a string, an array of strings.');if("@graph"===d&&!E(g)&&!P(g))throw new Me('"@graph" value must not be an object or an array.');if("@value"===d&&(E(g)||P(g)))throw new Me('"@value" value must not be an object or an array.');if("@language"===d){if(null===g)continue;if(!T(g))throw new Me('"@language" value must be a string.');g=g.toLowerCase()}if("@index"===d&&!T(g))throw new Me('"@index" value must be a string.');if("@reverse"===d&&!E(g))throw new Me('"@reverse" value must be an object.');if("@index"===d||"@reverse"===d)throw new ke('The SDK does not support "@index" and "@reverse" tags.')}var y=void 0;if((o=w.__getContainer(e,f))===z.LANGUAGE&&E(g))y=w.__expandLanguageMap(g);else{var v=f,m="@list"===d;(m||"@set"===d)&&(v=r,m&&"@graph"===r&&(v=null)),y=w.__process(e,g,v,m)}if(null!==y||"@value"===d){"@list"===d||Q.is(y)||o!==z.LIST||(P(y)||(y=[y]),y={"@list":y});var b=-1===["@type","@id","@value","@language"].indexOf(d);w.__addValue(l,d,y,{propertyIsArray:b})}}}}return"@value"in l?null===l["@value"]&&(l=null):"@type"in l?P(l["@type"])||(l["@type"]=[l["@type"]]):"@set"in l&&(l=l["@set"]),l},w.__addValue=function(e,t,r,n){if(P(r)){var o=r;0===o.length&&n.propertyIsArray&&!p(e,t)&&(e[t]=[]);for(var i=0,a=o;i<a.length;i++){var s=a[i];w.__addValue(e,t,s,n)}}else if(t in e){if(!w.__hasValue(e,t,r)){var u=e[t];P(u)||(u=e[t]=[u]),u.push(r)}}else e[t]=n.propertyIsArray?[r]:r},w.__hasProperty=function(e,t){if(t in e){var r=e[t];return!P(r)||0<r.length}return!1},w.__compareValues=function(e,t){if(e===t)return!0;if(E(e)&&E(t)){if("@value"in e&&e["@value"]===t["@value"]&&e["@type"]===t["@type"]&&e["@language"]===t["@language"]&&e["@index"]===t["@index"])return!0;if("@id"in e)return e["@id"]===t["@id"]}return!1},w.__hasValue=function(e,t,r){if(w.__hasProperty(e,t)){var n=e[t],o=Q.is(n);if(o||P(n))for(var i=0,a=o?n["@list"]:n;i<a.length;i++){var s=a[i];if(w.__compareValues(s,r))return!0}else if(!P(r))return w.__compareValues(n,r)}return!1},w}(),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.parse=function(e){return t.prototype.parse.call(this,e).then(Tt.expand)},e}(Ae),St={namespace:"https://carbonldp.com/ns/v1/platform#",AccessPoint:"https://carbonldp.com/ns/v1/platform#AccessPoint",AddMemberAction:"https://carbonldp.com/ns/v1/platform#AddMemberAction",ChildCreatedEvent:"https://carbonldp.com/ns/v1/platform#ChildCreatedEvent",Document:"https://carbonldp.com/ns/v1/platform#Document",DocumentCreatedEventDetails:"https://carbonldp.com/ns/v1/platform#DocumentCreatedEventDetails",DocumentDeletedEvent:"https://carbonldp.com/ns/v1/platform#DocumentDeletedEvent",DocumentMetadata:"https://carbonldp.com/ns/v1/platform#DocumentMetadata",DocumentModifiedEvent:"https://carbonldp.com/ns/v1/platform#DocumentModifiedEvent",ErrorResponse:"https://carbonldp.com/ns/v1/platform#ErrorResponse",Error:"https://carbonldp.com/ns/v1/platform#Error",Instance:"https://carbonldp.com/ns/v1/platform#Instance",Map:"https://carbonldp.com/ns/v1/platform#Map",MemberAddedEvent:"https://carbonldp.com/ns/v1/platform#MemberAddedEvent",MemberAddedEventDetails:"https://carbonldp.com/ns/v1/platform#MemberAddedEventDetails",MemberRemovedEvent:"https://carbonldp.com/ns/v1/platform#MemberRemovedEvent",MemberRemovedEventDetails:"https://carbonldp.com/ns/v1/platform#MemberRemovedEventDetails",NonReadableMembershipResourceTriples:"https://carbonldp.com/ns/v1/platform#NonReadableMembershipResourceTriples",Platform:"https://carbonldp.com/ns/v1/platform#Platform",PlatformInstance:"https://carbonldp.com/ns/v1/platform#PlatformInstance",PreferContainer:"https://carbonldp.com/ns/v1/platform#PreferContainer",PreferContainmentResources:"https://carbonldp.com/ns/v1/platform#PreferContainmentResources",PreferContainmentTriples:"https://carbonldp.com/ns/v1/platform#PreferContainmentTriples",PreferDocumentChecksums:"https://carbonldp.com/ns/v1/platform#PreferDocumentChecksums",PreferMembershipResources:"https://carbonldp.com/ns/v1/platform#PreferMembershipResources",PreferMembershipTriples:"https://carbonldp.com/ns/v1/platform#PreferMembershipTriples",PreferResultsContexts:"https://carbonldp.com/ns/v1/platform#PreferResultsContexts",PreferSelectedMembershipTriples:"https://carbonldp.com/ns/v1/platform#PreferSelectedMembershipTriples",QueryMetadata:"https://carbonldp.com/ns/v1/platform#QueryMetadata",RemoveMemberAction:"https://carbonldp.com/ns/v1/platform#RemoveMemberAction",ResponseMetadata:"https://carbonldp.com/ns/v1/platform#ResponseMetadata",ValidationError:"https://carbonldp.com/ns/v1/platform#ValidationError",VolatileResource:"https://carbonldp.com/ns/v1/platform#VolatileResource",accessPoint:"https://carbonldp.com/ns/v1/platform#accessPoint",bNodesMap:"https://carbonldp.com/ns/v1/platform#bNodesMap",buildDate:"https://carbonldp.com/ns/v1/platform#buildDate",checksum:"https://carbonldp.com/ns/v1/platform#checksum",created:"https://carbonldp.com/ns/v1/platform#created",createdDocument:"https://carbonldp.com/ns/v1/platform#createdDocument",details:"https://carbonldp.com/ns/v1/platform#details",defaultInteractionModel:"https://carbonldp.com/ns/v1/platform#defaultInteractionModel",document:"https://carbonldp.com/ns/v1/platform#document",documentMetadata:"https://carbonldp.com/ns/v1/platform#documentMetadata",entry:"https://carbonldp.com/ns/v1/platform#entry",entryKey:"https://carbonldp.com/ns/v1/platform#entryKey",entryValue:"https://carbonldp.com/ns/v1/platform#entryValue",error:"https://carbonldp.com/ns/v1/platform#error",errorCode:"https://carbonldp.com/ns/v1/platform#errorCode",errorDetails:"https://carbonldp.com/ns/v1/platform#errorDetails",errorMessage:"https://carbonldp.com/ns/v1/platform#errorMessage",errorParameters:"https://carbonldp.com/ns/v1/platform#errorParameters",httpStatusCode:"https://carbonldp.com/ns/v1/platform#httpStatusCode",instance:"https://carbonldp.com/ns/v1/platform#instance",mediaType:"https://carbonldp.com/ns/v1/platform#mediaType",member:"https://carbonldp.com/ns/v1/platform#member",modified:"https://carbonldp.com/ns/v1/platform#modified",requestID:"https://carbonldp.com/ns/v1/platform#requestID",relatedDocument:"https://carbonldp.com/ns/v1/platform#relatedDocument",size:"https://carbonldp.com/ns/v1/platform#size",target:"https://carbonldp.com/ns/v1/platform#target",targetMember:"https://carbonldp.com/ns/v1/platform#targetMember",version:"https://carbonldp.com/ns/v1/platform#version"},Ot={errors:{"@id":St.error,"@type":"@id","@container":"@set"},requestID:{"@id":St.requestID,"@type":be.string},statusCode:{"@id":St.httpStatusCode,"@type":be.int}},Ct={TYPE:St.ErrorResponse,SCHEMA:Ot,is:function(e){return Ie.is(e)&&e.$hasType(Ct.TYPE)},getMessage:function(e){return e.errors.map(function(e){return e.errorMessage}).join(", ")}},xt={is:function(e){return p(e,"@graph")&&P(e["@graph"])},create:function(e,t){return{"@id":t||"","@graph":e}},getDocuments:function(e){return P(e)?e.filter(xt.is):xt.is(e)?[e]:[]},getFreeNodes:function(e){return Array.isArray(e)?e.filter(function(e){return!xt.is(e)}).filter(Pe.is):[]},getResources:function(e){var t=xt.getFreeNodes(e);return xt.getDocuments(e).map(function(e){return e["@graph"]}).forEach(function(e){return t.push.apply(t,e)}),t},getDocumentResources:function(e){return xt.getResources(e).filter(function(e){return!Pe.isFragment(e)})},getNamedFragmentResources:function(e,t){var r=E(t)?Pe.getID(t):t;return xt.getResources(e).filter(function(e){var t=Pe.getID(e);if(k.hasFragment(t))return!r||k.getDocumentURI(t)===r})},getBNodeResources:function(e){return xt.getResources(e).filter(function(e){var t=Pe.getID(e);return k.isBNodeID(t)})},getNodes:function(e){for(var t=[],r=[],n=0,o=e["@graph"];n<o.length;n++){var i=o[n];(Pe.isFragment(i)?r:t).push(i)}return[t,r]}};function Rt(e,t,r){return{_uri:T(t)?k.resolve(e.$id,t):e.$id,_args:T(t)?Array.prototype.slice.call(r,1):Array.from(r)}}function jt(e,t,r){return{_resource:N.is(t)?t:e,_args:N.is(t)?Array.prototype.slice.call(r,1):Array.from(r)}}function Ft(i){return function(o){return"response"in o&&o.response.data?(new Et).parse(o.response.data).then(function(e){var t=xt.getFreeNodes(e),r=De.parseFreeNodes(i,t).getPointers(!0).filter(Ct.is);if(0===r.length)return Promise.reject(o);var n=Object.assign(o,r[0]);return o.message=Ct.getMessage(n),Promise.reject(o)},function(){return Promise.reject(o)}):Promise.reject(o)}}var It,Dt,At={PROTOTYPE:{get $repository(){throw new M('Property "$repository" is required.')},$eTag:void 0,$_resolved:!1,$isResolved:function(){return this.$_resolved},$_snapshot:{},$_syncSnapshot:function(){var e=C.clone(this,{arrays:!0});this.types&&(e.types=this.types.slice()),this.$_snapshot=e},$isDirty:function(){return!C.areEqual(this,this.$_snapshot,{arrays:!0})},$revert:function(){var r,n;n=(r=this).$_snapshot,E(r)&&E(n)&&new Set(Object.keys(r).concat(Object.keys(n))).forEach(function(e){var t=Array.isArray(n[e])?n[e].slice():n[e];null!=t?m(t)||(r[e]=t):delete r[e]}),this.types||(this.types=[])},$get:function(e){var t,r,n=Rt(this,e,arguments),o=n._uri,i=n._args;return"$id"in this.$repository?(t=this.$repository).$get.apply(t,[o].concat(i)):(r=this.$repository).get.apply(r,[o].concat(i))},$resolve:function(e){var t,r,n=jt(this,e,arguments),o=n._resource,i=n._args;return"$id"in this.$repository?(t=this.$repository).$resolve.apply(t,[o].concat(i)):(r=this.$repository).resolve.apply(r,[o].concat(i))},$exists:function(e){var t,r,n=Rt(this,e,arguments),o=n._uri,i=n._args;return"$id"in this.$repository?(t=this.$repository).$exists.apply(t,[o].concat(i)):(r=this.$repository).exists.apply(r,[o].concat(i))},$refresh:function(e){for(var t,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=jt(this,e,arguments),a=i._resource,s=i._args;return"$id"in this.$repository?(t=this.$repository).$refresh.apply(t,[a].concat(s)):(r=this.$repository).refresh.apply(r,[a].concat(s))},$save:function(e){for(var t,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=jt(this,e,arguments),a=i._resource,s=i._args;return"$id"in this.$repository?(t=this.$repository).$save.apply(t,[a].concat(s)):(r=this.$repository).save.apply(r,[a].concat(s))},$saveAndRefresh:function(e){for(var t,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=jt(this,e,arguments),a=i._resource,s=i._args;return"$id"in this.$repository?(t=this.$repository).$saveAndRefresh.apply(t,[a].concat(s)):(r=this.$repository).saveAndRefresh.apply(r,[a].concat(s))},$delete:function(e){for(var t,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=Rt(this,e,arguments),a=i._uri,s=i._args;return"$id"in this.$repository?(t=this.$repository).$delete.apply(t,[a].concat(s)):(r=this.$repository).delete.apply(r,[a].concat(s))}},isDecorated:function(e){return D.hasPropertiesFrom(At.PROTOTYPE,e)},decorate:function(e){if(At.isDecorated(e))return e;var t=D.decorateMultiple(e,N);return D.definePropertiesFrom(At.PROTOTYPE,t)},is:function(e){return N.is(e)&&At.isDecorated(e)}},Mt={PROTOTYPE:{$_queryableMetadata:void 0,$isQueried:function(){return!!this.$_queryableMetadata}},isDecorated:function(e){return D.hasPropertiesFrom(Mt.PROTOTYPE,e)},decorate:function(e){if(Mt.isDecorated(e))return e;var t=D.decorateMultiple(e,At);return D.definePropertiesFrom(Mt.PROTOTYPE,t)},is:function(e){return At.is(e)&&Mt.isDecorated(e)}},kt={PROTOTYPE:{get $registry(){throw new M('Property "$registry" is required.')},get $slug(){return k.generateBNodeID()},get $id(){return k.isBNodeID(this.$slug)?this.$slug:this.$document.$id+"#"+this.$slug},set $id(e){k.isBNodeID(e)?this.$slug=e:this.$slug=k.getFragment(e)},get $document(){return this.$registry},set $document(e){this.$registry=e}},isDecorated:function(e){return Ie.isDecorated(e)},decorate:function(e){if(kt.isDecorated(e))return e;var t=D.decorateMultiple(e,Ie);return t.$registry||delete t.$registry,t.$slug||delete t.$slug,D.definePropertiesFrom(kt.PROTOTYPE,t)},is:function(e){return Ie.is(e)},create:function(e){var t=Object.assign({},e);return kt.createFrom(t)},createFrom:function(e){return kt.decorate(e)}},Lt={PROTOTYPE:{get $repository(){return this.$registry},set $repository(e){this.$registry=e},get $_resolved(){return this.$document.$_resolved},set $_resolved(e){}},isDecorated:function(e){return D.hasPropertiesFrom(Lt.PROTOTYPE,e)},decorate:function(e){if(Lt.isDecorated(e))return e;var t=Object.assign(e,{$document:e.$registry,$repository:e.$registry}),r=D.decorateMultiple(t,kt,Mt);return D.definePropertiesFrom(Lt.PROTOTYPE,r)},create:kt.create,createFrom:kt.createFrom},Nt={namespace:"http://www.w3.org/ns/ldp#",Ascending:"http://www.w3.org/ns/ldp#Ascending",BasicContainer:"http://www.w3.org/ns/ldp#BasicContainer",Container:"http://www.w3.org/ns/ldp#Container",Descending:"http://www.w3.org/ns/ldp#Descending",DirectContainer:"http://www.w3.org/ns/ldp#DirectContainer",IndirectContainer:"http://www.w3.org/ns/ldp#IndirectContainer",RDFSource:"http://www.w3.org/ns/ldp#RDFSource",Resource:"http://www.w3.org/ns/ldp#Resource",MemberSubject:"http://www.w3.org/ns/ldp#MemberSubject",NonRDFSource:"http://www.w3.org/ns/ldp#NonRDFSource",Page:"http://www.w3.org/ns/ldp#Page",PageSortCriterion:"http://www.w3.org/ns/ldp#PageSortCriterion",PreferContainment:"http://www.w3.org/ns/ldp#PreferContainment",PreferEmptyContainer:"http://www.w3.org/ns/ldp#PreferEmptyContainer",PreferMembership:"http://www.w3.org/ns/ldp#PreferMembership",PreferMinimalContainer:"http://www.w3.org/ns/ldp#PreferMinimalContainer",constrainedBy:"http://www.w3.org/ns/ldp#constrainedBy",contains:"http://www.w3.org/ns/ldp#contains",hasMemberRelation:"http://www.w3.org/ns/ldp#hasMemberRelation",insertedContentRelation:"http://www.w3.org/ns/ldp#insertedContentRelation",isMemberOfRelation:"http://www.w3.org/ns/ldp#isMemberOfRelation",member:"http://www.w3.org/ns/ldp#member",membershipResource:"http://www.w3.org/ns/ldp#membershipResource",pageSequence:"http://www.w3.org/ns/ldp#pageSequence",pageSortCollation:"http://www.w3.org/ns/ldp#pageSortCollation",pageSortCriteria:"http://www.w3.org/ns/ldp#pageSortCriteria",pageSortOrder:"http://www.w3.org/ns/ldp#pageSortOrder"};function $t(e){return!r(e)||e.startsWith("#")?e:"#"+e}function Ut(e){return"$id"in e?e.$id:"$slug"in e?k.hasFragment(e.$slug)?e.$slug:$t(e.$slug):k.generateBNodeID()}function qt(n,t,o){void 0===o&&(o=new Set),Object.keys(t).map(function(e){return t[e]}).forEach(function(e){if(Array.isArray(e))return qt(n,e,o);if(v(e)&&!(Yt.is(e)||e._registry&&e._registry!==n)){var t=Ut(e);if(!o.has(t)&&n.$inScope(t,!0)){var r=n.$hasPointer(t,!0)?n.$getPointer(t,!0):n.$createFragment(e,t);o.add(r.$id),qt(n,r,o)}}})}(Dt=It||(It={})).CHILD_CREATED="child.created",Dt.DOCUMENT_MODIFIED="document.modified",Dt.DOCUMENT_DELETED="document.deleted",Dt.MEMBER_ADDED="member.added",Dt.MEMBER_REMOVED="member.removed";var Yt={PROTOTYPE:{$registry:void 0,$_normalize:function(){var t=new Set;qt(this,this,t),this.$getPointers(!0).map(N.getID).filter(k.isBNodeID).filter(function(e){return!t.has(e)}).forEach(this.$removePointer,this)},$_getLocalID:function(e){if(k.isBNodeID(e))return e;if(k.isFragmentOf(e,this.$id))return k.getFragment(e);throw new M('"'+e+'" is out of scope.')},$getPointer:function(e,t){return e=k.resolve(this.$id,e),W.PROTOTYPE.getPointer.call(this,e,t)},$hasFragment:function(e){if(e=$t(e),!this.$inScope(e,!0))return!1;var t=this.$_getLocalID(e);return this.$__resourcesMap.has(t)},$getFragment:function(e){e=$t(e);var t=this.$_getLocalID(e),r=this.$__resourcesMap.get(t);return r||null},$getFragments:function(){return this.$getPointers(!0)},$createFragment:function(e,t){var r=E(e)?e:{};T(e)&&(t=e);var n=t?$t(t):Ut(r),o=this.$_addPointer(Object.assign(r,{$id:n}));return qt(this,o),o},$removeFragment:function(e){var t=$t(N.getID(e));return!!this.$inScope(t,!0)&&this.$removePointer(t)},toJSON:function(t){var e=[Ie.PROTOTYPE.toJSON.call(this,t)].concat(this.$getFragments().map(function(e){return e.toJSON(t)}));return{"@id":this.$id,"@graph":e}}},isDecorated:function(e){return D.hasPropertiesFrom(Yt.PROTOTYPE,e)},decorate:function(e){if(Yt.isDecorated(e))return e;var t=D.definePropertiesFrom({$__modelDecorator:kt},e),r=D.decorateMultiple(t,Ie,W);return D.definePropertiesFrom(Yt.PROTOTYPE,r)},is:function(e){return Ie.is(e)&&W.isDecorated(e)&&Yt.isDecorated(e)},createFrom:function(e){if(Yt.is(e))throw new M("The object provided is already a Document.");var t=Yt.decorate(e);return qt(t,t),t},create:function(e){var t=Object.assign({},e);return Yt.createFrom(t)}};function Vt(e,t,r,n){var o=T(t)?k.resolve(e.$id,t):e.$id,i=m(t)?t:r;return i!==r&&(n=r),{uriPattern:o,onEvent:i,onError:n}}var Ht={PROTOTYPE:{$on:function(e,t,r,n){var o=Vt(this,t,r,n),i=o.uriPattern,a=o.onEvent,s=o.onError;return this.$repository.on(e,i,a,s)},$off:function(e,t,r,n){var o=Vt(this,t,r,n),i=o.uriPattern,a=o.onEvent,s=o.onError;return this.$repository.off(e,i,a,s)},$one:function(e,t,r,n){var o=Vt(this,t,r,n),i=o.uriPattern,a=o.onEvent,s=o.onError;return this.$repository.one(e,i,a,s)},$onChildCreated:function(e,t,r){return this.$on(It.CHILD_CREATED,e,t,r)},$onDocumentModified:function(e,t,r){return this.$on(It.DOCUMENT_MODIFIED,e,t,r)},$onDocumentDeleted:function(e,t,r){return this.$on(It.DOCUMENT_DELETED,e,t,r)},$onMemberAdded:function(e,t,r){return this.$on(It.MEMBER_ADDED,e,t,r)},$onMemberRemoved:function(e,t,r){return this.$on(It.MEMBER_REMOVED,e,t,r)}},isDecorated:function(e){return E(e)&&D.hasPropertiesFrom(Ht.PROTOTYPE,e)},decorate:function(e){if(Ht.isDecorated(e))return e;var t=D.decorateMultiple(e,Yt,At);return D.definePropertiesFrom(Ht.PROTOTYPE,t)}};function Bt(e,t){var r=Array.from(t);return{uri:T(r[0])&&T(N.getID(r[1]))?k.resolve(e.$id,r.shift()):e.$id,params:r}}var zt={PROTOTYPE:{$create:function(e,t,r,n){var o,i=Rt(this,e,arguments),a=i._uri,s=i._args;return(o=this.$repository).create.apply(o,[a].concat(s))},$createAndRetrieve:function(e,t,r,n){var o;void 0===n&&(n={});var i=Rt(this,e,arguments),a=i._uri,s=i._args;return(o=this.$repository).createAndRetrieve.apply(o,[a].concat(s))},$addMember:function(e,t,r){var n,o=Bt(this,arguments),i=o.uri,a=o.params;return(n=this.$repository).addMember.apply(n,[i].concat(a))},$addMembers:function(e,t,r){var n,o=Rt(this,e,arguments),i=o._uri,a=o._args;return(n=this.$repository).addMembers.apply(n,[i].concat(a))},$removeMember:function(e,t,r){var n,o=Bt(this,arguments),i=o.uri,a=o.params;return(n=this.$repository).removeMember.apply(n,[i].concat(a))},$removeMembers:function(e,t,r){var n,o=Rt(this,e,arguments),i=o._uri,a=o._args;return(n=this.$repository).removeMembers.apply(n,[i].concat(a))}},isDecorated:function(e){return E(e)&&D.hasPropertiesFrom(zt.PROTOTYPE,e)},decorate:function(e){if(zt.isDecorated(e))return e;var t=D.decorateMultiple(e,Yt,At);return D.definePropertiesFrom(zt.PROTOTYPE,t)}},Gt={PROTOTYPE:{$get:function(e){for(var t,r,n=this,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];if(!Array.isArray(e))return(t=At.PROTOTYPE.$get).call.apply(t,[this,e].concat(o));var a=e.map(function(e){return k.resolve(n.$id,e)});return(r=this.$repository).get.apply(r,[a].concat(o))},$getChildren:function(e,t,r){var n,o=Rt(this,e,arguments),i=o._uri,a=o._args;return(n=this.$repository).getChildren.apply(n,[i].concat(a))},$getMembers:function(e,t,r){var n,o=Rt(this,e,arguments),i=o._uri,a=o._args;return(n=this.$repository).getMembers.apply(n,[i].concat(a))},$listChildren:function(e,t){var r,n=Rt(this,e,arguments),o=n._uri,i=n._args;return(r=this.$repository).listChildren.apply(r,[o].concat(i))},$listMembers:function(e,t){var r,n=Rt(this,e,arguments),o=n._uri,i=n._args;return(r=this.$repository).listMembers.apply(r,[o].concat(i))}},isDecorated:function(e){return D.hasPropertiesFrom(Gt.PROTOTYPE,e)},decorate:function(e){if(Gt.isDecorated(e))return e;var t=D.decorateMultiple(e,zt,Mt);return D.definePropertiesFrom(Gt.PROTOTYPE,t)}};function Wt(e,t,r,n){var o=e.$id,i=t;return E(r)?n=r:void 0!==r&&(i=r,o=k.resolve(e.$id,t)),{uri:o,query:i,options:n}}var Xt={PROTOTYPE:{$executeASKQuery:function(e,t,r){var n=Wt(this,e,t,r),o=n.uri,i=n.query,a=n.options;return this.$repository.executeASKQuery(o,i,a)},$executeSELECTQuery:function(e,t,r){var n=Wt(this,e,t,r),o=n.uri,i=n.query,a=n.options;return this.$repository.executeSELECTQuery(o,i,a)},$executeUPDATE:function(e,t,r){var n=Wt(this,e,t,r),o=n.uri,i=n.query,a=n.options;return this.$repository.executeUPDATE(o,i,a)},$sparql:function(e){var t=e?k.resolve(this.$id,e):this.$id;return this.$repository.sparql(t)}},isDecorated:function(e){return E(e)&&D.hasPropertiesFrom(Xt.PROTOTYPE,e)},decorate:function(e){if(Xt.isDecorated(e))return e;var t=D.decorateMultiple(e,Yt,At);return D.definePropertiesFrom(Xt.PROTOTYPE,t)}},Qt={TYPE:St.Document,SCHEMA:{contains:{"@id":Nt.contains,"@container":"@set","@type":"@id"},members:{"@id":Nt.member,"@container":"@set","@type":"@id"},membershipResource:{"@id":Nt.membershipResource,"@type":"@id"},isMemberOfRelation:{"@id":Nt.isMemberOfRelation,"@type":"@id"},hasMemberRelation:{"@id":Nt.hasMemberRelation,"@type":"@id"},insertedContentRelation:{"@id":Nt.insertedContentRelation,"@type":"@id"},created:{"@id":St.created,"@type":be.dateTime},modified:{"@id":St.modified,"@type":be.dateTime},defaultInteractionModel:{"@id":St.defaultInteractionModel,"@type":"@id"},accessPoints:{"@id":St.accessPoint,"@type":"@id","@container":"@set"}},PROTOTYPE:{get $__savedFragments(){return[]},$_syncSavedFragments:function(){this.$__savedFragments=Array.from(this.$__resourcesMap.values()),this.$__savedFragments.forEach(function(e){return e.$_syncSnapshot()})},$_syncSnapshot:function(){At.PROTOTYPE.$_syncSnapshot.call(this),this.$_syncSavedFragments()},$isDirty:function(){var t=this;return!!At.PROTOTYPE.$isDirty.call(this)||(!!this.$__savedFragments.some(function(e){return!t.$hasFragment(e.$id)})||(!(this.$__savedFragments.length===this.$__resourcesMap.size)||this.$__savedFragments.some(function(e){return e.$isDirty()})))},$revert:function(){var t=this;At.PROTOTYPE.$revert.call(this),this.$__resourcesMap.clear(),this.$__savedFragments.forEach(function(e){e.$revert(),t.$__resourcesMap.set(e.$slug,e)})}},isDecorated:function(e){return E(e)&&D.hasPropertiesFrom(Qt.PROTOTYPE,e)},is:function(e){return Yt.is(e)&&Xt.isDecorated(e)&&Ht.isDecorated(e)&&Gt.isDecorated(e)&&Qt.isDecorated(e)},decorate:function(e){if(Qt.isDecorated(e))return e;var t=Object.assign(e,{$__modelDecorator:Lt}),r=D.decorateMultiple(t,Xt,Ht,Gt);return D.definePropertiesFrom(Qt.PROTOTYPE,r)},create:Yt.create,createFrom:Yt.createFrom},Jt={TYPE:Nt.DirectContainer,is:function(e){return Yt.is(e)&&e.$hasType(Jt.TYPE)&&e.hasOwnProperty("hasMemberRelation")},create:function(e){var t=Object.assign({},e);return Jt.createFrom(t)},createFrom:function(e){if(Jt.is(e))throw new M("The base object is already a DirectContainer.");if(!e.hasMemberRelation)throw new M("The property hasMemberRelation is required.");var t=Yt.is(e)?e:Yt.createFrom(e);return t.$addType(Jt.TYPE),t}},Kt={TYPE:St.AccessPoint,is:function(e){return Jt.is(e)},create:function(e){var t=Object.assign({},e);return Kt.createFrom(t)},createFrom:function(e){var t=Jt.createFrom(e);return t.$addType(Kt.TYPE),t}},Zt={TYPE:Kt.TYPE,is:function(e){return Kt.is(e)&&Qt.is(e)},create:Kt.create,createFrom:Kt.createFrom},er=function(e){return"TYPE"in e&&"SCHEMA"in e},tr=function(){function e(e){this._parentContext=e,this._typeObjectSchemaMap=new Map,this.jsonldConverter=new Se(e&&e.jsonldConverter.literalSerializers)}return Object.defineProperty(e.prototype,"baseURI",{get:function(){return this._baseURI},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentContext",{get:function(){return this._parentContext},enumerable:!0,configurable:!0}),e.prototype.resolve=function(e){return k.resolve(this.baseURI,e)},e.prototype.hasObjectSchema=function(e){return e=this.__resolveTypeURI(e),!!this._typeObjectSchemaMap.has(e)||!!this.parentContext&&this.parentContext.hasObjectSchema(e)},e.prototype.getObjectSchema=function(e){if(e){if(e=this.__resolveTypeURI(e),this._typeObjectSchemaMap.has(e))return this._typeObjectSchemaMap.get(e);if(this.parentContext&&this.parentContext.hasObjectSchema(e))return this.parentContext.getObjectSchema(e);throw new M('"'+e+"\" hasn't an object schema.")}var t=this._generalObjectSchema?Pt.combineDigestedObjectSchemas([this._generalObjectSchema]):this.parentContext?this.parentContext.getObjectSchema():new xe;return void 0===t.vocab&&this._settings&&this._settings.vocabulary&&(t.vocab=this.resolve(this._settings.vocabulary)),t.base||(t.base=this.baseURI),t},e.prototype.extendObjectSchema=function(e,t){if(T(e)){if(!t)throw new M("An object schema is required.");return this.__extendTypeSchema(t,e)}return er(e)?this.__extendTypeSchema(e.SCHEMA,e.TYPE):Array.isArray(e)?(e.forEach(this.extendObjectSchema,this),this):this.__extendGeneralSchema(e)},e.prototype.clearObjectSchema=function(e){void 0===e?this._generalObjectSchema=this.parentContext?void 0:new xe:(e=this.__resolveTypeURI(e),this._typeObjectSchemaMap.delete(e))},e.prototype._getTypeObjectSchemas=function(e){void 0===e&&(e=[]);var t=new Set(e);return this.__getObjectSchemasTypes().filter(function(e){return!t.has(e)}).map(this.getObjectSchema,this)},e.prototype.__getObjectSchemasTypes=function(){var r=[];if(this._typeObjectSchemaMap.forEach(function(e,t){return r.push(t)}),!this._parentContext)return r;for(var e=this._parentContext.__getObjectSchemasTypes(),t=0,n=r;t<n.length;t++){var o=n[t];-1===e.indexOf(o)&&e.push(o)}return e},e.prototype.__extendGeneralSchema=function(e){var t=this.__getInheritGeneralSchema();return this._generalObjectSchema=Pt._combineSchemas([t,Pt.digestSchema(e)]),this},e.prototype.__extendTypeSchema=function(e,t){t=this.__resolveTypeURI(t);var r=this.__getInheritTypeSchema(t),n=Pt.combineDigestedObjectSchemas([r,Pt.digestSchema(e)]);return this._typeObjectSchemaMap.set(t,n),this},e.prototype.__getInheritGeneralSchema=function(){return this._generalObjectSchema?this._generalObjectSchema:this.parentContext?this.parentContext.getObjectSchema():new xe},e.prototype.__getInheritTypeSchema=function(e){return this._typeObjectSchemaMap.has(e)?this._typeObjectSchemaMap.get(e):this.parentContext&&this.parentContext.hasObjectSchema(e)?this.parentContext.getObjectSchema(e):new xe},e.prototype.__resolveTypeURI=function(e){return this.getObjectSchema().resolveURI(e,{vocab:!0})},e}();function rr(t,e,r){if(!t)return new xe;void 0===r||k.hasFragment(r)||k.isBNodeID(r)||-1!==e.indexOf(St.Document)||(e=e.concat(St.Document));var n=e.filter(function(e){return t.hasObjectSchema(e)}).map(function(e){return t.getObjectSchema(e)});return Pt._combineSchemas([t.getObjectSchema()].concat(n))}var nr={PROTOTYPE:{context:void 0,getGeneralSchema:function(){return this.context?this.context.getObjectSchema():new xe},hasSchemaFor:function(e,t){return!t},getSchemaFor:function(e){return"types"in e||"$id"in e?rr(this.context,(n=e).types||[],n.$id):(t=this.context,r=e,rr(t,Pe.getTypes(r),r["@id"]));var t,r,n}},isDecorated:function(e){return D.hasPropertiesFrom(nr.PROTOTYPE,e)},decorate:function(e){return D.definePropertiesFrom(nr.PROTOTYPE,e)}},or={PROTOTYPE:{get context(){throw new M("Property context is required.")},get registry(){if(this.context&&this.context.parentContext)return this.context.parentContext.registry},set registry(e){},get __modelDecorators(){return new Map},addDecorator:function(e){if(!e.TYPE)throw new M("No TYPE specified in the model decorator.");return this.__modelDecorators.set(e.TYPE,e),this},decorate:function(t){var r=this;t.types&&t.types.filter(function(e){return r.__modelDecorators.has(e)}).map(function(e){return r.__modelDecorators.get(e)}).forEach(function(e){return e.decorate(t)})},_addPointer:function(e){this.context.repository&&Object.assign(e,{$repository:this.context.repository});var t=W.PROTOTYPE._addPointer.call(this,e);return t.$id=this.context.getObjectSchema().resolveURI(t.$id,{base:!0}),t},_getLocalID:function(e){var t=this.context.getObjectSchema().resolveURI(e,{base:!0});if(!k.isAbsolute(t)||!k.isBaseOf(this.context.baseURI,t))throw new M('"'+t+'" is out of scope.');return k.getRelativeURI(t,this.context.baseURI)}},isDecorated:function(e){return D.hasPropertiesFrom(or.PROTOTYPE,e)},decorate:function(e){if(or.isDecorated(e))return e;var t=D.decorateMultiple(e,W,nr);return t.context||delete t.context,D.definePropertiesFrom(or.PROTOTYPE,t)},create:function(e){return or.createFrom(d({},e))},createFrom:function(e){var t=or.decorate(e);return t.registry&&R.extend(t.__modelDecorators,t.registry.__modelDecorators),t}},ir={PROTOTYPE:{register:function(e){return this.getPointer(e,!0)},_getLocalID:function(e){if(k.hasFragment(e))throw new M('"'+e+'" is out of scope.');return or.PROTOTYPE._getLocalID.call(this,e)}},isDecorated:function(e){return D.hasPropertiesFrom(ir.PROTOTYPE,e)},decorate:function(e){if(ir.isDecorated(e))return e;var t=Object.assign(e,{__modelDecorator:Qt}),r=D.decorateMultiple(t,or);return D.definePropertiesFrom(ir.PROTOTYPE,r)},create:function(e){return ir.createFrom(d({},e))},createFrom:function(e){var t=ir.decorate(e);return or.createFrom(t)}};function ar(){return Promise.reject(new ke("Must be implemented for a specific repository implementation."))}var sr={PROTOTYPE:{get:ar,resolve:ar,exists:ar,refresh:ar,save:ar,saveAndRefresh:ar,delete:ar},isDecorated:function(e){return D.hasPropertiesFrom(sr.PROTOTYPE,e)},decorate:function(e){if(!sr.isDecorated(e))return D.definePropertiesFrom(sr.PROTOTYPE,e)}},ur={PROTOTYPE:{get context(){throw new M('Property "context" is required.')}},isDecorated:function(e){return D.hasPropertiesFrom(ur.PROTOTYPE,e)},decorate:function(e){if(ur.isDecorated(e))return e;var t=D.decorateMultiple(e,sr);return D.definePropertiesFrom(ur.PROTOTYPE,t)},create:function(e){return ur.createFrom(d({},e))},createFrom:function(e){return ur.decorate(e)}};function cr(e){if(!/(access-point|child|\*)\.(created|\*)|(document|\*)\.(modified|deleted|\*)|(member|\*)\.(added|removed|\*)/.test(e))throw new M('Provided event type "'+e+'" is invalid.')}function lr(e,t){if(!k.isBaseOf(t,e))throw new M('"'+e+'" is out of scope.');return"/"===e?"":(e=(e=k.getRelativeURI(e,t)).substring(+e.startsWith("/"),e.length-+e.endsWith("/"))).split("/").map(function(e){return"**"===e?"#":encodeURIComponent(e).replace(/\./g,"^")}).join(".")}function pr(e,t,r){return cr(e),"/topic/"+e+((t=lr(t,r))?"."+t:t)}var hr={PROTOTYPE:{on:function(e,t,r,n){try{var o=pr(e,t,this.context.baseURI);this.context.messaging.subscribe(o,r,n)}catch(e){if(!n)throw e;n(e)}},off:function(e,t,r,n){try{var o=pr(e,t,this.context.baseURI);this.context.messaging.unsubscribe(o,r)}catch(e){if(!n)throw e;n(e)}},one:function(e,t,r,n){var o=this;try{var i=pr(e,t,this.context.baseURI),a=function(e){r(e),o.context.messaging.unsubscribe(i,a)};this.context.messaging.subscribe(i,a,n)}catch(e){if(!n)throw e;n(e)}},onChildCreated:function(e,t,r){return this.on(It.CHILD_CREATED,e,t,r)},onDocumentModified:function(e,t,r){return this.on(It.DOCUMENT_MODIFIED,e,t,r)},onDocumentDeleted:function(e,t,r){return this.on(It.DOCUMENT_DELETED,e,t,r)},onMemberAdded:function(e,t,r){return this.on(It.MEMBER_ADDED,e,t,r)},onMemberRemoved:function(e,t,r){return this.on(It.MEMBER_REMOVED,e,t,r)}},isDecorated:function(e){return E(e)&&D.hasPropertiesFrom(hr.PROTOTYPE,e)},decorate:function(e){if(hr.isDecorated(e))return e;var t=D.decorateMultiple(e,ur);return D.definePropertiesFrom(hr.PROTOTYPE,t)}},fr=function(){function e(e){this.token="base",this.iri=e}return e.prototype.toString=function(){return"BASE "+this.iri},e}(),dr=function(){function e(e,t){this.token="bind",this.expression=e,this.variable=t}return e.prototype.toString=function(e){return"BIND("+this.expression+" AS "+this.variable+")"},e}();function gr(e){return void 0===e?" ":"\n"}function yr(e,t){return void 0===e?"":(t&&(e+=t)," ".repeat(e))}function vr(e,t){return void 0===e?e:e+t}function mr(e){var t=e.spaces,r=e.tags,o=e.tokensSeparator,n=e.tokens;if(!n.length)return r.open+r.close;var i=gr(t),a=vr(t,4),s=n.map(function(e,t,r){var n=e.toString(a);return o&&t!==r.length-1?"."===o&&"subject"!==e.token?n:n+o:n});if(1===s.length&&!s[0].includes("\n"))return r.open+" "+s+" "+r.close;var u=yr(a),c=s.map(function(e){return u+e}).join(i),l=yr(t);return r.open+i+c+i+l+r.close}var br=function(){function e(){this.token="blankNodeProperty",this.properties=[]}return e.prototype.addProperty=function(e){return this.properties.push(e),this},e.prototype.toString=function(e){return mr({spaces:e,tags:{open:"[",close:"]"},tokensSeparator:";",tokens:this.properties})},e}(),wr=/^_:[A-Za-z0-9_]([A-Za-z0-9_\-.]*[A-Za-z0-9_\-])?$/,_r=function(){function e(e){if(this.token="blankNode",e){if(!wr.test(e))throw new Error("Invalid blank node label.");this.label=e}}return e.prototype.toString=function(e){return this.label?this.label:"[]"},e}(),Pr=function(){function e(){this.token="collection",this.objects=[]}return e.prototype.addObject=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.objects).push.apply(e,t),this},e.prototype.toString=function(e){return mr({spaces:e,tags:{open:"(",close:")"},tokens:this.objects})},e}(),Tr=function(){function e(){this.token="groupPattern",this.patterns=[]}return e.prototype.addPattern=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.patterns).push.apply(e,t),this},e.prototype.toString=function(e){return mr({spaces:e,tags:{open:"{",close:"}"},tokensSeparator:".",tokens:this.patterns})},e}(),Er=function(){function e(){this.token="where",this.groupPattern=new Tr}return e.prototype.toString=function(e){return(void 0===e?"":"WHERE ")+this.groupPattern.toString(e)},e}(),Sr=function(){function e(){this.where=new Er,this.modifiers=[]}return e.prototype.addPattern=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.where.groupPattern.patterns).push.apply(e,t),this},e.prototype.addModifier=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.modifiers).push.apply(e,t),this},e}(),Or=function(t){function e(){var e=t.call(this)||this;return e.token="construct",e.triples=[],e}return i(e,t),e.prototype.addTriple=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.triples).push.apply(e,t),this},e.prototype.toString=function(e){var t=mr({spaces:e,tags:{open:"{",close:"}"},tokensSeparator:".",tokens:this.triples}),r=gr(e),n="CONSTRUCT "+t+r+this.where.toString(e);return this.modifiers.length&&(n+=r+this.modifiers.join(r)),n},e}(Sr),Cr=function(){function e(e){this.token="filter",this.constraint=e}return e.prototype.toString=function(e){return"FILTER( "+this.constraint+" )"},e}(),xr=function(){function e(e,t){void 0===t&&(t=!1),this.token="from",this.source=e,this.named=t}return e.prototype.toString=function(e){var t="FROM ";return this.named&&(t+="NAMED "),t+this.source},e}(),Rr=function(){function e(e){this.token="graph",this.graph=e,this.groupPattern=new Tr}return e.prototype.addPattern=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.groupPattern.patterns).push.apply(e,t),this},e.prototype.toString=function(e){return"GRAPH "+this.graph+" "+this.groupPattern.toString(e)},e}(),jr=function(){function e(e){this.token="group",this.rawCondition=e}return e.prototype.toString=function(e){return"GROUP BY "+this.rawCondition},e}(),Fr=function(){function e(e){this.token="having",this.rawCondition=e}return e.prototype.toString=function(e){return"HAVING "+this.rawCondition},e}(),Ir=function(){function e(e){this.token="iri",this.value=e}return e.prototype.toString=function(e){return"<"+this.value+">"},e}(),Dr=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,Ar=function(){function e(e){if(this.token="language",!Dr.test(e))throw new Error('"'+e+'" is an invalid language tag.');this.tag=e}return e.prototype.toString=function(e){return"@"+this.tag},e}(),Mr=function(){function e(e){this.token="limit",this.value=e}return e.prototype.toString=function(){return"LIMIT "+this.value},e}(),kr=function(){function e(e){this.token="literal",this.value=e}return e.prototype.toString=function(e){return JSON.stringify(this.value)},e}(),Lr=function(){function e(){this.token="minusPattern",this.groupPattern=new Tr}return e.prototype.toString=function(e){return"MINUS "+this.groupPattern.toString(e)},e}(),Nr=function(){function e(e){this.token="offset",this.value=e}return e.prototype.toString=function(e){return"OFFSET "+this.value},e}(),$r=function(){function e(){this.token="optional",this.groupPattern=new Tr}return e.prototype.addPattern=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.groupPattern.patterns).push.apply(e,t),this},e.prototype.toString=function(e){return"OPTIONAL "+this.groupPattern.toString(e)},e}(),Ur=function(){function e(e,t){this.token="order",this.condition=e,t&&(this.flow=t)}return e.prototype.toString=function(e){return"ORDER BY "+(this.flow?this.flow+"( "+this.condition+" )":""+this.condition)},e}(),qr=function(){function e(){this.token="pathAlternative",this.paths=[]}return e.prototype.addPath=function(e){return this.paths.push(e),this},e.prototype.toString=function(){return this.paths.join("|")},e}(),Yr=function(){function e(e){this.token="pathInverse",this.path=e}return e.prototype.toString=function(){return"^"+this.path},e}(),Vr=function(){function e(e,t){this.token="pathMod",this.path=e,this.mod=t}return e.prototype.toString=function(){return""+this.path+this.mod},e}(),Hr=function(){function e(e){this.token="pathNegated",this.path=e}return e.prototype.toString=function(){return"!"+this.path},e}(),Br=function(){function e(){this.token="pathSequence",this.paths=[]}return e.prototype.addPath=function(e){return this.paths.push(e),this},e.prototype.toString=function(){return this.paths.join("/")},e}(),zr=/^([A-Za-z](([A-Za-z_\-0-9]|\.)*[A-Za-z_\-0-9])?)?$/,Gr=function(){function e(e,t){var r;this.token="prefixedName";var n=e;if(void 0===t){if(!c(e))throw new Error("Invalid prefixed name.");n=(r=e.split(/:(.*)/))[0],t=r[1]}if(!zr.test(n))throw new Error("Invalid prefixed namespace.");this.namespace=n;var o=t.split(/^(.)(?:(.*)?(.))?$/),i=o[1],a=o[2],s=o[3],u="";i&&(u+=i.replace(/([\-.])/g,"\\$1")),a&&(u+=a),s&&(u+=s.replace(/([.])/g,"\\$1")),this.localName=u.replace(/([~!$&'|()*+,;=/?#@%])/g,"\\$1")}return e.prototype.toString=function(e){return this.namespace+":"+this.localName},e}(),Wr=function(){function e(e,t){this.token="prefix",this.namespace=e,this.iri=t}return e.prototype.toString=function(e){return"PREFIX "+this.namespace+": "+this.iri},e}(),Xr=function(){function e(e){this.token="property",this.verb=e,this.objects=[]}return e.prototype.addObject=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.objects).push.apply(e,t),this},e.prototype.toString=function(t){var e=gr(t),r=""+this.verb,n=vr(t,r.length+1),o=yr(n);return r+" "+this.objects.map(function(e){return"collection"===e.token||"blankNodeProperty"===e.token?e.toString(t):e.toString(n)}).join(","+e+o)},e}(),Qr=function(){function e(e,t){this.token="query",this.prologues=[],this.queryClause=e,this.values=t}return e.prototype.addPrologues=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.prologues).push.apply(e,t),this},e.prototype.toString=function(e){var t=gr(e),r=this.prologues.map(function(e){return"base"===e.token?e+"\n":e+t}).join("");return this.queryClause&&(r+=this.queryClause.toString(e)),this.values&&(r+=t+this.values.toString(e)),r},e}(),Jr=function(n){function e(e,t){var r=n.call(this,e)||this;return t&&("language"===t.token?r.language=t:r.type=t),r}return i(e,n),e.prototype.toString=function(e){var t=n.prototype.toString.call(this);return this.language?t+this.language:this.type?t+"^^"+this.type:t},e}(kr),Kr=function(r){function e(e){var t=r.call(this)||this;return t.modifier=e,t.variables=[],t}return i(e,r),e.prototype.addVariable=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.variables).push.apply(e,t),this},e.prototype.toString=function(e){var t="SELECT";return this.modifier&&(t+=" "+this.modifier),t+=this.variables.length?" "+this.variables.join(" "):" *"},e}(Sr),Zr=function(n){function e(e){var t=n.call(this,e)||this;return t.token="select",t.datasets=[],t}return i(e,n),e.prototype.toString=function(e){var t=n.prototype.toString.call(this,e),r=gr(e);return this.datasets.length&&(t+=r+this.datasets.join(r)),t+=r+this.where.toString(e),this.modifiers.length&&(t+=r+this.modifiers.join(r)),t},e}(Kr),en=function(){function e(e,t){this.token="servicePattern",this.modifier=t,this.resource=e,this.groupPattern=new Tr}return e.prototype.toString=function(e){var t="SERVICE ";return this.modifier&&(t+="SILENT "),t+=this.resource+" "+this.groupPattern.toString(e)},e}(),tn=function(){function e(e){this.token="subject",this.subject=e,this.properties=[]}return e.prototype.addProperty=function(e){return this.properties.push(e),this},e.prototype.toString=function(e){var t=this.subject.toString(e),r=this.properties.length?"collection"!==this.subject.token&&"blankNodeProperty"!==this.subject.token||!t.includes("\n")?" ":"\n":"",n=vr(e," "===r?t.length+1:4),o=yr(n);return"\n"===r&&(r+=o),t+r+this.properties.map(function(e){return e.toString(n)}).join(";"+gr(e)+o)},e}(),rn=function(a){function e(e,t){var r=a.call(this,e)||this;return r.token="subSelect",r.values=t,r}return i(e,a),e.prototype.toString=function(e){var t=vr(e,4),r=yr(t),n=gr(e),o=a.prototype.toString.call(this,e)+n+r+this.where.toString(t);this.modifiers.length&&(o+=n+this.modifiers.map(function(e){return r+e}).join(n)),this.values&&(o+=n+r+this.values);var i=yr(e);return"{"+n+r+o+n+i+"}"},e}(Kr),nn=function(){function e(){this.token="unionPattern",this.groupPatterns=[]}return e.prototype.toString=function(t){return this.groupPatterns.map(function(e){return e.toString(t)}).join(" UNION ")},e}(),on=function(){function e(){this.token="values",this.variables=[],this.values=[]}return e.prototype.addVariables=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.variables).push.apply(e,t),this},e.prototype.addValues=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.values.push(e),this},e.prototype.toString=function(e){return"VALUES "+this._getVariablesStr()+" "+this._getValuesStr(e)},e.prototype._getVariablesStr=function(){if(!this.variables.length)return"()";var e=this.variables.join(" ");return 1===this.variables.length?e:"( "+e+" )"},e.prototype._getValuesStr=function(e){if(!this.values.length)return"{}";if(1===this.variables.length){var t=this.values.filter(function(e){return e.length}).map(function(e){return e[0]}).join(" ");return t?"{ "+t+" }":"{}"}var r=yr(e,4),n=gr(e),o=yr(e);return"{"+n+this.values.map(function(e){var t=e.length?"( "+e.join(" ")+" )":"()";return r+t}).join(n)+n+o+"}"},e}(),an=/^((?:[0-9A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF]))((?:[0-9A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF]))*$/,sn=function(){function e(e){if(this.token="variable",!an.test(e))throw new Error("Invalid variable name");this.name=e}return e.prototype.toString=function(e){return"?"+this.name},e}(),un=function(t){function e(e){return void 0===e&&(e=""),t.call(this,e)||this}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"IllegalStateError"},enumerable:!0,configurable:!0}),e}(A),cn=function e(t){var r=this.constructor;this.iriResolver=t.iriResolver,this.targetToken=t.targetToken,r===e&&Object.freeze(this)},ln={createFrom:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(r,e){return t.reduce(function(e,t){return t(r,e)},e)}}},pn=function(){function n(e,t){var r=this.constructor;this.prefixes=e?new Map(e.prefixes.entries()):new Map,this.vocab=t||e&&e.vocab,r===n&&Object.freeze(this)}return n.prototype.resolve=function(e,t){return c(e)?this.resolvePrefixed(e):this.resolveIRIRef(e,t)},n.prototype.resolveIRIRef=function(e,t){return void 0===t&&(t=!1),t&&this.vocab&&r(e)&&(e=this.vocab+e),new Ir(e)},n.prototype.resolvePrefixed=function(e){var t=new Gr(e),r=this.prefixes.get(t.namespace);if(void 0===r)throw new Error('The prefix "'+t.namespace+'" has not been declared.');return r||this.prefixes.set(t.namespace,!0),t},n}(),hn=function(n){function o(e){var t=this.constructor,r=n.call(this,e)||this;return r.selectFinishClauseFactory=e.selectFinishClauseFactory,r.askFinishClauseFactory=e.askFinishClauseFactory,t===o&&Object.freeze(r),r}return i(o,n),o}(cn),fn={createFrom:function(t,r){var e=function(){return t.targetToken.toString(0)};return Object.assign(r,{toCompactString:function(){return t.targetToken.toString()},toPrettyString:e,toString:e,debug:function(e){return e.call(void 0,r,t),r}})}},dn={createFrom:function(e,t){return Object.assign(t,{getPattern:function(){return e.targetToken}})}},gn=function(e,t){return ln.createFrom(dn.createFrom,fn.createFrom)(e,t)};function yn(e,t){void 0===t&&(t={});var r=Object.create(Object.getPrototypeOf(e)),n=Object.assign(r,e,t);return Object.freeze(n)}function vn(e,t){var r,n,o;return yn(e,{targetToken:"query"===e.targetToken.token?(r=e.targetToken,n=t,o=mn(r.queryClause,n),yn(r,{queryClause:o})):mn(e.targetToken,t)})}function mn(e,t){return yn(e,{modifiers:e.modifiers.concat(t)})}var bn={createFrom:function(e,t,r){return Object.assign(r,{limit:(n=e,o=t,function(e){var t=new Mr(e),r=vn(o,t);return n(r,{})})});var n,o}};var wn={createFrom:function(e,t,r){return Object.assign(r,{offset:(n=e,o=t,function(e){var t=new Nr(e),r=vn(o,t);return n(r,{})})});var n,o}},_n={createFrom:dn.createFrom};var Pn={createFrom:function(e,t){return _n.createFrom(e,Object.assign(t,{and:(a=e,function(e){var t;e=Array.isArray(e)?e:[e];var r=new Tr;(t=r.patterns).push.apply(t,e.map(function(e){return e.getPattern()}));var n=a.targetToken.groupPatterns.concat(r),o=yn(a.targetToken,{groupPatterns:n}),i=new cn({iriResolver:a.iriResolver,targetToken:o});return Pn.createFrom(i,{})})}));var a}};var Tn=function(e,t){return _n.createFrom(e,Object.assign(t,{union:(i=e,function(e){var t;e=Array.isArray(e)?e:[e];var r=new Tr;(t=r.patterns).push.apply(t,e.map(function(e){return e.getPattern()}));var n=new nn;n.groupPatterns.push(i.targetToken,r);var o=new cn({iriResolver:i.iriResolver,targetToken:n});return Pn.createFrom(o,{})})}));var i};var En={namespace:"http://www.w3.org/2001/XMLSchema#",boolean:"http://www.w3.org/2001/XMLSchema#boolean",byte:"http://www.w3.org/2001/XMLSchema#byte",date:"http://www.w3.org/2001/XMLSchema#date",dateTime:"http://www.w3.org/2001/XMLSchema#dateTime",decimal:"http://www.w3.org/2001/XMLSchema#decimal",double:"http://www.w3.org/2001/XMLSchema#double",duration:"http://www.w3.org/2001/XMLSchema#duration",float:"http://www.w3.org/2001/XMLSchema#float",gDay:"http://www.w3.org/2001/XMLSchema#gDay",gMonth:"http://www.w3.org/2001/XMLSchema#gMonth",gMonthDay:"http://www.w3.org/2001/XMLSchema#gMonthDay",gYear:"http://www.w3.org/2001/XMLSchema#gYear",gYearMonth:"http://www.w3.org/2001/XMLSchema#gYearMonth",int:"http://www.w3.org/2001/XMLSchema#int",integer:"http://www.w3.org/2001/XMLSchema#integer",long:"http://www.w3.org/2001/XMLSchema#long",negativeInteger:"http://www.w3.org/2001/XMLSchema#negativeInteger",nonNegativeInteger:"http://www.w3.org/2001/XMLSchema#nonNegativeInteger",nonPositiveInteger:"http://www.w3.org/2001/XMLSchema#nonPositiveInteger",object:"http://www.w3.org/2001/XMLSchema#object",positiveInteger:"http://www.w3.org/2001/XMLSchema#positiveInteger",short:"http://www.w3.org/2001/XMLSchema#short",string:"http://www.w3.org/2001/XMLSchema#string",time:"http://www.w3.org/2001/XMLSchema#time",unsignedByte:"http://www.w3.org/2001/XMLSchema#unsignedByte",unsignedInt:"http://www.w3.org/2001/XMLSchema#unsignedInt",unsignedLong:"http://www.w3.org/2001/XMLSchema#unsignedLong",unsignedShort:"http://www.w3.org/2001/XMLSchema#unsignedShort"};function Sn(e){return e instanceof Date?new Jr(e.toISOString(),c(t=En.dateTime)?new Gr(t):new Ir(t)):"object"==typeof e?e.getSubject():"string"==typeof e&&"UNDEF"===e?e:new kr(e);var t}function On(i){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=i.targetToken.values.slice();r.push(e.map(Sn));var n=yn(i.targetToken,{values:r}),o=yn(i,{targetToken:n});return xn.createFrom(o,{})}}var Cn=function(e,t){return _n.createFrom(e,Object.assign(t,{has:On(e)}))},xn={createFrom:function(e,t){return _n.createFrom(e,Object.assign(t,{and:On(e)}))}};function Rn(o){return function(e){var t=o.targetToken.values.slice();t.length||t.push([]),t[0]=t[0].concat(Sn(e));var r=yn(o.targetToken,{values:t}),n=yn(o,{targetToken:r});return Fn.createFrom(n,{})}}var jn=function(e,t){return _n.createFrom(e,Object.assign(t,{has:Rn(e)}))},Fn={createFrom:function(e,t){return _n.createFrom(e,Object.assign(t,{and:Rn(e)}))}};function In(e,t){return new cn({iriResolver:e.iriResolver,targetToken:t})}function Dn(e,t){var r=In(e,t);return _n.createFrom(r,{})}function An(i,a){return function(e,t){var r,n="string"==typeof e?i.iriResolver.resolve(e):e.getSubject(),o=new en(n,a);return t=Array.isArray(t)?t:[t],(r=o.groupPattern.patterns).push.apply(r,t.map(function(e){return e.getPattern()})),Dn(i,o)}}var Mn=function(e,t){return Object.assign(t,{undefined:"UNDEF",graph:(c=e,function(e,t){var r="string"==typeof e?c.iriResolver.resolve(e):e.getSubject(),n=new Rr(r);return t=Array.isArray(t)?t:[t],n.addPattern.apply(n,t.map(function(e){return e.getPattern()})),Dn(c,n)}),group:(u=e,function(e){var t,r=new Tr;e=Array.isArray(e)?e:[e],(t=r.patterns).push.apply(t,e.map(function(e){return e.getPattern()}));var n=In(u,r);return Tn(n,{})}),union:(s=e,function(e){var t=new nn,r=In(s,t);return Pn.createFrom(r,{}).and(e)}),optional:(a=e,function(e){var t=new $r;return e=Array.isArray(e)?e:[e],t.addPattern.apply(t,e.map(function(e){return e.getPattern()})),Dn(a,t)}),minus:(n=e,function(e){var t;e=Array.isArray(e)?e:[e];var r=new Lr;return(t=r.groupPattern.patterns).push.apply(t,e.map(function(e){return e.getPattern()})),Dn(n,r)}),service:An(e),serviceSilent:An(e,"SILENT"),filter:(r=e,function(e){var t=new Cr(e);return Dn(r,t)}),bind:(o=e,function(e,t){var r="string"==typeof t?new sn(t):t.getSubject(),n=new dr(e,r);return Dn(o,n)}),values:(i=e,function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=new on;(e=n.variables).push.apply(e,t.map(function(e){return e.getSubject()}));var o=In(i,n);return 1===t.length?jn(o,{}):Cn(o,{})})});var i,o,r,n,a,s,u,c},kn=function(n){function o(e){var t=this.constructor,r=n.call(this,e)||this;return r.fluentPathFactory=e.fluentPathFactory,r.deniableFluentPathFactory=e.deniableFluentPathFactory,t===o&&Object.freeze(r),r}return i(o,n),o}(cn);function Ln(e,t){return"a"===t?t:"string"==typeof t?e.iriResolver.resolve(t,!0):"token"in t?t:"getSubject"in t?t.getSubject():t.getPath()}var Nn=function(){function e(e){this.token="subPath",this.path=e}return e.prototype.toString=function(){return this.path?"("+this.path+")":"()"},e}();function $n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return"a"===e?e:-1!==t.indexOf(e.token)?new Nn(e):e}}function Un(e){return"a"===e||"iri"===e.token||"prefixedName"===e.token}function qn(e){return Un(e)||"pathInverse"===e.token&&Un(e.path)}var Yn=$n("pathAlternative");function Vn(s){return function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t.reduce(function(e,t){return e.concat(t)},[]).map(function(e){return Ln(s,e)});!s.targetToken||s.targetToken instanceof qr||n.unshift(s.targetToken);var o=n.map(Yn);s.targetToken instanceof qr&&o.unshift.apply(o,s.targetToken.paths);var i=new qr;(e=i.paths).push.apply(e,o);var a=new kn(d({},s,{targetToken:i}));return o.every(qn)?s.deniableFluentPathFactory(a,{}):s.fluentPathFactory(a,{})}}var Hn=$n("pathAlternative","pathSequence","pathInverse");function Bn(i){return function(e){var t=i.targetToken?i.targetToken:Ln(i,e),r=Hn(t),n=new Yr(r),o=new kn(d({},i,{targetToken:n}));return Un(t)?i.deniableFluentPathFactory(o,{}):i.fluentPathFactory(o,{})}}var zn=$n("pathAlternative","pathSequence","pathInverse","pathMod");function Gn(i,a){return function(e){var t=i.targetToken?i.targetToken:Ln(i,e),r=zn(t),n=new Vr(r,a),o=new kn(d({},i,{targetToken:n}));return i.fluentPathFactory(o,{})}}var Wn=$n("pathAlternative","pathSequence");function Xn(s){return function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t.reduce(function(e,t){return e.concat(t)},[]).map(function(e){return Ln(s,e)});!s.targetToken||s.targetToken instanceof Br||n.unshift(s.targetToken);var o=n.map(Wn);s.targetToken instanceof Br&&o.unshift.apply(o,s.targetToken.paths);var i=new Br;(e=i.paths).push.apply(e,o);var a=new kn(d({},s,{targetToken:i}));return s.fluentPathFactory(a,{})}}function Qn(i){return function(e){var t,r=i.targetToken?i.targetToken:void 0===e?e:Ln(i,e),n=new Nn(r),o=new kn(d({},i,{targetToken:n}));return!(t=r)||qn(t)||"pathAlternative"===t.token&&t.paths.every(qn)?i.deniableFluentPathFactory(o,{}):i.fluentPathFactory(o,{})}}var Jn=function(e,t){return Object.assign(t,{getPath:function(){return e.targetToken}})},Kn={createFrom:function(e,t){return Jn(e,Object.assign(t,{subPath:Qn(e),or:Vn(e),then:Xn(e),inverse:Bn(e),oneOrNone:Gn(e,"?"),zeroOrMore:Gn(e,"*"),onceOrMore:Gn(e,"+")}))}},Zn=$n("pathAlternative");function eo(i){return function(e){var t=i.targetToken?i.targetToken:Ln(i,e),r=Zn(t),n=new Hr(r),o=new kn(d({},i,{targetToken:n}));return i.fluentPathFactory(o,{})}}var to={createFrom:function(e,t){return Kn.createFrom(e,Object.assign(t,{negated:eo(e)}))}},ro=function(e,t){return Object.assign(t,{subPath:Qn(e),alternatives:Vn(e),sequences:Xn(e),inverse:Bn(e),negated:eo(e),oneOrNone:Gn(e,"?"),zeroOrMore:Gn(e,"*"),onceOrMore:Gn(e,"+")})};function no(e,t){return new kn(d({},e,{targetToken:t,fluentPathFactory:Kn.createFrom,deniableFluentPathFactory:to.createFrom}))}function oo(o){return function(e){if("function"!=typeof e)return r=no(t=o,Ln(t,e)),to.createFrom(r,{});var t,r,n=no(o);return e(ro(n,{}))}}var io=function(e,t){return Object.assign(t,{path:oo(e)})};function ao(p,h){return function(e,t){var r=Ln(h,e),n=new Xr(r);t=Array.isArray(t)?t:[t],n.addObject.apply(n,t.map(Sn));var o,i,a,s,u,c="subject"===h.targetToken.token?(s=n,u=(a=h).targetToken.properties.concat(s),yn(a,{targetToken:yn(a.targetToken,{properties:u})})):(i=n,(o=h).targetToken.properties.push(i),o),l=p(c,{});return uo.createFrom(p,c,l)}}var so=function(e,t,r){return Object.assign(r,{has:ao(e,t)})},uo={createFrom:function(e,t,r){return Object.assign(r,{and:ao(e,t)})}},co=function(e,t){return t},lo={createFrom:function(e,t){return so(co,e,t)}},po={createFrom:dn.createFrom},ho={createFrom:function(e,t){return so(po.createFrom,e,Object.assign(t,{getSubject:function(){return e.targetToken.subject}}))}};var fo=function(e,t){return ho.createFrom(e,Object.assign(t,{withType:(a=e,function(e){e in En&&(e=En[e]);var t=a.iriResolver.resolve(e,!0),r=yn(a.targetToken.subject,{type:t}),n=yn(a.targetToken,{subject:r}),o=yn(a,{targetToken:n});return ho.createFrom(o,{})}),withLanguage:(i=e,function(e){var t=new Ar(e),r=yn(i.targetToken.subject,{language:t}),n=yn(i.targetToken,{subject:r}),o=yn(i,{targetToken:n});return ho.createFrom(o,{})})}));var i,a};function go(e,t){return new cn({iriResolver:e.iriResolver,targetToken:new tn(t)})}function yo(e,t){var r=go(e,t);return ho.createFrom(r,{})}function vo(e,t){var r=go(e,t);return ln.createFrom(ho.createFrom,dn.createFrom)(r,{})}function mo(n){return function(e){return"function"==typeof e?function(e,t){var r=new br,n=new cn({iriResolver:e.iriResolver,targetToken:r});if(t(lo.createFrom(n,{})),r.properties.length<1)throw new Error("At least one property must be specified by the self builder.");return vo(e,r)}(n,e):(t=n,(r=e)&&!r.startsWith("_:")&&(r="_:"+r),yo(t,new _r(r)));var t,r}}var bo=function(e,t){return Object.assign(t,{resource:(n=e,function(e){var t=n.iriResolver.resolve(e);return yo(n,t)}),var:(r=e,function(e){var t=new sn(e);return yo(r,t)}),literal:(i=e,function(e){if("string"!=typeof e){var t=new kr(e);return yo(i,t)}var r=new Jr(e),n=go(i,r);return fo(n,{})}),collection:(o=e,function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=(e=new Pr).addObject.apply(e,t.map(Sn));return vo(o,n)}),blankNode:mo(e)});var o,i,r,n},wo={create:function(e){var t=new cn({iriResolver:e,targetToken:void 0});return wo.createFrom(t,{})},createFrom:function(e,t){return ln.createFrom(bo,Mn,Fo.createFrom,io)(e,t)}};function _o(f,d){return function(e,t){var r,n=new on,o=(r=e,(Array.isArray(r)?r:[r]).map(function(e){return new sn(e)}));n.addVariables.apply(n,o);var i,a,s,u,c=!Array.isArray(e),l=new pn(d.iriResolver);(a=l,s=c,u="function"==typeof(i=t)?i(wo.create(a)):i,Array.isArray(u)?(s&&u.map(function(e){return[e]}),u.some(Array.isArray)?u:[u]):[[u]]).forEach(function(e){return n.addValues.apply(n,e.map(Sn))});var p=yn(d.targetToken,{values:n}),h=yn(d,{iriResolver:l,targetToken:p});return f(h,{})}}var Po={createFrom:function(e,t,r){return Object.assign(r,{values:_o(e,t)})}};var To=function(e,t,r){var n,o,i,a,s=Po.createFrom.bind(null,e),u=ln.createFrom(e,s);return ln.createFrom((i=u,a=wn.createFrom.bind(null,i),function(e,t){return bn.createFrom(ln.createFrom(a,i),e,t)}),(n=u,o=bn.createFrom.bind(null,n),function(e,t){return wn.createFrom(ln.createFrom(n,o),e,t)}),s)(t,r)};var Eo=function(e,t,r){return To(e,t,Object.assign(r,{orderBy:(o=e,i=t,function(e){var t=new Ur(e),r=vn(i,t),n=To(o,r,{});return o(r,n)})}));var o,i};var So=function(e,t,r){return Eo(e,t,Object.assign(r,{having:(o=e,i=t,function(e){var t=new Fr(e),r=vn(i,t),n=Eo(o,r,{});return o(r,n)})}));var o,i};var Oo=function(e,t,r){return So(e,t,Object.assign(r,{groupBy:(o=e,i=t,function(e){var t=new jr(e),r=vn(i,t),n=So(o,r,{});return o(r,n)})}));var o,i};var Co=function(e,t){return Object.assign(t,{where:(a=e,function(e){var t,r=new Er;e=Array.isArray(e)?e:[e],(t=r.groupPattern.patterns).push.apply(t,e.map(function(e){return e.getPattern()}));var n=yn(a.targetToken,{where:r}),o=yn(a,{targetToken:n}),i=Oo(gn,o,{});return gn(o,i)})});var a};function xo(o,i){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new rn(i);e.length&&r.addVariable.apply(r,e.map(function(e){return new sn(e)}));var n=new cn({iriResolver:o.iriResolver,targetToken:r});return Co(n,{})}}var Ro,jo,Fo={createFrom:function(e,t){return Object.assign(t,{select:xo(e),selectDistinct:xo(e,"DISTINCT"),selectReduced:xo(e,"REDUCED"),selectAll:function(){return xo(e)()},selectAllDistinct:function(){return xo(e,"DISTINCT")()},selectAllReduced:function(){return xo(e,"REDUCED")()}})}};(jo=Ro||(Ro={})).CHILD="child",jo.MEMBER="member";var Io,Do,Ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalActionError"},enumerable:!0,configurable:!0}),t}(A);function Mo(e,t){if(void 0===e||!t)return e;var r=t.split("."),n=r[0],o=r.slice(1);return Mo(e[n],o.join("."))}function ko(e,t){return t<=e?e:t}function Lo(e,t,r,n){if(t.properties.has(r)){var o=Ce._resolveProperty(e,t.properties.get(r));return void 0===n||n===o.uri?o:void 0}}(Do=Io||(Io={}))[Do.PARTIAL=0]="PARTIAL",Do[Do.EMPTY=1]="EMPTY",Do[Do.ALL=2]="ALL",Do[Do.FULL=3]="FULL";var No=function(){function n(e){this.queryContainer=e.queryContainer,this.parent=e.parent,this.name=e.name,this.fullName=e.parent?e.parent.fullName+"."+e.name:e.name,this.definition=e.definition,this.pathBuilderFn=e.pathBuilderFn,this.propertyType=e.propertyType,this.optional=void 0===e.optional||e.optional,this.subProperties=new Map,this.values=e.values?e.values:[],this._types=[],this._filters=[]}return Object.defineProperty(n.prototype,"variable",{get:function(){return this.queryContainer.getVariable(this.fullName)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"identifier",{get:function(){return 1===this.values.length?this.values[0]:this.queryContainer.getVariable(this.fullName)},enumerable:!0,configurable:!0}),n.prototype.hasProperties=function(){return 0!==this.subProperties.size||this._isComplete()},n.prototype.getProperty=function(e,t){if(!e)return this;var r=e.split(".").slice(0,1)[0],n=this.subProperties.get(r);if(n){var o=e.substr(r.length+1);return n.getProperty(o)}if(r===e&&t&&t.create&&this._isComplete()){var i=this.addProperty(r,t);return this.propertyType===Io.FULL&&i.setType(Io.ALL),i}},n.prototype.addProperty=function(e,t){var r=this.__getDefinition(e,t);return this._addSubProperty(e,{definition:r,pathBuilderFn:t.path,optional:!t.required})},n.prototype._addSubProperty=function(e,t){var r=new n(d({},t,{name:e,queryContainer:this.queryContainer,parent:this}));return this.subProperties.set(e,r),r},n.prototype.__getDefinition=function(e,t){var r=this.queryContainer.digestProperty(e,t);if(!1===t.inherit)return r;var n="@id"in t?r.uri:void 0,o=this.__getInheritDefinition(e,n);if(o)for(var i in o)null!==r[i]&&"uri"!==i||(r[i]=o[i]);return r},n.prototype.__getInheritDefinition=function(e,t){var r=this._getSearchSchema(),n=Lo(r,r,e,t);if(n)return n;for(var o=0,i=this.queryContainer.context._getTypeObjectSchemas(this._types);o<i.length;o++){var a=Lo(r,i[o],e,t);if(a)return a}},n.prototype._isComplete=function(){return this.propertyType===Io.ALL||this.propertyType===Io.FULL},n.prototype._isPartial=function(){return this.propertyType===Io.PARTIAL||this.propertyType===Io.ALL||!!this.subProperties.size},n.prototype._isEmpty=function(){return void 0===this.propertyType||this.propertyType===Io.EMPTY},n.prototype.setType=function(e){this.propertyType=ko(this.propertyType,e)},n.prototype.addType=function(e){var t=this._getSearchSchema(),r=t.resolveURI(e,{vocab:!0});if(this._types.push(r),this.queryContainer.context.hasObjectSchema(r)){var n=this.queryContainer.context.getObjectSchema(r);Pt._combineSchemas([t,n])}},n.prototype.addValues=function(e){var t;(t=this.values).push.apply(t,e)},n.prototype.addFilter=function(e){this._filters.push(e)},n.prototype.setObligatory=function(e){this.optional&&(this.optional=!1,e&&e.inheritParents&&this.parent&&this.parent.setObligatory(e))},n.prototype._getVariable=function(e){return this.queryContainer.getVariable(this.fullName+"."+e)},n.prototype.__createIRIToken=function(){return this.queryContainer.compactIRI(this.definition.uri)},n.prototype.__createPathToken=function(){if(!this.pathBuilderFn)return this.__createIRIToken();var e=ro(this.queryContainer,{});return this.pathBuilderFn.call(void 0,e).getPath()},n.prototype._getContextVariable=function(){return this.propertyType===Io.FULL?this.__getSelfToken():this._getVariable("_graph")},n.prototype._getContextGraph=function(){return new Rr(this._getContextVariable())},n.prototype.getSelfPattern=function(){var e=this.__createSelfPattern();if(e)return this.optional?(new $r).addPattern(e):e},n.prototype.__createSelfPattern=function(){if(!this.parent)throw new Ao("Cannot create pattern without a parent.");return this.__addPropertyTo(new tn(this.parent.identifier))},n.prototype.__addPropertyTo=function(e){return e.addProperty(new Xr(this.__createPathToken()).addObject(this.identifier))},n.prototype.getSearchPatterns=function(){var e,t=this.__createSearchPatterns();return this.optional?[(e=new $r).addPattern.apply(e,t)]:t},n.prototype.__createSearchPatterns=function(){var e=[],t=this.__createValuesPattern();t&&e.push(t);var r=this.__createSelfPattern();switch(r&&(this.parent&&!this.pathBuilderFn?e.push(this.parent._getContextGraph().addPattern(r)):e.push(r)),this.propertyType){case Io.EMPTY:e.push(this.__createTypesSearchPatterns());break;case Io.PARTIAL:e.push.apply(e,this.__createPartialSearchPatterns());break;case Io.ALL:e.push(this.__createSearchAllPattern()),e.push.apply(e,this.__createSubPropertiesPatterns());break;case Io.FULL:e.push(this.__createSearchGraphPattern()),e.push.apply(e,this.__createSubPropertiesPatterns());break;default:var n=this.__createSelfTypeFilter();n&&e.push(n)}if(this._filters.length){var o=this._filters.map(function(e){return new Cr(e)});e.push.apply(e,o)}return e},n.prototype.__createValuesPattern=function(){if(!(this.values.length<=1)){var t=(new on).addVariables(this.variable);return this.values.forEach(function(e){return t.addValues(e)}),t}},n.prototype.__createSelfTypeFilter=function(){var e=this.identifier;if(this.definition.literal){var t=this.queryContainer.compactIRI(this.definition.literalType);if("variable"===e.token)return new Cr("datatype( "+e+" ) = "+t)}if(null!==this.definition.pointerType&&"variable"===e.token)return new Cr("! isLiteral( "+e+" )")},n.prototype.__createPartialSearchPatterns=function(){return[this.__createTypesSearchPatterns()].concat(this.__createSubPropertiesPatterns())},n.prototype.__createSubPropertiesPatterns=function(){var t=[];return this.subProperties.forEach(function(e){t.push.apply(t,e.getSearchPatterns())}),t},n.prototype.__createTypesSearchPatterns=function(){var e=this.__createTypesPattern(),t=this.propertyType===Io.EMPTY?e:this._getContextGraph().addPattern(e);return this._types.length?(this.__addTypesTo(e),t):(new $r).addPattern(t)},n.prototype.__addTypesTo=function(e){var t,r=this.__createTypesTokens(),n=e.properties.find(function(e){return"a"===e.verb});n||(n=new Xr("a"),e.addProperty(n)),(t=n.objects).unshift.apply(t,r)},n.prototype.__createTypesTokens=function(){var t=this;return this._types.map(function(e){return t.queryContainer.compactIRI(e)})},n.prototype.__createSearchAllPattern=function(){var e=this.__createAllPattern();return this._types.length&&this.__addTypesTo(e),this._getContextGraph().addPattern(e)},n.prototype.__createSearchGraphPattern=function(){var e=new Rr(this.__getSelfToken());if(this._types.length){var t=new tn(this.__getSelfToken());this.__addTypesTo(t),e.addPattern(t)}return e.addPattern(this.__createGraphSubPattern())},n.prototype.__getValuedPatterns=function(){var e;if(!this.optional){var r=new tn(this.identifier),n=[r],t=this.__createValuesPattern();if(t&&n.push(t),this._types.length){var o=this.__createTypesTokens();r.addProperty((e=new Xr("a")).addObject.apply(e,o))}return this.subProperties.forEach(function(e){var t=e.__getValuedPatterns();t&&(e.__addPropertyTo(r),n.push.apply(n,t))}),r.properties.length?n:n.slice(1)}},n.prototype.getConstructPatterns=function(){var r=[],e=this.__createSelfConstructPattern();return e&&r.push(e),this.subProperties.forEach(function(e){var t=e.getConstructPatterns();r.push.apply(r,t)}),r},n.prototype.__createSelfConstructPattern=function(){switch(this.propertyType){case Io.EMPTY:return this.__createTypesPattern();case Io.PARTIAL:return this.__createPartialConstructPattern();case Io.ALL:case Io.FULL:return this.__createCompleteConstructPattern().addProperty(new Xr(this.queryContainer.compactIRI(St.document)).addObject(this._getContextVariable()));default:return}},n.prototype.__createCompleteConstructPattern=function(){switch(this.propertyType){case Io.ALL:return this.__createAllPattern();case Io.FULL:return this.__createGraphSubPattern();default:throw new Ao("Invalid property type")}},n.prototype.__createPartialConstructPattern=function(){var t=this.__createTypesPattern().addProperty(new Xr(this.queryContainer.compactIRI(St.document)).addObject(this._getContextVariable()));return this.subProperties.forEach(function(e){t.addProperty(new Xr(e.__createIRIToken()).addObject(e.identifier))}),t},n.prototype.__createTypesPattern=function(){return new tn(this.identifier).addProperty(new Xr("a").addObject(this._getVariable("types")))},n.prototype.__createAllPattern=function(){return new tn(this.__getSelfToken()).addProperty(new Xr(this._getVariable("_predicate")).addObject(this._getVariable("_object")))},n.prototype.__createGraphSubPattern=function(){return new tn(this._getVariable("_subject")).addProperty(new Xr(this._getVariable("_predicate")).addObject(this._getVariable("_object")))},n.prototype.__getSelfToken=function(){var e=this.identifier;if("literal"===e.token)throw new Ao("Property is not a resource.");return e},n.prototype.getSchemaFor=function(e){switch(this.propertyType){case void 0:return new xe;case Io.EMPTY:case Io.PARTIAL:return this.__createSchema();default:return Pt._combineSchemas([this.queryContainer.context.registry.getSchemaFor(e),this.__createSchema()])}},n.prototype.__createSchema=function(){var t=new xe;return this.subProperties.forEach(function(e){t.properties.set(e.name,e.definition)}),t},n.prototype._getSearchSchema=function(){return this._searchSchema?this._searchSchema:this._searchSchema=this.queryContainer.getGeneralSchema()},n}(),$o=function(r){function e(e){var t=r.call(this,{queryContainer:e.queryContainer,name:e.containerPropertyType,definition:new Oe,optional:!1,propertyType:Io.PARTIAL})||this;return t.containerIRI=e.containerIRI,t.containerPropertyType=e.containerPropertyType,t}return i(e,r),e.prototype.__createSelfPattern=function(){var e=new rn("DISTINCT").addVariable(this.variable);switch(this.containerPropertyType){case Ro.CHILD:e.addPattern(this.__createChildSelfPattern());break;case Ro.MEMBER:e.addPattern.apply(e,this.__createMemberSelfPattern());break;default:throw new un("Invalid container type.")}var t=this.__getValuedPatterns();return t&&e.addPattern.apply(e,t),this.__addOrderTo(e),this.__addLimitTo(e),this.__addOffsetTo(e),e},e.prototype.__createChildSelfPattern=function(){return new tn(this.containerIRI).addProperty(new Xr(this.queryContainer.compactIRI(Nt.contains)).addObject(this.identifier))},e.prototype.__createMemberSelfPattern=function(){var e=this.queryContainer.getVariable("membershipResource"),t=this.queryContainer.getVariable("hasMemberRelation");return[(new rn).addVariable(e,t).addPattern(new tn(this.containerIRI).addProperty(new Xr(this.queryContainer.compactIRI(Nt.membershipResource)).addObject(e)).addProperty(new Xr(this.queryContainer.compactIRI(Nt.hasMemberRelation)).addObject(t))),new tn(e).addProperty(new Xr(t).addObject(this.identifier))]},e.prototype.__addLimitTo=function(e){void 0!==this._limit&&e.addModifier(new Mr(this._limit))},e.prototype.__addOffsetTo=function(e){void 0!==this._offset&&e.addModifier(new Nr(this._offset))},e.prototype.__addOrderTo=function(n){if(this.order){var e=this.getProperty(this.order.path,{create:!0});if(!e)throw new M('Property "'+this.order.path+"\" hasn't been defined.");var t=e.identifier,r="variable"===t.token?t:"( "+t+" )";n.addModifier(new Ur(r,this.order.flow)),this.__createSubPatternsFrom(e).filter(function(t){if("subject"!==t.token)return!0;var r=n.where.groupPattern.patterns.find(function(e){return"subject"===e.token&&e.subject===t.subject});if(!r)return!0;t.properties.forEach(function(t){var e=r.properties.find(function(e){return t.toString()===e.toString()});e||r.addProperty(t),t.objects.forEach(function(t){e.objects.find(function(e){return e.toString()===t.toString()})||e.addObject(t)})})}).forEach(function(e){n.addPattern(e)})}},e.prototype.__createSubPatternsFrom=function(e){for(var t=[];e!==this;){var r=e.getSelfPattern();if("optional"!==r.token?t.unshift(r):t=[r.addPattern.apply(r,t)],!e.parent)break;e=e.parent}return t},e.prototype.__addTypesTo=function(e){},e.prototype.setOrder=function(e){this.order=e},e.prototype.setLimit=function(e){this._limit=e},e.prototype.setOffset=function(e){this._offset=e},e}(No),Uo=function(t){function e(e){return t.call(this,{queryContainer:e.queryContainer,name:"document",definition:new Oe,optional:!1,propertyType:Io.PARTIAL,values:e.values})||this}return i(e,t),e.prototype.__createSelfPattern=function(){},e}(No),qo=function(n){function e(e,t){var r=n.call(this,e.replace(/[.]/g,"__").replace(/[^0-9A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/g,"_"))||this;return r.index=t,r}return i(e,n),e.prototype.toString=function(){return"?_"+this.index},e}(sn),Yo=function(u){function e(e,t){var r,n,o=this,i=e.getObjectSchema();if((o=u.call(this,{iriResolver:(r=i,n=new pn(void 0,r.vocab),Array.from(r.prefixes.keys()).forEach(function(e){return n.prefixes.set(e,!1)}),n),targetToken:void 0,fluentPathFactory:Kn.createFrom,deniableFluentPathFactory:to.createFrom})||this).context=e,o._generalSchema=i,o._prefixesTuples=Array.from(i.prefixes),o._variablesCounter=0,o._variablesMap=new Map,"uris"in t){var a=t.uris.map(o.compactIRI,o);o._queryProperty=new Uo({queryContainer:o,values:a})}else{var s=o.compactIRI(t.uri);o._queryProperty=new $o({queryContainer:o,containerIRI:s,containerPropertyType:t.containerPropertyType})}return o}return i(e,u),e.prototype.getVariable=function(e){if(this._variablesMap.has(e))return this._variablesMap.get(e);var t=new qo(e,this._variablesCounter++);return this._variablesMap.set(e,t),t},e.prototype.compactIRI=function(e){var t=this.__getCompactedIRI(e);return this.iriResolver.resolve(t)},e.prototype.__getCompactedIRI=function(r){if(c(r))return r;var e=this._prefixesTuples.find(function(e){var t=e[1];return r.startsWith(t)});if(!e)return r;var t=e[0],n=e[1];return t+":"+r.substr(n.length)},e.prototype.getPrologues=function(){return this._prefixesTuples.filter(this.__isUsedPrefix,this).map(Vo)},e.prototype.__isUsedPrefix=function(e){var t=e[0];return!!this.iriResolver.prefixes.get(t)},e.prototype.digestProperty=function(e,t){return Pt.digestProperty(e,t,this._generalSchema)},e.prototype.getGeneralSchema=function(){return Pt.combineDigestedObjectSchemas([this._generalSchema])},e.prototype.serializeLiteral=function(e,t){if(!this.context.jsonldConverter.literalSerializers.has(e))throw new M('Type "'+e+"\" hasn't a defined serializer.");return this.context.jsonldConverter.literalSerializers.get(e).serialize(t)},e}(kn);function Vo(e){var t=e[0],r=e[1];return new Wr(t,new Ir(r))}var Ho=function(){function e(e,t){this._queryContainer=e,this._resource=o(t)?new _r(t):this._queryContainer.compactIRI(t)}return e.prototype.getToken=function(){return this._resource},e.prototype.toString=function(){return""+this._resource},e}(),Bo=function(){function e(e,t){this._value=t,this._queryContainer=e,y(t)?this.withType(be.dateTime):this._literal=new kr(t)}return e.prototype.withType=function(e){be.hasOwnProperty(e)&&(e=be[e]);var t=this._queryContainer.serializeLiteral(e,this._value),r=this._queryContainer.compactIRI(e);return this._literal=new Jr(t,r),this},e.prototype.withLanguage=function(e){var t=this._queryContainer.serializeLiteral(be.string,this._value),r=new Ar(e);return this._literal=new Jr(t,r),this},e.prototype.getToken=function(){return this._literal},e.prototype.toString=function(){return""+this._literal},e}(),zo=function(){function s(e,t){this.inherit=s.INHERIT,this.all=s.ALL,this._queryContainer=e,this._queryProperty=t}return s.prototype.property=function(e){for(var t=this._queryProperty;t;){var r=t.getProperty(e,{create:!0});if(r)return r.identifier;t=t.parent}throw new M('The property "'+e+'" was not declared.')},s.prototype.value=function(e){return new Bo(this._queryContainer,e)},s.prototype.object=function(e){var t=N.getID(e);return new Ho(this._queryContainer,t)},s.prototype.withType=function(e){if(this._queryProperty.hasProperties())throw new un("Types must be specified before the properties.");return this._queryProperty.addType(e),this},s.prototype.properties=function(e){if(e===s.ALL)return this._queryProperty.setType(Io.ALL),this;if(e===s.FULL)return this._queryProperty.setType(Io.FULL),this;for(var t in this._queryProperty.setType(Io.PARTIAL),e){var r=e[t],n=E(r)?r:{"@id":r},o=this._queryProperty.addProperty(t,n),i=n.query;if(i){var a=new Go(this._queryContainer,o);if(a!==i.call(void 0,a))throw new M("The provided query builder was not returned")}}return this},s.ALL=Object.freeze({}),s.FULL=Object.freeze({}),s.INHERIT=Object.freeze({}),s}(),Go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.filter=function(e){return this._queryProperty.addFilter(e),this},t.prototype.values=function(){for(var r=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.map(function(e){var t=e.getToken();if("blankNode"===t.token)throw new M('Cannot assign blank nodes ("'+t.label+'").');if(r._queryProperty.definition.literal&&"literal"!==t.token)throw new M('"'+t+'" is not a literal value.');if(null!==r._queryProperty.definition.pointerType&&"literal"===t.token)throw new M('"'+t+'" is not a resource value.');return t});return this._queryProperty.addValues(n),this._queryProperty.setObligatory({inheritParents:!0}),this},t}(zo),Wo=function(r){function e(e,t){return r.call(this,e,t)||this}return i(e,r),e.prototype.orderBy=function(e,t){return this._queryProperty.setOrder({path:e,flow:function(e){if(void 0===e)return;var t=e.toUpperCase();switch(t){case"ASC":case"DESC":return t;case"ASCENDING":case"DESCENDING":return t.slice(0,-6);default:throw new M("Invalid flow order.")}}(t)}),this},e.prototype.limit=function(e){return this._queryProperty.setLimit(e),this},e.prototype.offset=function(e){return this._queryProperty.setOffset(e),this},e}(Go);var Xo={TYPE:St.VolatileResource,is:function(e){return Ie.is(e)&&e.$hasType(Xo.TYPE)},create:function(e){var t=Object.assign({},e);return Xo.createFrom(t)},createFrom:function(e){var t=Ie.createFrom(e);return t.$addType(Xo.TYPE),t}},Qo={targets:{"@id":St.target,"@type":"@id","@container":"@set"}},Jo={TYPE:St.QueryMetadata,SCHEMA:Qo,is:function(e){return Xo.is(e)&&e.$hasType(Jo.TYPE)}},Ko=function(){function n(e){this.definition=e.definition,this.pathBuilderFn=e.pathBuilderFn,this.propertyType=e.propertyType,this.optional=e.optional,this.subProperties=new Map,this.values=e.values?e.values:[]}return n.prototype.setType=function(e){this.propertyType=ko(this.propertyType,e)},n.prototype.setProperty=function(e,t){this.subProperties.set(e,t)},n.prototype.getProperty=function(e,t){if(this.subProperties.has(e)){r=this.subProperties.get(e);return t&&r.mergeData(e,t),r}if(!t)throw new Error('Property "'+e+"\" doesn't exists.");var r=new n(t);return this.subProperties.set(e,r),r},n.prototype.mergeData=function(e,t){this!==t&&(this.setType(t.propertyType),this.__mergeDefinition(e,t.definition))},n.prototype.__mergeDefinition=function(e,t){for(var r in t){var n=this.definition[r],o=t[r];if(null===n&&(this.definition[r]=o),o!==n)throw new M('Property "'+e+'" has different "'+r+'": "'+n+'", "'+o+'".')}},n.prototype.getSchema=function(){var r=new xe;return this.subProperties.forEach(function(e,t){r.properties.set(t,e.definition)}),r},n}(),Zo=function(n){function e(e){var t=e.uri,r=e.propertyType;return n.call(this,{definition:new Oe,propertyType:r,optional:!1,values:[new Ir(t)]})||this}return i(e,n),e.prototype.__mergeDefinition=function(e,t){},e}(Ko),ei=function(){function e(e,t){this.registry=e,this.queryContainer=t}return Object.defineProperty(e.prototype,"jsonldConverter",{get:function(){return this.queryContainer.context.jsonldConverter},enumerable:!0,configurable:!0}),e.prototype.compactDocuments=function(e,t){var s=this;t||(t=e.map(function(e){return e["@id"]}));var a=new Map;return e.forEach(function(n){var o=s.registry.getPointer(n["@id"],!0);o.$_queryableMetadata||(o.$_queryableMetadata=new Zo({uri:o.$id,propertyType:Io.PARTIAL}));var i=new Set;o.$getPointers(!0).forEach(function(e){return i.add(e.$id)}),n["@graph"].forEach(function(e){var t=e["@id"],r=t!==n["@id"]?o.$getPointer(t,!0):o;a.set(t,{node:e,document:o,resource:r}),i.delete(t)}),i.forEach(function(e){return o.$removePointer(e)})}),t.forEach(function(e){var t=a.get(e);if(!t)throw new M("Invalid data provided.");var r=s.queryContainer._queryProperty,n=t.resource.$_queryableMetadata;s.__processNode(a,t,r,n)}),a.forEach(function(e){var t,r=e.node,n=e.resource,o=e.document;if(!e.isCompacted){var i=d({},r,((t={})[St.document]=void 0,t[St.checksum]=void 0,t)),a=s.queryContainer.context.registry.getSchemaFor(i);s.jsonldConverter.update(n,i,a,o),n.$_queryableMetadata=void 0}s.registry.decorate(n)}),e.map(Pe.getID).map(function(e){return a.get(e)}).filter(F).forEach(function(e){var t=e.resource,r=e.node;t.$_syncSnapshot();var n=r[St.checksum];if(n&&"string"!=typeof n){var o=Pe.getPropertyLiterals(n,be.string)[0];o&&(t.$eTag='"'+o+'"',t.$_resolved=!0)}}),t.map(function(e){return a.get(e).resource})},e.prototype.__processNode=function(i,e,t,a){var r,s=this,n=e.node,u=e.document,c=e.resource;e.isCompacted=!0;var o,l,p=t.getSchemaFor(n),h=(o=i,l=u,{hasPointer:function(e){return!!o.has(e)||l.$hasPointer(e)},getPointer:function(e){return o.has(e)?o.get(e).resource:l.$getPointer(e)}}),f=d({},n,((r={})[St.document]=void 0,r[St.checksum]=void 0,r));this.jsonldConverter.update(c,f,p,h,!t._isComplete()),t._isPartial()?t.subProperties.forEach(function(r,n){c.hasOwnProperty(n)&&r.pathBuilderFn&&Object.defineProperty(c,n,{enumerable:!1,configurable:!0,writable:!0});var o=a.getProperty(n,r);c.hasOwnProperty(n)&&(void 0!==r.propertyType&&(Array.isArray(c[n])?c[n]:[c[n]]).forEach(function(e){if(N.is(e)){var t=i.get(e.$id);if(!t)throw new M("Invalid data provided.");t.resource.$_queryableMetadata?(t.resource.$_queryableMetadata.mergeData(n,o),t.document!==u||t.isCompacted?o.propertyType=void 0:a.setProperty(n,t.resource.$_queryableMetadata)):t.document===u?t.resource.$_queryableMetadata=o:(t.resource.$_queryableMetadata=new Ko({propertyType:o.propertyType,optional:o.optional,definition:Object.assign(new Oe,o.definition,{uri:null})}),o.propertyType=void 0),s.__processNode(i,t,r,t.resource.$_queryableMetadata)}}))}):c.$_queryableMetadata=void 0},e}();var ti=function(){function e(){}return e.prototype.parse=function(t){return new Promise(function(e){return e(t)})},e}(),ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.parse=function(e){return t.prototype.parse.call(this,e).then(function(e){return e})},e}(Ae),ni=function(){function p(){}return p.executeRawASKQuery=function(e,t,r){return void 0===r&&(r={}),r=Object.assign(r,p.DEFAULT_OPTIONS),_t.setAcceptHeader("application/sparql-results+json",r),_t.setContentTypeHeader("application/sparql-query",r),wt.post(e,t,r,p.RESULTS_PARSER)},p.executeASKQuery=function(e,t,r){return void 0===r&&(r={}),p.executeRawASKQuery(e,t,r).then(function(e){var t=e[0],r=e[1];return[t.boolean,r]})},p.executeRawSELECTQuery=function(e,t,r){return void 0===r&&(r={}),r=Object.assign(r,p.DEFAULT_OPTIONS),_t.setAcceptHeader("application/sparql-results+json",r),_t.setContentTypeHeader("application/sparql-query",r),wt.post(e,t,r,p.RESULTS_PARSER)},p.executeSELECTQuery=function(e,t,l,r){return void 0===r&&(r={}),p.executeRawSELECTQuery(e,t,r).then(function(e){for(var t=e[0],r=e[1],n=[],o=0,i=t.results.bindings;o<i.length;o++){var a=i[o],s={};for(var u in a){var c=a[u];s[u]=p.__parseRawBindingProperty(c,l)}n.push(s)}return[{vars:t.head.vars,bindings:n},r]})},p.executeRawCONSTRUCTQuery=function(e,t,r){return void 0===r&&(r={}),r=Object.assign(r,p.DEFAULT_OPTIONS),_t.setAcceptHeader("application/ld+json",r),_t.setContentTypeHeader("application/sparql-query",r),wt.post(e,t,r,p.STRING_PARSER)},p.executeRawDESCRIBEQuery=function(e,t,r){return void 0===r&&(r={}),r=Object.assign(r,p.DEFAULT_OPTIONS),_t.setAcceptHeader("application/ld+json",r),_t.setContentTypeHeader("application/sparql-query",r),wt.post(e,t,r,p.STRING_PARSER)},p.executeUPDATE=function(e,t,r){return void 0===r&&(r={}),r=Object.assign(r,p.DEFAULT_OPTIONS),_t.setAcceptHeader("application/ld+json",r),_t.setContentTypeHeader("application/sparql-update",r),wt.post(e,t,r)},p.__parseRawBindingProperty=function(e,t){switch(e.type){case"uri":return X(t,e.value);case"bnode":throw new ke("BNodes cannot be queried directly");case"literal":return"datatype"in e?_e.parse(e.value,e.datatype):_e.parse(e.value);default:throw new M("The bindingProperty has an unsupported type")}},p.DEFAULT_OPTIONS={},p.RESULTS_PARSER=new ri,p.STRING_PARSER=new ti,p}(),oi={targetMembers:{"@id":St.targetMember,"@type":"@id","@container":"@set"}},ii={TYPE:St.AddMemberAction,SCHEMA:oi,is:function(e){return Ie.is(e)&&e.$hasType(ii.TYPE)},create:function(e){var t=Object.assign({},e);return ii.createFrom(t)},createFrom:function(e){var t=Ie.createFrom(e);return t.$addType(ii.TYPE),t}},ai={targetMembers:{"@id":St.targetMember,"@type":"@id","@container":"@set"}},si={TYPE:St.RemoveMemberAction,SCHEMA:ai,is:function(e){return Ie.is(e)&&e.$hasType(si.TYPE)},create:function(e){var t=Object.assign({},e);return si.createFrom(t)},createFrom:function(e){var t=Ie.createFrom(e);return t.$addType(si.TYPE),t}},ui={documentsMetadata:{"@id":St.documentMetadata,"@type":"@id","@container":"@set"}},ci={TYPE:St.ResponseMetadata,SCHEMA:ui,is:function(e){return Xo.is(e)&&e.$hasType(ci.TYPE)}},li=function(){function e(){this.token="ldpatch",this.prologues=[],this.statements=[]}return e.prototype.toString=function(){return this.prologues.concat(this.statements).join(" ")},e}(),pi=function(){function e(e,t){this.token="prefix",this.namespace=e,this.iri=t}return e.prototype.toString=function(){return"@prefix "+this.namespace+": "+this.iri+"."},e}(),hi=function(){function e(){this.token="add",this.triples=[]}return e.prototype.toString=function(){return"Add { "+this.triples.join(". ")+". }."},e}(),fi=function(){function e(){this.token="delete",this.triples=[]}return e.prototype.toString=function(){return"Delete { "+this.triples.join(". ")+". }."},e}(),di=function(){function e(e,t,r,n){this.token="updateList",this.subject=e,this.predicate=t,this.slice=r,this.collection=n}return e.prototype.toString=function(){return"UpdateList "+this.subject+" "+this.predicate+" "+this.slice+" "+this.collection+"."},e}(),gi=function(){function e(e,t){this.token="slice",f(e)&&(this.minIndex=e),f(t)&&(this.maxIndex=t)}return e.prototype.toString=function(){var e="..";return void 0!==this.minIndex&&(e=this.minIndex+e),void 0!==this.maxIndex&&(e+=this.maxIndex),e},e}(),yi=new Oe;yi.literal=!1,yi.pointerType=mt.ID,yi.containerType=z.SET;var vi=function(){function e(e){this.prefixesMap=new Map,this.context=e,this.addToken=new hi,this.deleteToken=new fi,this.updateLists=[]}return e.prototype.getPatch=function(){var e,t=new li;return this.prefixesMap.forEach(function(e){return t.prologues.push(e)}),(e=t.statements).push.apply(e,this.updateLists),this.addToken.triples.length&&t.statements.push(this.addToken),this.deleteToken.triples.length&&t.statements.push(this.deleteToken),""+t},e.prototype.addResource=function(e,d,g){var t,y=this,v=this.__getSchema(e,d,g),m=o(e)?new _r(e):this.__compactIRI(v,e),b=[],w=new tn(m),_=new tn(m);new Set(["types"].concat(Object.keys(d),Object.keys(g))).forEach(function(e){if("$id"!==e){var t,r,n,o,i="types"===e?"a":y._getPropertyIRI(v,e),a="a"===i?yi:v.getProperty(e),s=d[e],u=g[e];if(a&&a.containerType===z.LIST&&F(s)){var c=[];if(F(u)?(a.containerType=z.SET,c.push.apply(c,function(e,t){var r=function(e,t){return{identifier:""+e,object:e,index:t}},n=e.map(r),o=t.map(r),i=new Set(o),a=[],s=0,u=o;n.forEach(function(t){var e=u.findIndex(function(e){return e.identifier===t.identifier});-1===e?(t.index-=s++,a.push(t)):(i.delete(u[e]),u=u.slice(e+1))});var c,l=[];return a.forEach(function(e){c&&c.slice[0]===e.index?c.slice=[c.slice[0],c.slice[1]+1]:l.push(c={slice:[e.index,e.index+1],objects:[]})}),c=void 0,i.forEach(function(e){if(c&&c.slice[1]===e.index)return c.slice=[c.slice[0],e.index+1],void c.objects.push(e.object);l.push(c={slice:[e.index,e.index+1],objects:[e.object]})}),l}(y.__getObjects(s,v,a),y.__getObjects(u,v,a)))):(_.addProperty(new Xr(i).addObject(new Pr)),c.push({slice:[0,void 0],objects:[]})),!c.length)return;y.__addPrefixFrom(i,v),c.forEach(function(e){var t=new Pr;e.objects.forEach(function(e){t.addObject(e),y.__addPrefixFrom(e,v)}),b.push(new di(m,i,e.objects.length?new gi(e.slice[0],e.slice[0]):new(gi.bind.apply(gi,[void 0].concat(e.slice))),t))})}else{var l=y.__getObjects(s,v,a),p=y.__getObjects(u,v,a),h=(t=l,r=function(e){return[""+e,e]},n=new Map(p.map(r)),o=new Map(t.map(r)),n.forEach(function(e,t){o.has(t)&&(o.delete(t),n.delete(t))}),{toAdd:Array.from(n.values()),toDelete:Array.from(o.values())}),f=function(e,t){if(e.length){var r=new Xr(i);e.forEach(function(e){r.addObject(e),y.__addPrefixFrom(e,v)}),t.addProperty(r)}};f(h.toAdd,w),f(h.toDelete,_)}}}),(t=this.updateLists).push.apply(t,b),b.forEach(function(e){return y.__addPrefixFrom(e.predicate,v)}),w.properties.length&&this.addToken.triples.push(w),w.properties.forEach(function(e){return y.__addPrefixFrom(e.verb,v)}),_.properties.length&&this.deleteToken.triples.push(_),_.properties.forEach(function(e){return y.__addPrefixFrom(e.verb,v)}),this.__addPrefixFrom(m,v)},e.prototype.__getSchema=function(e,t,r){var n=new Set;"types"in t&&t.types.forEach(n.add,n),"types"in r&&r.types.forEach(n.add,n);var o={$id:e,types:Array.from(n)},i=this.context.registry.getSchemaFor(o),a=t.$_queryableMetadata||t.$_queryableMetadata;return a?Pt._combineSchemas([i,a.getSchema()]):i},e.prototype._getPropertyIRI=function(e,t){var r=e.properties.get(t),n=r&&r.uri?r.uri:t;return this.__compactIRI(e,n)},e.prototype.__getObjects=function(e,t,r){var n,o=(Array.isArray(e)?r&&null===r.containerType?e.slice(0,1):e:[e]).filter(F);if(r&&r.containerType===z.LIST){if(!F(e))return[];var i=new Pr;return(n=i.objects).push.apply(n,this.__expandValues(o,t,r)),[i]}return r&&r.containerType===z.LANGUAGE?this.__expandLanguageMap(o,t):this.__expandValues(o,t,r)},e.prototype.__expandValues=function(e,t,r){var n=this,o=r&&null!==r.literal?r.literal:null;return e.map(function(e){return(null!==o?o:!N.is(e))?n.__expandLiteral(e,t,r):n.__expandPointer(e,t)}).filter(F)},e.prototype.__expandLanguageMap=function(e,n){var o=this;if(!e.length)return[];var i=e[0];return Object.keys(i).map(function(e){var t=i[e],r=new Oe;return r.language=e,r.literalType=be.string,o.__expandLiteral(t,n,r)}).filter(F)},e.prototype.__expandPointer=function(e,t){var r=N.is(e)?e.$id:e;return T(r)?o(r)?new _r(r):this.__compactIRI(t,r):null},e.prototype.__expandLiteral=function(e,t,r){var n=r&&r.literalType?r.literalType:Ee(e);return null!==n&&this.context.jsonldConverter.literalSerializers.has(n)?(e=this.context.jsonldConverter.literalSerializers.get(n).serialize(e),n!==be.string?new Jr(e,this.__compactIRI(t,n)):r&&"string"==typeof r.language?new Jr(e,new Ar(r.language)):new kr(e)):null},e.prototype.__compactIRI=function(e,r){r=e.resolveURI(r,{vocab:!0});var t=Array.from(e.prefixes.entries()).find(function(e){var t=e[1];return r.startsWith(t)});return t?new Gr(t[0],r.substr(t[1].length)):new Ir(r)},e.prototype.__addPrefixFrom=function(e,t){var r=this;if("a"!==e){if("objects"in e)return e.objects.forEach(function(e){r.__addPrefixFrom(e,t)});if("type"in e)return this.__addPrefixFrom(e.type,t);if("prefixedName"===e.token){var n=e.namespace;if(!this.prefixesMap.has(n)){var o=t.prefixes.get(n);this.prefixesMap.set(n,new pi(n,new Ir(o)))}}}},e}();var mi={PROTOTYPE:{get:function(e,t){var r=this;if(!this.context.registry.inScope(e,!0))return Promise.reject(new M('"'+e+'" is out of scope.'));var n=this.context.getObjectSchema().resolveURI(e,{base:!0});if(this.context.registry.hasPointer(n,!0)){var o=this.context.registry.getPointer(n,!0);if(o.$isResolved()&&(!t||!t.ensureLatest))return Promise.resolve(o)}return wt.get(n,t).then(function(e){return r._parseResponseData(e,n)})},resolve:function(e,t){return this.get(e.$id,t)},exists:function(e,t){if(!this.context.registry.inScope(e,!0))return Promise.reject(new M('"'+e+'" is out of scope.'));var r=this.context.getObjectSchema().resolveURI(e,{base:!0});return wt.head(r,t).then(function(){return!0}).catch(function(e){return!("response"in e&&404===e.response.status)&&Promise.reject(e)})},refresh:function(t,e){var r=this;if(!At.is(t))return Promise.reject(new M("The resource isn't a resolvable pointer."));if(!this.context.registry.inScope(t.$id,!0))return Promise.reject(new M('"'+t.$id+'" is out of scope.'));var n=this.context.getObjectSchema().resolveURI(t.$id,{base:!0});return wt.get(n,e).then(function(e){return r._parseResponseData(e,n)}).catch(function(e){return"response"in e&&304===e.response.status?t:Promise.reject(e)})},save:function(e,t){if(!At.is(e))return Promise.reject(new M("The resource isn't a resolvable pointer."));if(!this.context.registry.inScope(e.$id,!0))return Promise.reject(new M('"'+e.$id+'" is out of scope.'));var r=this.context.getObjectSchema().resolveURI(e.$id,{base:!0});if(!e.$isDirty())return Promise.resolve(e);var n=JSON.stringify(e);return wt.put(r,n,t).then(function(){return e})},saveAndRefresh:function(e,t){var r=this;return this.save(e,t).then(function(){return r.refresh(e,t)})},delete:function(e,t){var r=this;if(!this.context.registry.inScope(e,!0))return Promise.reject(new M('"'+e+'" is out of scope.'));var n=this.context.getObjectSchema().resolveURI(e,{base:!0});return wt.delete(n,t).then(function(){r.context.registry.removePointer(n)})},_parseResponseData:function(r,n){return i=this,u=function(){var t;return e(this,function(e){return(t=this.context.registry.getPointer(n,!0)).$eTag=r.getETag(),t.$_resolved=!0,[2,t]})},new((s=a=void 0)||(s=Promise))(function(e,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function n(e){try{o(u.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,n)}o((u=u.apply(i,a||[])).next())});var i,a,s,u}},isDecorated:function(e){return D.hasPropertiesFrom(mi.PROTOTYPE,e)},decorate:function(e){if(mi.isDecorated(e))return e;var t=D.decorateMultiple(e,ur);return D.definePropertiesFrom(mi.PROTOTYPE,t)}},bi=new Et;function wi(e,t){t&&_t.setPreferredInteractionModel(t,e),_t.setAcceptHeader("application/ld+json",e)}function _i(e){return Ft(e.context.registry)}function Pi(n,o,i){return 204!==i.status&&i.data?bi.parse(i.data).then(function(e){var t=xt.getFreeNodes(e);!function(e,t){if(t.length){var r=De.parseFreeNodes(e.context.registry,t).getPointers(!0).find(ci.is);r&&r.documentsMetadata.forEach(function(e){return o=e.relatedDocument,void e.bNodesMap.entries.forEach(function(e){var t=e.entryKey,r=e.entryValue,n=o.$getPointer(t.$id,!0);o.$removePointer(t.$id),n.$id=r.$id,o.$_addPointer(n)});var o})}}(n,t);var r=i.getHeader("Preference-Applied");return null!==r&&r.hasValue("return=representation")?n._parseResponseData(i,o.$id):o}):o}function Ti(e){return At.is(e)}function Ei(e){return e.__CarbonLDP_persisting__}function Si(n,e,t,r,o){if(At.is(r))throw new M("Cannot persist an already resolvable pointer.");var i=Yt.is(r)?r:Yt.decorate(r);i.$_normalize(),i.$registry=n.context.registry;var a=JSON.stringify(i);return o&&_t.setSlug(o,t),Object.defineProperty(i,"__CarbonLDP_persisting__",{configurable:!0,value:!0}),wt.post(e,a,t).then(function(e){delete i.__CarbonLDP_persisting__;var t=e.getHeader("Location");if(null===t||t.values.length<1)throw new Ze("The response is missing a Location header.",e);if(1!==t.values.length)throw new Ze("The response contains more than one Location header.",e);i.$id=t.values[0].toString();var r=n.context.registry._addPointer(i);return r.$getFragments().forEach(r.$__modelDecorator.decorate),Pi(n,r,e)}).catch(function(e){return delete i.__CarbonLDP_persisting__,_i(n)(e)})}function Oi(e,o,t,r,n,i){if(!o.context.registry.inScope(t,!0))return Promise.reject(new M('"'+t+'" is out of scope.'));var a=o.context.getObjectSchema().resolveURI(t,{base:!0});i=_t.isOptions(n)?n:i||{};var s=T(n)||Array.isArray(n)?n:null;if(wi(i,Nt.Container),_t.setPreferredRetrieval(e,i),_t.setContentTypeHeader("application/ld+json",i),!Array.isArray(r))return Ti(r)?Promise.reject(new M("The object is already a resolvable pointer.")):Ei(r)?Promise.reject(new M("The object is already being persisted.")):Si(o,a,i,r,s?s.toString():void 0);var u=r.findIndex(function(e){return Ti(e)});if(-1!==u)return Promise.reject(new M('The object in "'+u+'" is already a resolvable pointer.'));var c=r.findIndex(function(e){return Ei(e)});if(-1!==c)return Promise.reject(new M('The object in "'+c+'" is already being persisted.'));var l=r.map(function(e,t){var r=_t.cloneOptions(i),n=s&&t<s.length?s[t]:void 0;return Si(o,a,r,e,n)});return Promise.all(l)}function Ci(t,r,e){if(!At.is(r))return Promise.reject(new M("The document isn't a resolvable pointer."));if(!t.context.registry.inScope(r.$id))return Promise.reject(new M('"'+r.$id+'" is out of scope.'));var n=t.context.getObjectSchema().resolveURI(r.$id,{base:!0});if(!r.$isDirty())return Promise.resolve(r);r.$_normalize(),wi(e),_t.setContentTypeHeader("text/ldpatch",e),_t.setIfMatchHeader(r.$eTag,e);var o=new vi(t.context);o.addResource(r.$id,r.$_snapshot,r),r.$getPointers(!0).forEach(function(e){o.addResource(e.$id,e.$_snapshot,e)}),r.$__savedFragments.filter(function(e){return!r.$hasPointer(e.$id)}).forEach(function(e){o.addResource(e.$id,e.$_snapshot,{})});var i=o.getPatch();return wt.patch(n,i,e).then(function(e){return Pi(t,r,e)}).catch(_i(t))}function xi(t,e){return e.map(function(e){return T(e)?t.getPointer(e):N.is(e)?e:void 0}).filter(function(e){return!!e})}function Ri(e,t,r,n){if(void 0===n&&(n={}),!e.context.registry.inScope(t,!0))return Promise.reject(new M('"'+t+'" is out of scope.'));var o=e.context.getObjectSchema().resolveURI(t,{base:!0});wi(n,Nt.Container),_t.setContentTypeHeader("application/ld+json",n);var i=De.createFrom({registry:e.context.registry}),a=xi(e.context.registry,r);i._addPointer(ii.createFrom({targetMembers:a}));var s=JSON.stringify(i);return wt.put(o,s,n).then(function(){}).catch(_i(e))}function ji(e,t,r,n){if(void 0===n&&(n={}),!e.context.registry.inScope(t,!0))return Promise.reject(new M('"'+t+'" is out of scope.'));var o=e.context.getObjectSchema().resolveURI(t,{base:!0});wi(n,Nt.Container),_t.setContentTypeHeader("application/ld+json",n),_t.setRetrievalPreferences({include:[St.PreferSelectedMembershipTriples],omit:[St.PreferMembershipTriples]},n);var i=De.createFrom({registry:e.context.registry}),a=xi(e.context.registry,r);i._addPointer(si.createFrom({targetMembers:a}));var s=JSON.stringify(i);return wt.delete(o,s,n).then(function(){}).catch(_i(e))}var Fi={PROTOTYPE:{get:function(e,t){return void 0===t&&(t={}),wi(t,Nt.RDFSource),mi.PROTOTYPE.get.call(this,e,t).catch(_i(this))},exists:function(e,t){return void 0===t&&(t={}),wi(t,Nt.RDFSource),mi.PROTOTYPE.exists.call(this,e,t).catch(_i(this))},create:function(e,t,r,n){return Oi("minimal",this,e,t,r,n)},createAndRetrieve:function(e,t,r,n){return Oi("representation",this,e,t,r,n)},refresh:function(e,t){return void 0===t&&(t={}),wi(t,Nt.RDFSource),_t.setIfNoneMatchHeader(e.$eTag,t),mi.PROTOTYPE.refresh.call(this,e,t).catch(_i(this))},save:function(e,t){return void 0===t&&(t={}),_t.setPreferredRetrieval("minimal",t),Ci(this,e,t)},saveAndRefresh:function(e,t){return void 0===t&&(t={}),_t.setPreferredRetrieval("representation",t),Ci(this,e,t)},delete:function(e,t){return void 0===t&&(t={}),wi(t,Nt.RDFSource),mi.PROTOTYPE.delete.call(this,e,t).catch(_i(this))},addMember:function(e,t,r){return Ri(this,e,[t],r)},addMembers:function(e,t,r){return Ri(this,e,t,r)},removeMember:function(e,t,r){return ji(this,e,[t],r)},removeMembers:function(e,t,r){return Array.isArray(t)?ji(this,e,t,r):function(e,t,r){if(void 0===r&&(r={}),!e.context.registry.inScope(t,!0))return Promise.reject(new M('"'+t+'" is out of scope.'));var n=e.context.getObjectSchema().resolveURI(t,{base:!0});return wi(r,Nt.Container),_t.setRetrievalPreferences({include:[St.PreferMembershipTriples],omit:[St.PreferMembershipResources,St.PreferContainmentTriples,St.PreferContainmentResources,St.PreferContainer]},r),wt.delete(n,r).then(function(){}).catch(_i(e))}(this,e,t||r)},_parseResponseData:function(a,s){var u=this;return bi.parse(a.data).then(function(e){var t=xt.getDocuments(e);s=function(e,t){var r=t.getHeader("Content-Location");if(!r)return e;if(1!==r.values.length)throw new Ze("The response must contain one Content-Location header.",t);var n=""+r;if(!n)throw new Ze("The response doesn't contain a valid 'Content-Location' header.",t);return n}(s,a);var r=t.find(function(e){return e["@id"]===s});if(!r)throw new Ze('No document "'+s+'" was returned.',a);var n=u.context.registry.register(s),o=new Set;n.$getPointers(!0).forEach(function(e){return o.add(e.$id)});var i=r["@graph"].map(function(e){var t=n.$getPointer(e["@id"]),r=u.context.registry.getSchemaFor(e);return u.context.jsonldConverter.update(t,e,r,n),"$document"in t&&o.delete(t.$id),t});return o.forEach(function(e){return n.$removePointer(e)}),i.forEach(function(e){e.$_syncSnapshot(),u.context.registry.decorate(e)}),n.$eTag=a.getETag(),n.$_resolved=!0,n})}},isDecorated:function(e){return D.hasPropertiesFrom(Fi.PROTOTYPE,e)},decorate:function(e){if(Fi.isDecorated(e))return e;var t=D.decorateMultiple(e,mi);return D.definePropertiesFrom(Fi.PROTOTYPE,t)}};function Ii(e,t){var r="containerPropertyType"in e._queryProperty?new Wo(e,e._queryProperty):new zo(e,e._queryProperty);if(void 0!==t.rootType&&e._queryProperty.setType(t.rootType),t.queryBuilderFn&&t.queryBuilderFn.call(void 0,r)!==r)throw new M("The provided query builder was not returned")}function Di(e,t){if(!("order"in e._queryProperty&&e._queryProperty.order))return t;var r=e._queryProperty.order,u=r.path,c="DESC"===r.flow?-1:1;return t.sort(function(e,t){e=Mo(e,u),t=Mo(t,u);var r,n,o=N.is(e)?e.$id:e,i=N.is(t)?t.$id:t;if(o===i)return 0;if(void 0===o)return-1*c;if(void 0===i)return c;if(typeof(r=e)!=typeof(n=t)||"object"==typeof r&&r instanceof Date!=n instanceof Date){if(N.is(e))return-1*c;if(N.is(t))return c;if(f(e))return-1*c;if(f(t))return c;if(y(e))return-1*c;if(y(t))return c;if(h(e))return-1*c;if(h(t))return c;if(T(e))return-1*c;if(T(t))return c}else if(N.is(e)){var a=k.isBNodeID(o),s=k.isBNodeID(i);if(a&&!s)return-1*c;if(s&&!a)return c}return o<i?-1*c:i<o?c:0})}function Ai(o,e,t,i){var r,n,a,s=(r=(n=(new Or).addTriple(new tn(new Ir("cldp-sdk://metadata-"+j.generate())).addProperty(new Xr("a").addObject(i.compactIRI(St.VolatileResource)).addObject(i.compactIRI(St.QueryMetadata))).addProperty(new Xr(i.compactIRI(St.target)).addObject(i._queryProperty.identifier)))).addTriple.apply(n,i._queryProperty.getConstructPatterns())).addPattern.apply(r,i._queryProperty.getSearchPatterns()),u=(a=new Qr(s)).addPrologues.apply(a,i.getPrologues());return _t.setRetrievalPreferences({include:[St.PreferResultsContexts]},t),ni.executeRawCONSTRUCTQuery(e,u.toString(),t).then(function(e){return e[0]}).then(function(e){return(new Et).parse(e)}).then(function(e){var t=xt.getFreeNodes(e),r=De.parseFreeNodes(o.context.registry,t).getPointers(!0).filter(Jo.is).map(function(e){return e.targets}).reduce(function(e,t){return e.concat(t)},[]).map(function(e){return e.$id}),n=e.filter(xt.is);return new ei(o.context.registry,i).compactDocuments(n,r)}).then(function(e){return Di(i,e)}).catch(Ft(o.context.registry))}function Mi(e,t,r,n){if(!e.context.registry.inScope(t,!0))return Promise.reject(new M('"'+t+'" is out of scope.'));var o=e.context.getObjectSchema().resolveURI(t,{base:!0}),i=new Yo(e.context,{containerPropertyType:n.containerPropertyType,uri:o});return Ii(i,n),Ai(e,o,r,i)}function ki(t,e,r,n){for(var o=0,i=e;o<i.length;o++){var a=i[o];if(!t.context.registry.inScope(a,!0))return Promise.reject(new M('"'+a+'" is out of scope.'))}var s=e.map(function(e){return t.context.getObjectSchema().resolveURI(e,{base:!0})}),u=new Yo(t.context,{uris:s});Ii(u,n);var c=1===s.length?s[0]:t.context.baseURI;return _t.setRetrievalPreferences({include:[St.PreferDocumentChecksums]},r),Ai(t,c,r,u)}function Li(e,t,r){if(void 0===r&&(r={}),!e.context.registry.inScope(t.$id,!0))return Promise.reject(new M('"'+t.$id+'" is out of scope.'));var n=e.context.getObjectSchema().resolveURI(t.$id,{base:!0}),o=new Yo(e.context,{uris:[n]});return function r(n,e){e.subProperties.forEach(function(e,t){r(n._addSubProperty(t,e),e)})}(o._queryProperty,t.$_queryableMetadata),_t.setRetrievalPreferences({include:[St.PreferDocumentChecksums]},r),Ai(e,n,r,o).then(function(e){return e[0]})}var Ni={PROTOTYPE:{get:function(e,t,r){var n="object"==typeof t?t:{};if(r=m(t)?t:r,"string"!=typeof e)return ki(this,e,n,{rootType:r?void 0:Io.FULL,queryBuilderFn:r});var o=e,i=this.context.registry.hasPointer(o)?this.context.registry.getPointer(o,!0):void 0;if(r){var a=i?i.types:[];return ki(this,[o],n,{queryBuilderFn:function(t){return a.forEach(function(e){return t.withType(e)}),r.call(void 0,t)}}).then(function(e){return e[0]})}return i&&i.$isQueried()&&(n.ensureLatest=!0),Fi.PROTOTYPE.get.call(this,o,n).then(function(e){if(!e.$_queryableMetadata)return e;var t=e.$getFragments();return t.push(e),t.forEach(function(e){e.$_queryableMetadata=void 0}),e})},resolve:function(e,t,r){return this.get(e.$id,t,r)},refresh:function(e,t){return e.$isQueried()?Li(this,e,t):Fi.PROTOTYPE.refresh.call(this,e,t)},saveAndRefresh:function(e,t){var r=this;if(!e.$_queryableMetadata)return Fi.PROTOTYPE.saveAndRefresh.call(this,e,t);if(null===e.$eTag)return Promise.reject(new un('The document "'+e.$id+'" is locally outdated and cannot be saved.'));var n=_t.cloneOptions(t||{});return this.save(e,n).then(function(e){return Li(r,e,t)})},getChildren:function(e,t,r){var n="object"==typeof t?t:{};return r=m(t)?t:r,_t.setRetrievalPreferences({include:[St.PreferDocumentChecksums]},n),Mi(this,e,n,{rootType:r?void 0:Io.FULL,containerPropertyType:Ro.CHILD,queryBuilderFn:r})},getMembers:function(e,t,r){var n="object"==typeof t?t:{};return r=m(t)?t:r,_t.setRetrievalPreferences({include:[St.PreferDocumentChecksums]},n),Mi(this,e,n,{rootType:r?void 0:Io.FULL,containerPropertyType:Ro.MEMBER,queryBuilderFn:r})},listChildren:function(e,t){return void 0===t&&(t={}),Mi(this,e,t,{containerPropertyType:Ro.CHILD,rootType:Io.EMPTY})},listMembers:function(e,t){return void 0===t&&(t={}),Mi(this,e,t,{rootType:Io.EMPTY,containerPropertyType:Ro.MEMBER})}},isDecorated:function(e){return D.hasPropertiesFrom(Ni.PROTOTYPE,e)},decorate:function(e){if(Ni.isDecorated(e))return e;var t=D.decorateMultiple(e,Fi);return D.definePropertiesFrom(Ni.PROTOTYPE,t)}},$i=function(t){function e(){var e=t.call(this)||this;return e.token="ask",e.datasets=[],e}return i(e,t),e.prototype.toString=function(e){var t="ASK",r=gr(e);return this.datasets.length&&(t+=r+this.datasets.join(r)),t+=r+this.where.toString(e),this.modifiers.length&&(t+=r+this.modifiers.join(r)),t},e}(Sr);function Ui(l,p){return function(e){var t,r,n,o=new pn(p.iriResolver),i=(r=o,n=e(wo.create(r)),(Array.isArray(n)?n:[n]).map(function(e){return e.getPattern()})),a=(t=yn(p.targetToken.queryClause,{where:new Er})).addPattern.apply(t,i),s=yn(p.targetToken,{queryClause:a}),u=yn(p,{iriResolver:o,targetToken:s}),c=Oo(l,u,{});return l(u,c)}}var qi=function(e,t,r){return Object.assign(r,{where:Ui(e,t)})};function Yi(a,s,u){return function(e){var t=new pn(s.iriResolver),r=s.targetToken.queryClause.datasets.concat(new xr(t.resolve(e),u)),n=yn(s.targetToken.queryClause,{datasets:r}),o=yn(s.targetToken,{queryClause:n}),i=yn(s,{iriResolver:t,targetToken:o});return Vi.createFrom(a,i,{})}}var Vi={createFrom:function(e,t,r){return qi(e,t,Object.assign(r,{from:Yi(e,t),fromNamed:Yi(e,t,!0)}))}};var Hi={createFrom:function(e,t,r){return Object.assign(r,{ask:(n=e,o=t,function(){var e=new $i,t=yn(o.targetToken,{queryClause:e}),r=new cn({iriResolver:o.iriResolver,targetToken:t});return Vi.createFrom(n,r,{})})});var n,o}};function Bi(i,a,s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new Zr(s);e.length&&r.addVariable.apply(r,e.map(function(e){return new sn(e)}));var n=yn(a.targetToken,{queryClause:r}),o=new cn({iriResolver:a.iriResolver,targetToken:n});return Vi.createFrom(i,o,{})}}var zi={createFrom:function(e,t,r){return Object.assign(r,{select:Bi(e,t),selectDistinct:Bi(e,t,"DISTINCT"),selectReduced:Bi(e,t,"REDUCED"),selectAll:function(){return Bi(e,t)()},selectAllDistinct:function(){return Bi(e,t,"DISTINCT")()},selectAllReduced:function(){return Bi(e,t,"REDUCED")()}})}};var Gi={createFrom:function(e,t){var r=zi.createFrom.bind(null,e.selectFinishClauseFactory),n=Hi.createFrom.bind(null,e.askFinishClauseFactory);return ln.createFrom(r,n)(e,Object.assign(t,{base:function(e){var t=new fr(new Ir(e)),r=this.targetToken.prologues.concat(t),n=yn(this,{targetToken:yn(this.targetToken,{prologues:r})});return Gi.createFrom(n,{})}.bind(e),vocab:function(e){var t=yn(this,{iriResolver:new pn(this.iriResolver,e)});return Gi.createFrom(t,{})}.bind(e),prefix:function(t,e){var r=new pn(this.iriResolver),n=this.targetToken.prologues.slice();if(r.prefixes.has(t)){var o=n.findIndex(function(e){return"prefix"===e.token&&e.namespace===t});-1!==o&&n.splice(o,1)}n.push(new Wr(t,new Ir(e))),r.prefixes.set(t,!1);var i=yn(this,{iriResolver:r,targetToken:yn(this.targetToken,{prologues:n})});return Gi.createFrom(i,{})}.bind(e)}))}};var Wi=function(u){function e(e,t){var n,o,i,a,r=(n=e,o=t,function(e,t){var r=fn.createFrom(e,t);return Object.assign(r,{execute:function(){return n.executeSELECTQuery(o,r.toCompactString())}})}),s=(i=e,a=t,function(e,t){var r=fn.createFrom(e,t);return Object.assign(r,{execute:function(){return i.executeASKQuery(a,r.toCompactString())}})});return u.call(this,r,s)||this}return i(e,u),e}(function(e,t){void 0===e&&(e=fn.createFrom),void 0===t&&(t=fn.createFrom);var r=new hn({iriResolver:new pn,targetToken:new Qr(void 0),selectFinishClauseFactory:e,askFinishClauseFactory:t});return Gi.createFrom(r,this)}),Xi={PROTOTYPE:{executeASKQuery:function(e,t,r){if(!this.context.registry.inScope(e,!0))return Promise.reject(new M('"'+e+'" is out of scope.'));var n=this.context.getObjectSchema().resolveURI(e,{base:!0});return r=r||{},_t.setAcceptHeader("application/ld+json; q=0.9",r),ni.executeASKQuery(n,t,r).then(function(e){return e[0]}).catch(Ft(this.context.registry))},executeSELECTQuery:function(e,t,r){if(!this.context.registry.inScope(e,!0))return Promise.reject(new M('"'+e+'" is out of scope.'));var n=this.context.getObjectSchema().resolveURI(e,{base:!0});return r=r||{},_t.setAcceptHeader("application/ld+json; q=0.9",r),ni.executeSELECTQuery(n,t,this.context.registry,r).then(function(e){return e[0]}).catch(Ft(this.context.registry))},executeUPDATE:function(e,t,r){if(!this.context.registry.inScope(e,!0))return Promise.reject(new M('"'+e+'" is out of scope.'));var n=this.context.getObjectSchema().resolveURI(e,{base:!0});return ni.executeUPDATE(n,t,r).then(function(){}).catch(Ft(this.context.registry))},sparql:function(e){if(!this.context.registry.inScope(e,!0))throw new M('"'+e+'" is out of scope.');var t=this.context.getObjectSchema().resolveURI(e,{base:!0}),r=this.context.registry.getGeneralSchema(),n=new Wi(this,t).base(r.base).vocab(r.vocab);return r.prefixes.forEach(function(e,t){n=n.prefix(t,e)}),n}},isDecorated:function(e){return D.hasPropertiesFrom(Xi.PROTOTYPE,e)},decorate:function(e){if(Xi.isDecorated(e))return e;var t=D.decorateMultiple(e,ur);return D.definePropertiesFrom(Xi.PROTOTYPE,t)}},Qi={create:function(e){return Qi.createFrom(d({},e))},createFrom:function(e){return D.decorateMultiple(e,Ni,Xi,hr)},is:function(e){return E(e)&&Ni.isDecorated(e)&&Xi.isDecorated(e)&&hr.isDecorated(e)}},Ji="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Ki(e,t){return e(t={exports:{}},t.exports),t.exports}var Zi=Ki(function(e){Ji.crypto&&Ji.crypto.getRandomValues?e.exports.randomBytes=function(e){var t=new Uint8Array(e);return Ji.crypto.getRandomValues(t),t}:e.exports.randomBytes=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=Math.floor(256*Math.random());return t}}),ea=(Zi.randomBytes,"abcdefghijklmnopqrstuvwxyz012345"),ta={string:function(e){for(var t=ea.length,r=Zi.randomBytes(e),n=[],o=0;o<e;o++)n.push(ea.substr(r[o]%t,1));return n.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length;return(new Array(t+1).join("0")+this.number(e)).slice(-t)}},ra=Ki(function(e){var r={},n=!1,o=Ji.chrome&&Ji.chrome.app&&Ji.chrome.app.runtime;e.exports={attachEvent:function(e,t){void 0!==Ji.addEventListener?Ji.addEventListener(e,t,!1):Ji.document&&Ji.attachEvent&&(Ji.document.attachEvent("on"+e,t),Ji.attachEvent("on"+e,t))},detachEvent:function(e,t){void 0!==Ji.addEventListener?Ji.removeEventListener(e,t,!1):Ji.document&&Ji.detachEvent&&(Ji.document.detachEvent("on"+e,t),Ji.detachEvent("on"+e,t))},unloadAdd:function(e){if(o)return null;var t=ta.string(8);return r[t]=e,n&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in r&&delete r[e]},triggerUnloadCallbacks:function(){for(var e in r)r[e](),delete r[e]}};o||e.exports.attachEvent("unload",function(){n||(n=!0,e.exports.triggerUnloadCallbacks())})}),na=(ra.attachEvent,ra.detachEvent,ra.unloadAdd,ra.unloadDel,ra.triggerUnloadCallbacks,function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}),oa=Object.prototype.hasOwnProperty;function ia(e){return decodeURIComponent(e.replace(/\+/g," "))}var aa={stringify:function(e,t){t=t||"";var r,n,o=[];for(n in"string"!=typeof t&&(t="?"),e)oa.call(e,n)&&((r=e[n])||null!=r&&!isNaN(r)||(r=""),o.push(encodeURIComponent(n)+"="+encodeURIComponent(r)));return o.length?t+o.join("&"):""},parse:function(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);){var o=ia(t[1]),i=ia(t[2]);o in n||(n[o]=i)}return n}},sa=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,ua=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,ca=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],la={hash:1,query:1};function pa(e){var t,r=("undefined"!=typeof window?window:void 0!==Ji?Ji:"undefined"!=typeof self?self:{}).location||{},n={},o=typeof(e=e||r);if("blob:"===e.protocol)n=new fa(unescape(e.pathname),{});else if("string"===o)for(t in n=new fa(e,{}),la)delete n[t];else if("object"===o){for(t in e)t in la||(n[t]=e[t]);void 0===n.slashes&&(n.slashes=ua.test(e.href))}return n}function ha(e){var t=sa.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function fa(e,t,r){if(!(this instanceof fa))return new fa(e,t,r);var n,o,i,a,s,u,c=ca.slice(),l=typeof t,p=this,h=0;for("object"!==l&&"string"!==l&&(r=t,t=null),r&&"function"!=typeof r&&(r=aa.parse),t=pa(t),n=!(o=ha(e||"")).protocol&&!o.slashes,p.slashes=o.slashes||n&&t.slashes,p.protocol=o.protocol||t.protocol||"",e=o.rest,o.slashes||(c[3]=[/(.*)/,"pathname"]);h<c.length;h++)"function"!=typeof(a=c[h])?(i=a[0],u=a[1],i!=i?p[u]=e:"string"==typeof i?~(s=e.indexOf(i))&&(e="number"==typeof a[2]?(p[u]=e.slice(0,s),e.slice(s+a[2])):(p[u]=e.slice(s),e.slice(0,s))):(s=i.exec(e))&&(p[u]=s[1],e=e.slice(0,s.index)),p[u]=p[u]||n&&a[3]&&t[u]||"",a[4]&&(p[u]=p[u].toLowerCase())):e=a(e);r&&(p.query=r(p.query)),n&&t.slashes&&"/"!==p.pathname.charAt(0)&&(""!==p.pathname||""!==t.pathname)&&(p.pathname=function(e,t){for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],i=!1,a=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),a++):a&&(0===n&&(i=!0),r.splice(n,1),a--);return i&&r.unshift(""),"."!==o&&".."!==o||r.push(""),r.join("/")}(p.pathname,t.pathname)),na(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(a=p.auth.split(":"),p.username=a[0]||"",p.password=a[1]||""),p.origin=p.protocol&&p.host&&"file:"!==p.protocol?p.protocol+"//"+p.host:"null",p.href=p.toString()}fa.prototype={set:function(e,t,r){var n=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||aa.parse)(t)),n[e]=t;break;case"port":n[e]=t,na(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,/:\d+$/.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";n[e]=t.charAt(0)!==o?o+t:t}else n[e]=t;break;default:n[e]=t}for(var i=0;i<ca.length;i++){var a=ca[i];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(e){e&&"function"==typeof e||(e=aa.stringify);var t,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(r.slashes?"//":"");return r.username&&(o+=r.username,r.password&&(o+=":"+r.password),o+="@"),o+=r.host+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(o+=r.hash),o}},fa.extractProtocol=ha,fa.location=pa,fa.qs=aa;var da=fa,ga=36e5,ya=864e5,va=function(e,t){t=t||{};var r=typeof e;if("string"===r&&0<e.length)return function(e){if(100<(e=String(e)).length)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return r*ya;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ga;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===r&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(ya<=t)return ma(e,t,ya,"day");if(ga<=t)return ma(e,t,ga,"hour");if(6e4<=t)return ma(e,t,6e4,"minute");if(1e3<=t)return ma(e,t,1e3,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(ya<=t)return Math.round(e/ya)+"d";if(ga<=t)return Math.round(e/ga)+"h";if(6e4<=t)return Math.round(e/6e4)+"m";if(1e3<=t)return Math.round(e/1e3)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function ma(e,t,r,n){var o=1.5*r<=t;return Math.round(e/r)+" "+n+(o?"s":"")}var ba=function(t){function r(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return c.colors[Math.abs(t)%c.colors.length]}function c(e){var s;function u(){if(u.enabled){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];var i=u,r=Number(new Date),n=r-(s||r);i.diff=n,i.prev=s,i.curr=r,s=r,o[0]=c.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;a++;var r=c.formatters[t];if("function"==typeof r){var n=o[a];e=r.call(i,n),o.splice(a,1),a--}return e}),c.formatArgs.call(i,o),(i.log||c.log).apply(i,o)}}return u.namespace=e,u.enabled=c.enabled(e),u.useColors=c.useColors(),u.color=r(e),u.destroy=n,u.extend=o,"function"==typeof c.init&&c.init(u),c.instances.push(u),u}function n(){var e=c.instances.indexOf(this);return-1!==e&&(c.instances.splice(e,1),!0)}function o(e,t){return c(this.namespace+(void 0===t?":":t)+e)}return((c.debug=c).default=c).coerce=function(e){return e instanceof Error?e.stack||e.message:e},c.disable=function(){c.enable("")},c.enable=function(e){var t;c.save(e),c.names=[],c.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")));for(t=0;t<c.instances.length;t++){var o=c.instances[t];o.enabled=c.enabled(o.namespace)}},c.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=c.skips.length;t<r;t++)if(c.skips[t].test(e))return!1;for(t=0,r=c.names.length;t<r;t++)if(c.names[t].test(e))return!0;return!1},c.humanize=va,Object.keys(t).forEach(function(e){c[e]=t[e]}),c.instances=[],c.names=[],c.skips=[],c.formatters={},c.selectColor=r,c.enable(c.load()),c},wa=Ki(function(o,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":r(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!this.useColors)return;var t="color: "+this.color;e.splice(1,0,t,"color: inherit");var r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(n=r))}),e.splice(n,0,t)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.exports=ba(t),o.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}),_a=(wa.log,wa.formatArgs,wa.save,wa.load,wa.useColors,wa.storage,wa.colors,{getOrigin:function(e){if(!e)return null;var t=new da(e);if("file:"===t.protocol)return null;var r=t.port;return r||(r="https:"===t.protocol?"443":"80"),t.protocol+"//"+t.hostname+":"+r},isOriginEqual:function(e,t){var r=this.getOrigin(e)===this.getOrigin(t);return r},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var r=e.split("?");return r[0]+t+(r[1]?"?"+r[1]:"")},addQuery:function(e,t){return e+(-1===e.indexOf("?")?"?"+t:"&"+t)}}),Pa=Ki(function(e){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}});function Ta(){this._listeners={}}Ta.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var r=this._listeners[e];-1===r.indexOf(t)&&(r=r.concat([t])),this._listeners[e]=r},Ta.prototype.removeEventListener=function(e,t){var r=this._listeners[e];if(r){var n=r.indexOf(t);-1===n||(1<r.length?this._listeners[e]=r.slice(0,n).concat(r.slice(n+1)):delete this._listeners[e])}},Ta.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,r=1===arguments.length?[e]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,r),t in this._listeners)for(var n=this._listeners[t],o=0;o<n.length;o++)n[o].apply(this,r)};var Ea=Ta;function Sa(){Ea.call(this)}Pa(Sa,Ea),Sa.prototype.removeAllListeners=function(e){e?delete this._listeners[e]:this._listeners={}},Sa.prototype.once=function(t,r){var n=this,o=!1;this.on(t,function e(){n.removeListener(t,e),o||(o=!0,r.apply(this,arguments))})},Sa.prototype.emit=function(){var e=arguments[0],t=this._listeners[e];if(t){for(var r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];for(var i=0;i<t.length;i++)t[i].apply(this,n)}},Sa.prototype.on=Sa.prototype.addListener=Ea.prototype.addEventListener,Sa.prototype.removeListener=Ea.prototype.removeEventListener;var Oa={EventEmitter:Sa},Ca=Ki(function(e){var t=Ji.WebSocket||Ji.MozWebSocket;e.exports=t?function(e){return new t(e)}:void 0}),xa=Oa.EventEmitter,Ra=function(){};function ja(e,t,r){if(!ja.enabled())throw new Error("Transport created when disabled");xa.call(this),Ra("constructor",e);var n=this,o=_a.addPath(e,"/websocket");o="https"===o.slice(0,5)?"wss"+o.slice(5):"ws"+o.slice(4),this.url=o,this.ws=new Ca(this.url,[],r),this.ws.onmessage=function(e){Ra("message event",e.data),n.emit("message",e.data)},this.unloadRef=ra.unloadAdd(function(){Ra("unload"),n.ws.close()}),this.ws.onclose=function(e){Ra("close event",e.code,e.reason),n.emit("close",e.code,e.reason),n._cleanup()},this.ws.onerror=function(e){Ra("error event",e),n.emit("close",1006,"WebSocket connection broken"),n._cleanup()}}Pa(ja,xa),ja.prototype.send=function(e){var t="["+e+"]";Ra("send",t),this.ws.send(t)},ja.prototype.close=function(){Ra("close");var e=this.ws;this._cleanup(),e&&e.close()},ja.prototype._cleanup=function(){Ra("_cleanup");var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),ra.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},ja.enabled=function(){return Ra("enabled"),!!Ca},ja.transportName="websocket",ja.roundTrips=2;var Fa=ja,Ia=Oa.EventEmitter;function Da(e,t){Ia.call(this),this.sendBuffer=[],this.sender=t,this.url=e}Pa(Da,Ia),Da.prototype.send=function(e){this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},Da.prototype.sendScheduleWait=function(){var e,t=this;this.sendStop=function(){t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){t.sendStop=null,t.sendSchedule()},25)},Da.prototype.sendSchedule=function(){this.sendBuffer.length;var t=this;if(0<this.sendBuffer.length){var e="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,e,function(e){t.sendStop=null,e?(t.emit("close",e.code||1006,"Sending error: "+e),t.close()):t.sendScheduleWait()}),this.sendBuffer=[]}},Da.prototype._cleanup=function(){this.removeAllListeners()},Da.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)};var Aa=Da,Ma=Oa.EventEmitter;function ka(e,t,r){Ma.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=r,this._scheduleReceiver()}Pa(ka,Ma),ka.prototype._scheduleReceiver=function(){var r=this,n=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);n.on("message",function(e){r.emit("message",e)}),n.once("close",function(e,t){r.pollIsClosing,r.poll=n=null,r.pollIsClosing||("network"===t?r._scheduleReceiver():(r.emit("close",e||1006,t),r.removeAllListeners()))})},ka.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()};var La=ka;function Na(e,t,r,n,o){var i=_a.addPath(e,t),a=this;Aa.call(this,e,r),this.poll=new La(n,i,o),this.poll.on("message",function(e){a.emit("message",e)}),this.poll.once("close",function(e,t){a.poll=null,a.emit("close",e,t),a.close()})}Pa(Na,Aa),Na.prototype.close=function(){Aa.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)};var $a=Na,Ua=function(){};function qa(e,t,r,n){var a;$a.call(this,e,t,(a=n,function(e,t,r){Ua("create ajax sender",e,t);var n={};"string"==typeof t&&(n.headers={"Content-type":"text/plain"});var o=_a.addPath(e,"/xhr_send"),i=new a("POST",o,t,n);return i.once("finish",function(e){if(Ua("finish",e),i=null,200!==e&&204!==e)return r(new Error("http status "+e));r()}),function(){Ua("abort"),i.close(),i=null;var e=new Error("Aborted");e.code=1e3,r(e)}}),r,n)}Pa(qa,$a);var Ya=qa,Va=Oa.EventEmitter;function Ha(e,t){Va.call(this);var n=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(e,t){n._chunkHandler(e,t),n.xo=null;var r=200===e?"network":"permanent";n.emit("close",null,r),n._cleanup()})}Pa(Ha,Va),Ha.prototype._chunkHandler=function(e,t){if(200===e&&t)for(var r=-1;;this.bufferPosition+=r+1){var n=t.slice(this.bufferPosition);if(-1===(r=n.indexOf("\n")))break;var o=n.slice(0,r);o&&this.emit("message",o)}},Ha.prototype._cleanup=function(){this.removeAllListeners()},Ha.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()};var Ba=Ha,za=Oa.EventEmitter,Ga=Ji.XMLHttpRequest;function Wa(e,t,r,n){var o=this;za.call(this),setTimeout(function(){o._start(e,t,r,n)},0)}Pa(Wa,za),Wa.prototype._start=function(e,t,r,n){var o=this;try{this.xhr=new Ga}catch(e){}if(!this.xhr)return this.emit("finish",0,"no xhr support"),void this._cleanup();t=_a.addQuery(t,"t="+ +new Date),this.unloadRef=ra.unloadAdd(function(){o._cleanup(!0)});try{this.xhr.open(e,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){o.emit("finish",0,""),o._cleanup(!1)})}catch(e){return this.emit("finish",0,""),void this._cleanup(!1)}if(n&&n.noCredentials||!Wa.supportsCORS||(this.xhr.withCredentials=!0),n&&n.headers)for(var i in n.headers)this.xhr.setRequestHeader(i,n.headers[i]);this.xhr.onreadystatechange=function(){if(o.xhr){var e,t,r=o.xhr;switch(r.readyState,r.readyState){case 3:try{t=r.status,e=r.responseText}catch(e){}1223===t&&(t=204),200===t&&e&&0<e.length&&o.emit("chunk",t,e);break;case 4:1223===(t=r.status)&&(t=204),12005!==t&&12029!==t||(t=0),r.responseText,o.emit("finish",t,r.responseText),o._cleanup(!1)}}};try{o.xhr.send(r)}catch(e){o.emit("finish",0,""),o._cleanup(!1)}},Wa.prototype._cleanup=function(e){if(this.xhr){if(this.removeAllListeners(),ra.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),e)try{this.xhr.abort()}catch(e){}this.unloadRef=this.xhr=null}},Wa.prototype.close=function(){this._cleanup(!0)},Wa.enabled=!!Ga;var Xa=["Active"].concat("Object").join("X");!Wa.enabled&&Xa in Ji&&(Wa.enabled=!!new(Ga=function(){try{return new Ji[Xa]("Microsoft.XMLHTTP")}catch(e){return null}}));var Qa=!1;try{Qa="withCredentials"in new Ga}catch(e){}Wa.supportsCORS=Qa;var Ja=Wa;function Ka(e,t,r,n){Ja.call(this,e,t,r,n)}Pa(Ka,Ja),Ka.enabled=Ja.enabled&&Ja.supportsCORS;var Za=Ka;function es(e,t,r){Ja.call(this,e,t,r,{noCredentials:!0})}Pa(es,Ja),es.enabled=Ja.enabled;var ts=es,rs={isOpera:function(){return Ji.navigator&&/opera/i.test(Ji.navigator.userAgent)},isKonqueror:function(){return Ji.navigator&&/konqueror/i.test(Ji.navigator.userAgent)},hasDomain:function(){if(!Ji.document)return!0;try{return!!Ji.document.domain}catch(e){return!1}}};function ns(e){if(!ts.enabled&&!Za.enabled)throw new Error("Transport created when disabled");Ya.call(this,e,"/xhr_streaming",Ba,Za)}Pa(ns,Ya),ns.enabled=function(e){return!e.nullOrigin&&(!rs.isOpera()&&Za.enabled)},ns.transportName="xhr-streaming",ns.roundTrips=2,ns.needBody=!!Ji.document;var os=ns,is=Oa.EventEmitter;function as(e,t,r){var n=this;is.call(this),setTimeout(function(){n._start(e,t,r)},0)}Pa(as,is),as.prototype._start=function(e,t,r){var n=this,o=new Ji.XDomainRequest;t=_a.addQuery(t,"t="+ +new Date),o.onerror=function(){n._error()},o.ontimeout=function(){n._error()},o.onprogress=function(){o.responseText,n.emit("chunk",200,o.responseText)},o.onload=function(){n.emit("finish",200,o.responseText),n._cleanup(!1)},this.xdr=o,this.unloadRef=ra.unloadAdd(function(){n._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(r)}catch(e){this._error()}},as.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},as.prototype._cleanup=function(e){if(this.xdr){if(this.removeAllListeners(),ra.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch(e){}this.unloadRef=this.xdr=null}},as.prototype.close=function(){this._cleanup(!0)},as.enabled=!(!Ji.XDomainRequest||!rs.hasDomain());var ss=as;function us(e){if(!ss.enabled)throw new Error("Transport created when disabled");Ya.call(this,e,"/xhr_streaming",Ba,ss)}Pa(us,Ya),us.enabled=function(e){return!e.cookie_needed&&!e.nullOrigin&&(ss.enabled&&e.sameScheme)},us.transportName="xdr-streaming",us.roundTrips=2;var cs=us,ls=Ji.EventSource,ps=Oa.EventEmitter;function hs(e){ps.call(this);var r=this,n=this.es=new ls(e);n.onmessage=function(e){e.data,r.emit("message",decodeURI(e.data))},n.onerror=function(e){n.readyState;var t=2!==n.readyState?"network":"permanent";r._cleanup(),r._close(t)}}Pa(hs,ps),hs.prototype.abort=function(){this._cleanup(),this._close("user")},hs.prototype._cleanup=function(){var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},hs.prototype._close=function(e){var t=this;setTimeout(function(){t.emit("close",null,e),t.removeAllListeners()},200)};var fs=hs;function ds(e){if(!ds.enabled())throw new Error("Transport created when disabled");Ya.call(this,e,"/eventsource",fs,Za)}Pa(ds,Ya),ds.enabled=function(){return!!ls},ds.transportName="eventsource",ds.roundTrips=2;var gs=ds,ys=Ki(function(a,s){(function(){var N={function:!0,object:!0},e=s&&!s.nodeType&&s,$=N[typeof window]&&window||this,t=e&&N.object&&a&&!a.nodeType&&"object"==typeof Ji&&Ji;function U(e,u){e||(e=$.Object()),u||(u=$.Object());var c=e.Number||$.Number,l=e.String||$.String,t=e.Object||$.Object,p=e.Date||$.Date,r=e.SyntaxError||$.SyntaxError,T=e.TypeError||$.TypeError,n=e.Math||$.Math,o=e.JSON||$.JSON;"object"==typeof o&&o&&(u.stringify=o.stringify,u.parse=o.parse);var E,S,O,i=t.prototype,C=i.toString,h=new p(-0xc782b5b800cec);try{h=-109252==h.getUTCFullYear()&&0===h.getUTCMonth()&&1===h.getUTCDate()&&10==h.getUTCHours()&&37==h.getUTCMinutes()&&6==h.getUTCSeconds()&&708==h.getUTCMilliseconds()}catch(e){}function f(e){if(f[e]!==O)return f[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=f("json-stringify")&&f("json-parse");else{var r,n='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var o=u.stringify,i="function"==typeof o&&h;if(i){(r=function(){return 1}).toJSON=r;try{i="0"===o(0)&&"0"===o(new c)&&'""'==o(new l)&&o(C)===O&&o(O)===O&&o()===O&&"1"===o(r)&&"[1]"==o([r])&&"[null]"==o([O])&&"null"==o(null)&&"[null,null,null]"==o([O,C,null])&&o({a:[r,!0,!1,null,"\0\b\n\f\r\t"]})==n&&"1"===o(null,r)&&"[\n 1,\n 2\n]"==o([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==o(new p(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==o(new p(864e13))&&'"-000001-01-01T00:00:00.000Z"'==o(new p(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==o(new p(-1))}catch(e){i=!1}}t=i}if("json-parse"==e){var a=u.parse;if("function"==typeof a)try{if(0===a("0")&&!a(!1)){var s=5==(r=a(n)).a.length&&1===r.a[0];if(s){try{s=!a('"\t"')}catch(e){}if(s)try{s=1!==a("01")}catch(e){}if(s)try{s=1!==a("1.")}catch(e){}}}}catch(e){s=!1}t=s}}return f[e]=!!t}if(!f("json")){var d="[object Function]",x="[object Number]",R="[object String]",j="[object Array]",s=f("bug-string-char-index");if(!h)var F=n.floor,a=[0,31,59,90,120,151,181,212,243,273,304,334],I=function(e,t){return a[t]+365*(e-1970)+F((e-1969+(t=+(1<t)))/4)-F((e-1901+t)/100)+F((e-1601+t)/400)};if((E=i.hasOwnProperty)||(E=function(e){var r,t={};return E=(t.__proto__=null,t.__proto__={toString:1},t).toString!=C?function(e){var t=this.__proto__,r=e in(this.__proto__=null,this);return this.__proto__=t,r}:(r=t.constructor,function(e){var t=(this.constructor||r).prototype;return e in this&&!(e in t&&this[e]===t[e])}),t=null,E.call(this,e)}),S=function(e,t){var r,a,n,o=0;for(n in(r=function(){this.valueOf=0}).prototype.valueOf=0,a=new r)E.call(a,n)&&o++;return r=a=null,(S=o?2==o?function(e,t){var r,n={},o=C.call(e)==d;for(r in e)o&&"prototype"==r||E.call(n,r)||!(n[r]=1)||!E.call(e,r)||t(r)}:function(e,t){var r,n,o=C.call(e)==d;for(r in e)o&&"prototype"==r||!E.call(e,r)||(n="constructor"===r)||t(r);(n||E.call(e,r="constructor"))&&t(r)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(e,t){var r,n,o=C.call(e)==d,i=!o&&"function"!=typeof e.constructor&&N[typeof e.hasOwnProperty]&&e.hasOwnProperty||E;for(r in e)o&&"prototype"==r||!i.call(e,r)||t(r);for(n=a.length;r=a[--n];i.call(e,r)&&t(r));}))(e,t)},!f("json-stringify")){var g={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},D=function(e,t){return("000000"+(t||0)).slice(-e)},A=function(e){for(var t='"',r=0,n=e.length,o=!s||10<n,i=o&&(s?e.split(""):e);r<n;r++){var a=e.charCodeAt(r);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=g[a];break;default:if(a<32){t+="\\u00"+D(2,a.toString(16));break}t+=o?i[r]:e.charAt(r)}}return t+'"'},M=function(e,t,r,n,o,i,a){var s,u,c,l,p,h,f,d,g,y,v,m,b,w,_,P;try{s=t[e]}catch(e){}if("object"==typeof s&&s)if("[object Date]"!=(u=C.call(s))||E.call(s,"toJSON"))"function"==typeof s.toJSON&&(u!=x&&u!=R&&u!=j||E.call(s,"toJSON"))&&(s=s.toJSON(e));else if(-1/0<s&&s<1/0){if(I){for(p=F(s/864e5),c=F(p/365.2425)+1970-1;I(c+1,0)<=p;c++);for(l=F((p-I(c,0))/30.42);I(c,l+1)<=p;l++);p=1+p-I(c,l),f=F((h=(s%864e5+864e5)%864e5)/36e5)%24,d=F(h/6e4)%60,g=F(h/1e3)%60,y=h%1e3}else c=s.getUTCFullYear(),l=s.getUTCMonth(),p=s.getUTCDate(),f=s.getUTCHours(),d=s.getUTCMinutes(),g=s.getUTCSeconds(),y=s.getUTCMilliseconds();s=(c<=0||1e4<=c?(c<0?"-":"+")+D(6,c<0?-c:c):D(4,c))+"-"+D(2,l+1)+"-"+D(2,p)+"T"+D(2,f)+":"+D(2,d)+":"+D(2,g)+"."+D(3,y)+"Z"}else s=null;if(r&&(s=r.call(t,e,s)),null===s)return"null";if("[object Boolean]"==(u=C.call(s)))return""+s;if(u==x)return-1/0<s&&s<1/0?""+s:"null";if(u==R)return A(""+s);if("object"==typeof s){for(w=a.length;w--;)if(a[w]===s)throw T();if(a.push(s),v=[],_=i,i+=o,u==j){for(b=0,w=s.length;b<w;b++)m=M(b,s,r,n,o,i,a),v.push(m===O?"null":m);P=v.length?o?"[\n"+i+v.join(",\n"+i)+"\n"+_+"]":"["+v.join(",")+"]":"[]"}else S(n||s,function(e){var t=M(e,s,r,n,o,i,a);t!==O&&v.push(A(e)+":"+(o?" ":"")+t)}),P=v.length?o?"{\n"+i+v.join(",\n"+i)+"\n"+_+"}":"{"+v.join(",")+"}":"{}";return a.pop(),P}};u.stringify=function(e,t,r){var n,o,i,a;if(N[typeof t]&&t)if((a=C.call(t))==d)o=t;else if(a==j){i={};for(var s,u=0,c=t.length;u<c;s=t[u++],((a=C.call(s))==R||a==x)&&(i[s]=1));}if(r)if((a=C.call(r))==x){if(0<(r-=r%1))for(n="",10<r&&(r=10);n.length<r;n+=" ");}else a==R&&(n=r.length<=10?r:r.slice(0,10));return M("",((s={})[""]=e,s),o,i,n,"",[])}}if(!f("json-parse")){var y,v,m=l.fromCharCode,b={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},w=function(){throw y=v=null,r()},_=function(){for(var e,t,r,n,o,i=v,a=i.length;y<a;)switch(o=i.charCodeAt(y)){case 9:case 10:case 13:case 32:y++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=s?i.charAt(y):i[y],y++,e;case 34:for(e="@",y++;y<a;)if((o=i.charCodeAt(y))<32)w();else if(92==o)switch(o=i.charCodeAt(++y)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=b[o],y++;break;case 117:for(t=++y,r=y+4;y<r;y++)48<=(o=i.charCodeAt(y))&&o<=57||97<=o&&o<=102||65<=o&&o<=70||w();e+=m("0x"+i.slice(t,y));break;default:w()}else{if(34==o)break;for(o=i.charCodeAt(y),t=y;32<=o&&92!=o&&34!=o;)o=i.charCodeAt(++y);e+=i.slice(t,y)}if(34==i.charCodeAt(y))return y++,e;w();default:if(t=y,45==o&&(n=!0,o=i.charCodeAt(++y)),48<=o&&o<=57){for(48==o&&(48<=(o=i.charCodeAt(y+1))&&o<=57)&&w(),n=!1;y<a&&(48<=(o=i.charCodeAt(y))&&o<=57);y++);if(46==i.charCodeAt(y)){for(r=++y;r<a&&(48<=(o=i.charCodeAt(r))&&o<=57);r++);r==y&&w(),y=r}if(101==(o=i.charCodeAt(y))||69==o){for(43!=(o=i.charCodeAt(++y))&&45!=o||y++,r=y;r<a&&(48<=(o=i.charCodeAt(r))&&o<=57);r++);r==y&&w(),y=r}return+i.slice(t,y)}if(n&&w(),"true"==i.slice(y,y+4))return y+=4,!0;if("false"==i.slice(y,y+5))return y+=5,!1;if("null"==i.slice(y,y+4))return y+=4,null;w()}return"$"},P=function(e){var t,r;if("$"==e&&w(),"string"==typeof e){if("@"==(s?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=_());r||(r=!0))r&&(","==e?"]"==(e=_())&&w():w()),","==e&&w(),t.push(P(e));return t}if("{"==e){for(t={};"}"!=(e=_());r||(r=!0))r&&(","==e?"}"==(e=_())&&w():w()),","!=e&&"string"==typeof e&&"@"==(s?e.charAt(0):e[0])&&":"==_()||w(),t[e.slice(1)]=P(_());return t}w()}return e},k=function(e,t,r){var n=L(e,t,r);n===O?delete e[t]:e[t]=n},L=function(e,t,r){var n,o=e[t];if("object"==typeof o&&o)if(C.call(o)==j)for(n=o.length;n--;)k(o,n,r);else S(o,function(e){k(o,e,r)});return r.call(e,t,o)};u.parse=function(e,t){var r,n;return y=0,v=""+e,r=P(_()),"$"!=_()&&w(),y=v=null,t&&C.call(t)==d?L(((n={})[""]=r,n),"",t):r}}}return u.runInContext=U,u}if(!t||t.global!==t&&t.window!==t&&t.self!==t||($=t),e)U($,e);else{var r=$.JSON,n=$.JSON3,o=!1,i=U($,$.JSON3={noConflict:function(){return o||(o=!0,$.JSON=r,$.JSON3=n,r=n=null),i}});$.JSON={parse:i.parse,stringify:i.stringify}}}).call(this)}),vs=Ki(function(p){p.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){p.exports.WPrefix in Ji||(Ji[p.exports.WPrefix]={})},postMessage:function(e,t){Ji.parent!==Ji&&Ji.parent.postMessage(ys.stringify({windowId:p.exports.currentWindowId,type:e,data:t||""}),"*")},createIframe:function(e,t){var r,n,o=Ji.document.createElement("iframe"),i=function(){clearTimeout(r);try{o.onload=null}catch(e){}o.onerror=null},a=function(){o&&(i(),setTimeout(function(){o&&o.parentNode.removeChild(o),o=null},0),ra.unloadDel(n))},s=function(e){o&&(a(),t(e))};return o.src=e,o.style.display="none",o.style.position="absolute",o.onerror=function(){s("onerror")},o.onload=function(){clearTimeout(r),r=setTimeout(function(){s("onload timeout")},2e3)},Ji.document.body.appendChild(o),r=setTimeout(function(){s("timeout")},15e3),n=ra.unloadAdd(a),{post:function(e,t){setTimeout(function(){try{o&&o.contentWindow&&o.contentWindow.postMessage(e,t)}catch(e){}},0)},cleanup:a,loaded:i}},createHtmlfile:function(e,t){var r,n,o,i=["Active"].concat("Object").join("X"),a=new Ji[i]("htmlfile"),s=function(){clearTimeout(r),o.onerror=null},u=function(){a&&(s(),ra.unloadDel(n),o.parentNode.removeChild(o),o=a=null,CollectGarbage())},c=function(e){a&&(u(),t(e))};a.open(),a.write('<html><script>document.domain="'+Ji.document.domain+'";<\/script></html>'),a.close(),a.parentWindow[p.exports.WPrefix]=Ji[p.exports.WPrefix];var l=a.createElement("div");return a.body.appendChild(l),o=a.createElement("iframe"),l.appendChild(o),o.src=e,o.onerror=function(){c("onerror")},r=setTimeout(function(){c("timeout")},15e3),n=ra.unloadAdd(u),{post:function(e,t){try{setTimeout(function(){o&&o.contentWindow&&o.contentWindow.postMessage(e,t)},0)}catch(e){}},cleanup:u,loaded:s}}},p.exports.iframeEnabled=!1,Ji.document&&(p.exports.iframeEnabled=("function"==typeof Ji.postMessage||"object"==typeof Ji.postMessage)&&!rs.isKonqueror())}),ms=(vs.WPrefix,vs.currentWindowId,vs.polluteGlobalNamespace,vs.postMessage,vs.createIframe,vs.createHtmlfile,vs.iframeEnabled,Oa.EventEmitter),bs=function(){};function ws(e,t,r){if(!ws.enabled())throw new Error("Transport created when disabled");ms.call(this);var n=this;this.origin=_a.getOrigin(r),this.baseUrl=r,this.transUrl=t,this.transport=e,this.windowId=ta.string(8);var o=_a.addPath(r,"/iframe.html")+"#"+this.windowId;bs(e,t,o),this.iframeObj=vs.createIframe(o,function(e){bs("err callback"),n.emit("close",1006,"Unable to load an iframe ("+e+")"),n.close()}),this.onmessageCallback=this._message.bind(this),ra.attachEvent("message",this.onmessageCallback)}Pa(ws,ms),ws.prototype.close=function(){if(bs("close"),this.removeAllListeners(),this.iframeObj){ra.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(e){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},ws.prototype._message=function(t){if(bs("message",t.data),_a.isOriginEqual(t.origin,this.origin)){var r;try{r=ys.parse(t.data)}catch(e){return void bs("bad json",t.data)}if(r.windowId===this.windowId)switch(r.type){case"s":this.iframeObj.loaded(),this.postMessage("s",ys.stringify(["1.3.0",this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",r.data);break;case"c":var e;try{e=ys.parse(r.data)}catch(e){return void bs("bad json",r.data)}this.emit("close",e[0],e[1]),this.close()}else bs("mismatched window id",r.windowId,this.windowId)}else bs("not same origin",t.origin,this.origin)},ws.prototype.postMessage=function(e,t){bs("postMessage",e,t),this.iframeObj.post(ys.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)},ws.prototype.send=function(e){bs("send",e),this.postMessage("m",e)},ws.enabled=function(){return vs.iframeEnabled},ws.transportName="iframe",ws.roundTrips=2;var _s=ws,Ps={isObject:function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,r,n=1,o=arguments.length;n<o;n++)for(r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}},Ts=function(n){function e(e,t){_s.call(this,n.transportName,e,t)}return Pa(e,_s),e.enabled=function(e,t){if(!Ji.document)return!1;var r=Ps.extend({},t);return r.sameOrigin=!0,n.enabled(r)&&_s.enabled()},e.transportName="iframe-"+n.transportName,e.needBody=!0,e.roundTrips=_s.roundTrips+n.roundTrips-1,e.facadeTransport=n,e},Es=Oa.EventEmitter,Ss=function(){};function Os(e){Ss(e),Es.call(this);var t=this;vs.polluteGlobalNamespace(),this.id="a"+ta.string(6),e=_a.addQuery(e,"c="+decodeURIComponent(vs.WPrefix+"."+this.id)),Ss("using htmlfile",Os.htmlfileEnabled);var r=Os.htmlfileEnabled?vs.createHtmlfile:vs.createIframe;Ji[vs.WPrefix][this.id]={start:function(){Ss("start"),t.iframeObj.loaded()},message:function(e){Ss("message",e),t.emit("message",e)},stop:function(){Ss("stop"),t._cleanup(),t._close("network")}},this.iframeObj=r(e,function(){Ss("callback"),t._cleanup(),t._close("permanent")})}Pa(Os,Es),Os.prototype.abort=function(){Ss("abort"),this._cleanup(),this._close("user")},Os.prototype._cleanup=function(){Ss("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete Ji[vs.WPrefix][this.id]},Os.prototype._close=function(e){Ss("_close",e),this.emit("close",null,e),this.removeAllListeners()},Os.htmlfileEnabled=!1;var Cs=["Active"].concat("Object").join("X");if(Cs in Ji)try{Os.htmlfileEnabled=!!new Ji[Cs]("htmlfile")}catch(e){}Os.enabled=Os.htmlfileEnabled||vs.iframeEnabled;var xs=Os;function Rs(e){if(!xs.enabled)throw new Error("Transport created when disabled");Ya.call(this,e,"/htmlfile",xs,ts)}Pa(Rs,Ya),Rs.enabled=function(e){return xs.enabled&&e.sameOrigin},Rs.transportName="htmlfile",Rs.roundTrips=2;var js=Rs;function Fs(e){if(!ts.enabled&&!Za.enabled)throw new Error("Transport created when disabled");Ya.call(this,e,"/xhr",Ba,Za)}Pa(Fs,Ya),Fs.enabled=function(e){return!e.nullOrigin&&(!(!ts.enabled||!e.sameOrigin)||Za.enabled)},Fs.transportName="xhr-polling",Fs.roundTrips=2;var Is=Fs;function Ds(e){if(!ss.enabled)throw new Error("Transport created when disabled");Ya.call(this,e,"/xhr",Ba,ss)}Pa(Ds,Ya),Ds.enabled=cs.enabled,Ds.transportName="xdr-polling",Ds.roundTrips=2;var As=Ds,Ms=Oa.EventEmitter,ks=function(){};function Ls(e){ks(e);var t=this;Ms.call(this),vs.polluteGlobalNamespace(),this.id="a"+ta.string(6);var r=_a.addQuery(e,"c="+encodeURIComponent(vs.WPrefix+"."+this.id));Ji[vs.WPrefix][this.id]=this._callback.bind(this),this._createScript(r),this.timeoutId=setTimeout(function(){ks("timeout"),t._abort(new Error("JSONP script loaded abnormally (timeout)"))},Ls.timeout)}Pa(Ls,Ms),Ls.prototype.abort=function(){if(ks("abort"),Ji[vs.WPrefix][this.id]){var e=new Error("JSONP user aborted read");e.code=1e3,this._abort(e)}},Ls.timeout=35e3,Ls.scriptErrorTimeout=1e3,Ls.prototype._callback=function(e){ks("_callback",e),this._cleanup(),this.aborting||(e&&(ks("message",e),this.emit("message",e)),this.emit("close",null,"network"),this.removeAllListeners())},Ls.prototype._abort=function(e){ks("_abort",e),this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()},Ls.prototype._cleanup=function(){if(ks("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete Ji[vs.WPrefix][this.id]},Ls.prototype._scriptError=function(){ks("_scriptError");var e=this;this.errorTimer||(this.errorTimer=setTimeout(function(){e.loadedOkay||e._abort(new Error("JSONP script loaded abnormally (onerror)"))},Ls.scriptErrorTimeout))},Ls.prototype._createScript=function(e){ks("_createScript",e);var t,r=this,n=this.script=Ji.document.createElement("script");if(n.id="a"+ta.string(8),n.src=e,n.type="text/javascript",n.charset="UTF-8",n.onerror=this._scriptError.bind(this),n.onload=function(){ks("onload"),r._abort(new Error("JSONP script loaded abnormally (onload)"))},n.onreadystatechange=function(){if(ks("onreadystatechange",n.readyState),/loaded|closed/.test(n.readyState)){if(n&&n.htmlFor&&n.onclick){r.loadedOkay=!0;try{n.onclick()}catch(e){}}n&&r._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===n.async&&Ji.document.attachEvent)if(rs.isOpera())(t=this.script2=Ji.document.createElement("script")).text="try{var a = document.getElementById('"+n.id+"'); if(a)a.onerror();}catch(x){};",n.async=t.async=!1;else{try{n.htmlFor=n.id,n.event="onclick"}catch(e){}n.async=!0}void 0!==n.async&&(n.async=!0);var o=Ji.document.getElementsByTagName("head")[0];o.insertBefore(n,o.firstChild),t&&o.insertBefore(t,o.firstChild)};var Ns,$s,Us=Ls;var qs=function(e,t,r){Ns||((Ns=Ji.document.createElement("form")).style.display="none",Ns.style.position="absolute",Ns.method="POST",Ns.enctype="application/x-www-form-urlencoded",Ns.acceptCharset="UTF-8",($s=Ji.document.createElement("textarea")).name="d",Ns.appendChild($s),Ji.document.body.appendChild(Ns));var n="a"+ta.string(8);Ns.target=n,Ns.action=_a.addQuery(_a.addPath(e,"/jsonp_send"),"i="+n);var o=function(t){try{return Ji.document.createElement('<iframe name="'+t+'">')}catch(e){var r=Ji.document.createElement("iframe");return r.name=t,r}}(n);o.id=n,o.style.display="none",Ns.appendChild(o);try{$s.value=t}catch(e){}Ns.submit();var i=function(e){o.onerror&&(o.onreadystatechange=o.onerror=o.onload=null,setTimeout(function(){o.parentNode.removeChild(o),o=null},500),$s.value="",r(e))};return o.onerror=function(){i()},o.onload=function(){i()},o.onreadystatechange=function(e){o.readyState,"complete"===o.readyState&&i()},function(){i(new Error("Aborted"))}};function Ys(e){if(!Ys.enabled())throw new Error("Transport created when disabled");$a.call(this,e,"/jsonp",qs,Us)}Pa(Ys,$a),Ys.enabled=function(){return!!Ji.document},Ys.transportName="jsonp-polling",Ys.roundTrips=1,Ys.needBody=!0;var Vs,Hs=Ys,Bs=[Fa,os,cs,gs,Ts(gs),js,Ts(js),Is,As,Ts(Is),Hs],zs=Array.prototype,Gs=Object.prototype,Ws=Function.prototype,Xs=String.prototype,Qs=zs.slice,Js=Gs.toString,Ks=function(e){return"[object Function]"===Gs.toString.call(e)},Zs=function(e){return"[object String]"===Js.call(e)},eu=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}();Vs=eu?function(e,t,r,n){!n&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r})}:function(e,t,r,n){!n&&t in e||(e[t]=r)};var tu=function(e,t,r){for(var n in t)Gs.hasOwnProperty.call(t,n)&&Vs(e,n,t[n],r)},ru=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)};function nu(){}tu(Ws,{bind:function(t){var r=this;if(!Ks(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var n=Qs.call(arguments,1),e=Math.max(0,r.length-n.length),o=[],i=0;i<e;i++)o.push("$"+i);var a=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof a){var e=r.apply(this,n.concat(Qs.call(arguments)));return Object(e)===e?e:this}return r.apply(t,n.concat(Qs.call(arguments)))});return r.prototype&&(nu.prototype=r.prototype,a.prototype=new nu,nu.prototype=null),a}}),tu(Array,{isArray:function(e){return"[object Array]"===Js.call(e)}});var ou,iu,au,su=Object("a"),uu="a"!==su[0]||!(0 in su);tu(zs,{forEach:function(e){var t=ru(this),r=uu&&Zs(this)?this.split(""):t,n=arguments[1],o=-1,i=r.length>>>0;if(!Ks(e))throw new TypeError;for(;++o<i;)o in r&&e.call(n,r[o],o,t)}},(ou=zs.forEach,au=iu=!0,ou&&(ou.call("foo",function(e,t,r){"object"!=typeof r&&(iu=!1)}),ou.call([1],function(){au="string"==typeof this},"x")),!(ou&&iu&&au)));var cu=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);tu(zs,{indexOf:function(e){var t=uu&&Zs(this)?this.split(""):ru(this),r=t.length>>>0;if(!r)return-1;var n,o,i=0;for(1<arguments.length&&(n=arguments[1],(o=+n)!=o?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(0<o||-1)*Math.floor(Math.abs(o))),i=o),i=0<=i?i:Math.max(0,r+i);i<r;i++)if(i in t&&t[i]===e)return i;return-1}},cu);var lu,pu=Xs.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||1<".".split(/()()/).length?(lu=void 0===/()??/.exec("")[1],Xs.split=function(e,t){var r=this;if(void 0===e&&0===t)return[];if("[object RegExp]"!==Js.call(e))return pu.call(this,e,t);var n,o,i,a,s=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),c=0;for(e=new RegExp(e.source,u+"g"),r+="",lu||(n=new RegExp("^"+e.source+"$(?!\\s)",u)),t=void 0===t?-1>>>0:t>>>0;(o=e.exec(r))&&!(c<(i=o.index+o[0].length)&&(s.push(r.slice(c,o.index)),!lu&&1<o.length&&o[0].replace(n,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(o[e]=void 0)}),1<o.length&&o.index<r.length&&zs.push.apply(s,o.slice(1)),a=o[0].length,c=i,s.length>=t));)e.lastIndex===o.index&&e.lastIndex++;return c===r.length?!a&&e.test("")||s.push(""):s.push(r.slice(c)),s.length>t?s.slice(0,t):s}):"0".split(void 0,0).length&&(Xs.split=function(e,t){return void 0===e&&0===t?[]:pu.call(this,e,t)});var hu=Xs.substr,fu="".substr&&"b"!=="0b".substr(-1);tu(Xs,{substr:function(e,t){return hu.call(this,e<0&&(e=this.length+e)<0?0:e,t)}},fu);var du,gu=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,yu=function(e){var t=ys.stringify(e);return gu.lastIndex=0,gu.test(t)?(du||(du=function(e){var t,r={},n=[];for(t=0;t<65536;t++)n.push(String.fromCharCode(t));return e.lastIndex=0,n.join("").replace(e,function(e){return r[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,r}(gu)),t.replace(gu,function(e){return du[e]})):t},vu={};["log","debug","warn"].forEach(function(e){var t;try{t=Ji.console&&Ji.console[e]&&Ji.console[e].apply}catch(e){}vu[e]=t?function(){return Ji.console[e].apply(Ji.console,arguments)}:"log"===e?function(){}:vu.log});var mu=vu;function bu(e){this.type=e}bu.prototype.initEvent=function(e,t,r){return this.type=e,this.bubbles=t,this.cancelable=r,this.timeStamp=+new Date,this},bu.prototype.stopPropagation=function(){},bu.prototype.preventDefault=function(){},bu.CAPTURING_PHASE=1,bu.AT_TARGET=2,bu.BUBBLING_PHASE=3;var wu=bu,_u=Ji.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""};function Pu(){wu.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}Pa(Pu,wu);var Tu=Pu;function Eu(e){wu.call(this),this.initEvent("message",!1,!1),this.data=e}Pa(Eu,wu);var Su=Eu,Ou=Oa.EventEmitter;function Cu(){var e=this;Ou.call(this),this.to=setTimeout(function(){e.emit("finish",200,"{}")},Cu.timeout)}Pa(Cu,Ou),Cu.prototype.close=function(){clearTimeout(this.to)},Cu.timeout=2e3;var xu=Cu,Ru=Oa.EventEmitter;function ju(e,t){Ru.call(this);var o=this,i=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(e,t){var r,n;if(200===e){if(n=+new Date-i,t)try{r=ys.parse(t)}catch(e){}Ps.isObject(r)||(r={})}o.emit("finish",r,n),o.removeAllListeners()})}Pa(ju,Ru),ju.prototype.close=function(){this.removeAllListeners(),this.xo.close()};var Fu=ju,Iu=Oa.EventEmitter;function Du(e){var r=this;Iu.call(this),this.ir=new Fu(e,ts),this.ir.once("finish",function(e,t){r.ir=null,r.emit("message",ys.stringify([e,t]))})}Pa(Du,Iu),Du.transportName="iframe-info-receiver",Du.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()};var Au=Du,Mu=Oa.EventEmitter;function ku(t,r){var o=this;Mu.call(this);var e=function(){var e=o.ifr=new _s(Au.transportName,r,t);e.once("message",function(e){if(e){var t;try{t=ys.parse(e)}catch(e){return o.emit("finish"),void o.close()}var r=t[0],n=t[1];o.emit("finish",r,n)}o.close()}),e.once("close",function(){o.emit("finish"),o.close()})};Ji.document.body?e():ra.attachEvent("load",e)}Pa(ku,Mu),ku.enabled=function(){return _s.enabled()},ku.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null};var Lu=ku,Nu=Oa.EventEmitter;function $u(e,t){var r=this;Nu.call(this),setTimeout(function(){r.doXhr(e,t)},0)}Pa($u,Nu),$u._getReceiver=function(e,t,r){return r.sameOrigin?new Fu(t,ts):Za.enabled?new Fu(t,Za):ss.enabled&&r.sameScheme?new Fu(t,ss):Lu.enabled()?new Lu(e,t):new Fu(t,xu)},$u.prototype.doXhr=function(e,t){var r=this,n=_a.addPath(e,"/info");this.xo=$u._getReceiver(e,n,t),this.timeoutRef=setTimeout(function(){r._cleanup(!1),r.emit("finish")},$u.timeout),this.xo.once("finish",function(e,t){r._cleanup(!0),r.emit("finish",e,t)})},$u.prototype._cleanup=function(e){clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},$u.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},$u.timeout=8e3;var Uu=$u;function qu(e){(this._transport=e).on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}qu.prototype._transportClose=function(e,t){vs.postMessage("c",ys.stringify([e,t]))},qu.prototype._transportMessage=function(e){vs.postMessage("t",e)},qu.prototype._send=function(e){this._transport.send(e)},qu.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()};var Yu,Vu=qu,Hu=function(){};function Bu(e,t,r){if(!(this instanceof Bu))return new Bu(e,t,r);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");Ea.call(this),this.readyState=Bu.CONNECTING,this.extensions="",this.protocol="",(r=r||{}).protocols_whitelist&&mu.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=r.transports,this._transportOptions=r.transportOptions||{};var n=r.sessionId||8;if("function"==typeof n)this._generateSessionId=n;else{if("number"!=typeof n)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return ta.string(n)}}this._server=r.server||ta.numberString(1e3);var o=new da(e);if(!o.host||!o.protocol)throw new SyntaxError("The URL '"+e+"' is invalid");if(o.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==o.protocol&&"https:"!==o.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+o.protocol+"' is not allowed.");var i="https:"===o.protocol;if("https:"===_u.protocol&&!i)throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var a=t.sort();a.forEach(function(e,t){if(!e)throw new SyntaxError("The protocols entry '"+e+"' is invalid.");if(t<a.length-1&&e===a[t+1])throw new SyntaxError("The protocols entry '"+e+"' is duplicated.")});var s=_a.getOrigin(_u.href);this._origin=s?s.toLowerCase():null,o.set("pathname",o.pathname.replace(/\/+$/,"")),this.url=o.href,Hu("using url",this.url),this._urlInfo={nullOrigin:!rs.hasDomain(),sameOrigin:_a.isOriginEqual(this.url,_u.href),sameScheme:_a.isSchemeEqual(this.url,_u.href)},this._ir=new Uu(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function zu(e){return 1e3===e||3e3<=e&&e<=4999}Pa(Bu,Ea),Bu.prototype.close=function(e,t){if(e&&!zu(e))throw new Error("InvalidAccessError: Invalid code");if(t&&123<t.length)throw new SyntaxError("reason argument has an invalid length");if(this.readyState!==Bu.CLOSING&&this.readyState!==Bu.CLOSED){this._close(e||1e3,t||"Normal closure",!0)}},Bu.prototype.send=function(e){if("string"!=typeof e&&(e=""+e),this.readyState===Bu.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===Bu.OPEN&&this._transport.send(yu(e))},Bu.version="1.3.0",Bu.CONNECTING=0,Bu.OPEN=1,Bu.CLOSING=2,Bu.CLOSED=3,Bu.prototype._receiveInfo=function(e,t){if(Hu("_receiveInfo",t),this._ir=null,e){this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,e=Ps.extend(e,this._urlInfo),Hu("info",e);var r=Yu.filterToEnabled(this._transportsWhitelist,e);this._transports=r.main,Hu(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},Bu.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(Hu("attempt",e.transportName),e.needBody&&(!Ji.document.body||void 0!==Ji.document.readyState&&"complete"!==Ji.document.readyState&&"interactive"!==Ji.document.readyState))return Hu("waiting for body"),this._transports.unshift(e),void ra.attachEvent("load",this._connect.bind(this));var t=this._rto*e.roundTrips||5e3;this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),Hu("using timeout",t);var r=_a.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),n=this._transportOptions[e.transportName];Hu("transport url",r);var o=new e(r,this._transUrl,n);return o.on("message",this._transportMessage.bind(this)),o.once("close",this._transportClose.bind(this)),o.transportName=e.transportName,void(this._transport=o)}this._close(2e3,"All transports failed",!1)},Bu.prototype._transportTimeout=function(){Hu("_transportTimeout"),this.readyState===Bu.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},Bu.prototype._transportMessage=function(e){Hu("_transportMessage",e);var t,r=this,n=e.slice(0,1),o=e.slice(1);switch(n){case"o":return void this._open();case"h":return this.dispatchEvent(new wu("heartbeat")),void Hu("heartbeat",this.transport)}if(o)try{t=ys.parse(o)}catch(e){Hu("bad json",o)}if(void 0!==t)switch(n){case"a":Array.isArray(t)&&t.forEach(function(e){Hu("message",r.transport,e),r.dispatchEvent(new Su(e))});break;case"m":Hu("message",this.transport,t),this.dispatchEvent(new Su(t));break;case"c":Array.isArray(t)&&2===t.length&&this._close(t[0],t[1],!0)}else Hu("empty payload",o)},Bu.prototype._transportClose=function(e,t){Hu("_transportClose",this.transport,e,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),zu(e)||2e3===e||this.readyState!==Bu.CONNECTING?this._close(e,t):this._connect()},Bu.prototype._open=function(){Hu("_open",this._transport.transportName,this.readyState),this.readyState===Bu.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=Bu.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new wu("open")),Hu("connected",this.transport)):this._close(1006,"Server lost session")},Bu.prototype._close=function(t,r,n){Hu("_close",this.transport,t,r,n,this.readyState);var o=!1;if(this._ir&&(o=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===Bu.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=Bu.CLOSING,setTimeout(function(){this.readyState=Bu.CLOSED,o&&this.dispatchEvent(new wu("error"));var e=new Tu("close");e.wasClean=n||!1,e.code=t||1e3,e.reason=r,this.dispatchEvent(e),this.onmessage=this.onclose=this.onerror=null,Hu("disconnected")}.bind(this),0)},Bu.prototype.countRTO=function(e){return 100<e?4*e:300+e};var Gu,Wu,Xu,Qu,Ju=(Yu={filterToEnabled:function(t,r){var n={main:[],facade:[]};return t?"string"==typeof t&&(t=[t]):t=[],Gu.forEach(function(e){e&&("websocket"===e.transportName&&!1===r.websocket||(t.length&&-1===t.indexOf(e.transportName)?e.transportName:e.enabled(r)?(e.transportName,n.main.push(e),e.facadeTransport&&n.facade.push(e.facadeTransport)):e.transportName))}),n}},Wu=Bu,Qu={},(Gu=Bs).forEach(function(e){e.facadeTransport&&(Qu[e.facadeTransport.transportName]=e.facadeTransport)}),Qu[Au.transportName]=Au,Wu.bootstrap_iframe=function(){var s;vs.currentWindowId=_u.hash.slice(1),ra.attachEvent("message",function(t){if(t.source===parent&&(void 0===Xu&&(Xu=t.origin),t.origin===Xu)){var r;try{r=ys.parse(t.data)}catch(e){return void t.data}if(r.windowId===vs.currentWindowId)switch(r.type){case"s":var e;try{e=ys.parse(r.data)}catch(e){r.data;break}var n=e[0],o=e[1],i=e[2],a=e[3];if(n!==Wu.version)throw new Error('Incompatible SockJS! Main site uses: "'+n+'", the iframe: "'+Wu.version+'".');if(!_a.isOriginEqual(i,_u.href)||!_a.isOriginEqual(a,_u.href))throw new Error("Can't connect to different domain from within an iframe. ("+_u.href+", "+i+", "+a+")");s=new Vu(new Qu[o](i,a));break;case"m":s._send(r.data);break;case"c":s&&s._close(),s=null}}}),vs.postMessage("s")},Bu);"_sockjs_onload"in Ji&&setTimeout(Ji._sockjs_onload,1);var Ku,Zu,ec=Ki(function(e,t){e.exports=function(){var p=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c={V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.2,1.1,1.0"},supportedProtocols:function(){return["v10.stomp","v11.stomp","v12.stomp"]}},s={"v10.stomp":c.V1_0,"v11.stomp":c.V1_1,"v12.stomp":c.V1_2},m={LF:"\n",NULL:"\0"},b=function(e){return e.replace(/^\s+|\s+$/g,"")};function h(e){var t=String.fromCharCode.apply(String,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e)),r=t.replace(/(.)/g,function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r});return decodeURIComponent(r)}function o(){var e=(new Date).getTime(),t=Math.floor(1e3*Math.random());return e+"-"+t}var f=function(){function v(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";p(this,v),this.command=e,this.headers=t,this.body=r}return e(v,[{key:"toString",value:function(){var e,r=this,n=[this.command],t=!1===this.headers["content-length"];return t&&delete this.headers["content-length"],Object.keys(this.headers).forEach(function(e){var t=r.headers[e];n.push(e+":"+t)}),this.body&&!t&&n.push("content-length:"+((e=this.body)?encodeURIComponent(e).match(/%..|./g).length:0)),n.push(m.LF+this.body),n.join(m.LF)}}],[{key:"unmarshallSingle",value:function(e){var t=e.search(new RegExp(m.LF+m.LF)),r=e.substring(0,t).split(m.LF),n=r.shift(),o={},i="",a=t+2,s=!0,u=!1,c=void 0;try{for(var l,p=r.reverse()[Symbol.iterator]();!(s=(l=p.next()).done);s=!0){var h=l.value,f=h.indexOf(":");o[b(h.substring(0,f))]=b(h.substring(f+1))}}catch(e){u=!0,c=e}finally{try{!s&&p.return&&p.return()}finally{if(u)throw c}}if(o["content-length"]){var d=parseInt(o["content-length"],10);i=(""+e).substring(a,a+d)}else for(var g=null,y=a;y<e.length&&(g=e.charAt(y))!==m.NULL;y++)i+=g;return new v(n,o,i)}},{key:"unmarshall",value:function(e){var t=e.split(new RegExp(m.NULL+m.LF+"*")),r=t.slice(0,-1),n=t.slice(-1)[0],o={frames:r.map(function(e){return v.unmarshallSingle(e)}),partial:""};return n===m.LF||-1!==n.search(RegExp(m.NULL+m.LF+"*$"))?o.frames.push(v.unmarshallSingle(n)):o.partial=n,o}},{key:"marshall",value:function(e,t,r){var n=new v(e,t,r);return n.toString()+m.NULL}}]),v}(),n=function(){function l(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};p(this,l);var r=t.binary,n=void 0!==r&&r,o=t.heartbeat,i=void 0===o?{outgoing:1e4,incoming:1e4}:o,a=t.debug,s=void 0===a||a,u=t.protocols,c=void 0===u?[]:u;this.ws=e,this.ws.binaryType="arraybuffer",this.isBinary=!!n,this.hasDebug=!!s,this.connected=!1,this.heartbeat=i||{outgoing:0,incoming:0},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData="",this.protocols=c}return e(l,[{key:"debug",value:function(){var e;this.hasDebug&&(e=console).log.apply(e,arguments)}},{key:"connect",value:function(){var o=this,e=this._parseConnect.apply(this,arguments),t=u(e,3),n=t[0],i=t[1],a=t[2];this.connectCallback=i,this.debug("Opening Web Socket..."),this.ws.onmessage=function(e){var t=e.data;if(e.data instanceof ArrayBuffer&&(t=h(new Uint8Array(e.data))),o.serverActivity=Date.now(),t!==m.LF){o.debug("<<< "+t);var r=f.unmarshall(o.partialData+t);o.partialData=r.partial,r.frames.forEach(function(e){switch(e.command){case"CONNECTED":o.debug("connected to server "+e.headers.server),o.connected=!0,o.version=e.headers.version,o._setupHeartbeat(e.headers),i&&i(e);break;case"MESSAGE":var t=e.headers.subscription,r=o.subscriptions[t]||o.onreceive;if(r){var n=o.version===c.V1_2&&e.headers.ack||e.headers["message-id"];e.ack=o.ack.bind(o,n,t),e.nack=o.nack.bind(o,n,t),r(e)}else o.debug("Unhandled received MESSAGE: "+e);break;case"RECEIPT":o.onreceipt&&o.onreceipt(e);break;case"ERROR":a&&a(e);break;default:o.debug("Unhandled frame: "+e)}})}else o.debug("<<< PONG")},this.ws.onclose=function(e){o.debug("Whoops! Lost connection to "+o.ws.url+":",{event:e}),o._cleanUp(),a&&a(e)},this.ws.onopen=function(){var e,t,r;o.debug("Web Socket Opened..."),n["accept-version"]=(e=o.ws.protocol||o.protocols[0],t=o.debug.bind(o),!(r=s[e])&&t&&t("DEPRECATED: "+e+" is not a recognized STOMP version. In next major client version, this will close the connection."),r||c.V1_2),n["heart-beat"]||(n["heart-beat"]=[o.heartbeat.outgoing,o.heartbeat.incoming].join(",")),o._transmit("CONNECT",n)},this.ws.readyState===this.ws.OPEN&&this.ws.onopen()}},{key:"disconnect",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this._transmit("DISCONNECT",t),this.ws.onclose=null,this.ws.close(),this._cleanUp(),e&&e()}},{key:"send",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({},r);n.destination=e,this._transmit("SEND",n,t)}},{key:"begin",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tx-"+o();return this._transmit("BEGIN",{transaction:e}),{id:e,commit:this.commit.bind(this,e),abort:this.abort.bind(this,e)}}},{key:"commit",value:function(e){this._transmit("COMMIT",{transaction:e})}},{key:"abort",value:function(e){this._transmit("ABORT",{transaction:e})}},{key:"ack",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({},r),o=this.version===c.V1_2?"id":"message-id";n[o]=e,n.subscription=t,this._transmit("ACK",n)}},{key:"nack",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({},r),o=this.version===c.V1_2?"id":"message-id";n[o]=e,n.subscription=t,this._transmit("NACK",n)}},{key:"subscribe",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({},r);return n.id||(n.id="sub-"+o()),n.destination=e,this.subscriptions[n.id]=t,this._transmit("SUBSCRIBE",n),{id:n.id,unsubscribe:this.unsubscribe.bind(this,n.id)}}},{key:"unsubscribe",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},t);delete this.subscriptions[e],r.id=e,this._transmit("UNSUBSCRIBE",r)}},{key:"_cleanUp",value:function(){this.connected=!1,clearInterval(this.pinger),clearInterval(this.ponger)}},{key:"_transmit",value:function(e,t,r){var n=f.marshall(e,t,r);this.debug(">>> "+n,{frame:{command:e,headers:t,body:r}}),this._wsSend(n)}},{key:"_wsSend",value:function(e){var t,r;for(this.isBinary&&(t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}),r=Array.prototype.map.call(t,function(e){return e.charCodeAt(0)}),e=new Uint8Array(r)),this.debug(">>> length "+e.length);;){if(!(e.length>this.maxWebSocketFrameSize))return this.ws.send(e);this.ws.send(e.slice(0,this.maxWebSocketFrameSize)),e=e.slice(this.maxWebSocketFrameSize),this.debug("remaining = "+e.length)}}},{key:"_setupHeartbeat",value:function(e){var t=this;if(this.version===c.V1_1||this.version===c.V1_2){var r=(e["heart-beat"]||"0,0").split(",").map(function(e){return parseInt(e,10)}),n=u(r,2),o=n[0],i=n[1];if(0!==this.heartbeat.outgoing&&0!==i){var a=Math.max(this.heartbeat.outgoing,i);this.debug("send PING every "+a+"ms"),this.pinger=setInterval(function(){t._wsSend(m.LF),t.debug(">>> PING")},a)}if(0!==this.heartbeat.incoming&&0!==o){var s=Math.max(this.heartbeat.incoming,o);this.debug("check PONG every "+s+"ms"),this.ponger=setInterval(function(){var e=Date.now()-t.serverActivity;2*s<e&&(t.debug("did not receive server activity for the last "+e+"ms"),t.ws.close())},s)}}}},{key:"_parseConnect",value:function(){for(var e={},t=void 0,r=void 0,n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];switch(o.length){case 2:e=o[0],t=o[1];break;case 3:o[1]instanceof Function?(e=o[0],t=o[1],r=o[2]):(e.login=o[0],e.passcode=o[1],t=o[2]);break;case 4:e.login=o[0],e.passcode=o[1],t=o[2],r=o[3];break;default:e.login=o[0],e.passcode=o[1],t=o[2],r=o[3],e.host=o[4]}return[e,t,r]}}]),l}();return{Frame:f,VERSIONS:c,client:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=new WebSocket(e,t.protocols||c.supportedProtocols());return new n(r,t)},over:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(n,[null].concat(t)))}}}()}).over,tc={SCHEMA:{target:{"@id":St.target,"@type":"@id"}},is:function(e){return Ie.is(e)&&e.hasOwnProperty("target")}},rc={maxReconnectAttempts:10,reconnectDelay:1e3},nc=function(){function e(e){this.context=e,this._options=rc,this._attempts=0,this._subscriptionsQueue=[]}return e.prototype.setOptions=function(e){this._options=d({},rc,e)},e.prototype.connect=function(e,t){if(this._client){var r=new un("The messaging service is already connect"+(this._client.connected?"ed":"ing")+".");throw t&&t(r),r}this._subscriptionsMap&&this._subscriptionsMap.clear(),this.reconnect(e,t)},e.prototype.reconnect=function(n,o){var i=this;void 0===o&&(o=this.__broadcastError.bind(this)),this._client?this._client.connected&&this._client.disconnect():this._attempts=0,this._subscriptionsMap||(this._subscriptionsMap=new Map);var e=new Ju(this.context.resolve("/broker"));this._client=ec(e,{debug:!1,heartbeat:!1}),this._client.connect({},function(){i._subscriptionsQueue.forEach(function(e){return e()}),i._subscriptionsQueue.length=0,i._attempts=0,n&&n()},function(e){var t,r=null===i._options.maxReconnectAttempts||i._options.maxReconnectAttempts>=i._attempts;if("reason"in e){if(r)return 1==++i._attempts&&i.__saveSubscriptions(),void setTimeout(function(){return i.reconnect(n,o)},i._options.reconnectDelay);i._client=void 0,i._subscriptionsQueue.length=0,t="CloseEventError: "+e.reason}else if("body"in e){if(!i._client||!i._client.connected&&r)return;t=e.headers.message+": "+e.body.trim()}else t="Unknown error: "+e;o(new Error(t))})},e.prototype.subscribe=function(e,t,r){this._client||this.connect(),this._subscriptionsMap.has(e)||this._subscriptionsMap.set(e,new Map);var n=this._subscriptionsMap.get(e);if(!n.has(t)){var o=j.generate();n.set(t,{id:o,errorCallback:r});var i=this.__makeSubscription(o,e,t,r);if(this._client.connected)return i();this._subscriptionsQueue.push(i)}},e.prototype.unsubscribe=function(e,t){if(this._client&&this._subscriptionsMap&&this._subscriptionsMap.has(e)){var r=this._subscriptionsMap.get(e);if(r.has(t)){var n=r.get(t).id;r.delete(t),0===r.size&&this._subscriptionsMap.delete(e),this._client.unsubscribe(n)}}},e.prototype.__broadcastError=function(t){this._subscriptionsMap&&this._subscriptionsMap.forEach(function(e){return e.forEach(function(e){e.errorCallback&&e.errorCallback(t)})})},e.prototype.__makeSubscription=function(e,t,r,n){var o=this;return function(){return o._client.subscribe(t,function(e){(new Et).parse(e.body).then(function(e){var t=xt.getResources(e),r=De.parseFreeNodes(o.context.registry,t).getPointers(!0).find(tc.is);if(!r)throw new Error("No message was returned by the notification.");return r}).then(r).catch(n)},{id:e})}},e.prototype.__saveSubscriptions=function(){var o=this;!this._subscriptionsQueue.length&&this._subscriptionsMap&&this._subscriptionsMap.forEach(function(e,n){return e.forEach(function(e,t){var r=o.__makeSubscription(e.id,n,t,e.errorCallback);o._subscriptionsQueue.push(r)})})},e}(),oc={relatedDocument:{"@id":St.relatedDocument,"@type":"@id"},bNodesMap:{"@id":St.bNodesMap,"@type":"@id"}},ic={TYPE:St.DocumentMetadata,SCHEMA:oc},ac={errorCode:{"@id":St.errorCode,"@type":be.string},errorMessage:{"@id":St.errorMessage,"@language":"en"},errorParameters:{"@id":St.errorParameters,"@type":"@id"}},sc={TYPE:St.Error,SCHEMA:ac},uc={entries:{"@id":St.entry,"@type":"@id","@container":"@set"}},cc={TYPE:St.Map,SCHEMA:uc,is:function(e){return Ie.is(e)&&e.$hasType(cc.TYPE)&&e.hasOwnProperty("entries")}},lc={SCHEMA:{entryKey:{"@id":St.entryKey},entryValue:{"@id":St.entryValue}}},pc={errorDetails:{"@id":St.errorDetails,"@type":"@id"}},hc={TYPE:St.ValidationError,SCHEMA:pc},fc={TYPE:St.ChildCreatedEvent,SCHEMA:d({},tc.SCHEMA,{details:{"@id":St.details,"@type":"@id"}})},dc={createdDocuments:{"@id":St.createdDocument,"@type":"@id","@container":"@set"}},gc={TYPE:St.DocumentCreatedEventDetails,SCHEMA:dc},yc={TYPE:St.DocumentDeletedEvent,SCHEMA:tc.SCHEMA},vc={TYPE:St.DocumentModifiedEvent,SCHEMA:tc.SCHEMA},mc={TYPE:St.MemberAddedEvent,SCHEMA:d({},tc.SCHEMA,{details:{"@id":St.details,"@type":"@id"}})},bc={SCHEMA:{members:{"@id":St.member,"@type":"@id","@container":"@set"}}},wc={TYPE:St.MemberAddedEventDetails,SCHEMA:bc.SCHEMA},_c={TYPE:St.MemberRemovedEvent,SCHEMA:d({},tc.SCHEMA,{details:{"@id":St.details,"@type":"@id"}})},Pc={TYPE:St.MemberRemovedEventDetails,SCHEMA:bc.SCHEMA},Tc={namespace:"http://www.w3.org/ns/shacl#",ValidationReport:"http://www.w3.org/ns/shacl#ValidationReport",ValidationResult:"http://www.w3.org/ns/shacl#ValidationResult",conforms:"http://www.w3.org/ns/shacl#conforms",detail:"http://www.w3.org/ns/shacl#detail",focusNode:"http://www.w3.org/ns/shacl#focusNode",result:"http://www.w3.org/ns/shacl#result",resultMessage:"http://www.w3.org/ns/shacl#resultMessage",resultPath:"http://www.w3.org/ns/shacl#resultPath",resultSeverity:"http://www.w3.org/ns/shacl#resultSeverity",shapesGraphWellFormed:"http://www.w3.org/ns/shacl#shapesGraphWellFormed",sourceConstraintComponent:"http://www.w3.org/ns/shacl#sourceConstraintComponent",sourceShape:"http://www.w3.org/ns/shacl#sourceShape",value:"http://www.w3.org/ns/shacl#value"},Ec={conforms:{"@id":Tc.conforms,"@type":be.boolean},results:{"@id":Tc.result,"@type":"@id","@container":"@set"},shapesGraphWellFormed:{"@id":Tc.shapesGraphWellFormed,"@type":be.boolean}},Sc={TYPE:Tc.ValidationReport,SCHEMA:Ec},Oc={focusNode:{"@id":Tc.focusNode,"@type":"@id"},resultPath:{"@id":Tc.resultPath,"@type":"@id"},value:{"@id":Tc.value},sourceShape:{"@id":Tc.sourceShape,"@type":"@id"},sourceConstraintComponent:{"@id":Tc.sourceConstraintComponent,"@type":"@id"},detail:{"@id":Tc.detail,"@type":"@id"},resultMessage:{"@id":Tc.resultMessage,"@type":be.string},resultSeverity:{"@id":Tc.resultSeverity,"@type":"@id"}},Cc={TYPE:Tc.ValidationResult,SCHEMA:Oc},xc={buildDate:{"@id":St.buildDate,"@type":be.dateTime},version:{"@id":St.version,"@type":be.string}},Rc={TYPE:St.PlatformInstance,SCHEMA:xc},jc={instance:{"@id":St.instance,"@type":"@id"}},Fc={TYPE:St.Platform,SCHEMA:jc},Ic=function(t){function e(){var e=t.call(this,void 0)||this;return e._baseURI="",e._generalObjectSchema=new xe,e.registry=or.createFrom({context:e,__modelDecorator:Re}),e.__registerDefaultObjectSchemas(),e.__registerDefaultDecorators(),e}return i(e,t),e.prototype.__registerDefaultObjectSchemas=function(){this.extendObjectSchema(Qt).extendObjectSchema(Fc).extendObjectSchema(Rc).extendObjectSchema(ii).extendObjectSchema(si).extendObjectSchema(sc).extendObjectSchema(cc).extendObjectSchema(lc.SCHEMA).extendObjectSchema(ic).extendObjectSchema(Ct).extendObjectSchema(ci).extendObjectSchema(hc).extendObjectSchema(Sc).extendObjectSchema(Cc).extendObjectSchema(Jo).extendObjectSchema(fc).extendObjectSchema(gc).extendObjectSchema(yc).extendObjectSchema(vc).extendObjectSchema(mc).extendObjectSchema(wc).extendObjectSchema(_c).extendObjectSchema(Pc)},e.prototype.__registerDefaultDecorators=function(){},e.instance=new e,e}(tr),Dc=function(r){function u(e){var t=r.call(this,Ic.instance)||this;return t._baseURI=e,t.registry=ir.createFrom({context:t}),t.repository=Qi.createFrom({context:t}),t.messaging=new nc(t),t}return i(u,r),u.__mergePaths=function(e,t){if(!t)return e;if(!e)return C.clone(t,{objects:!0});for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r],i=t[o];if(null!==i){var a=e[o];if(a){if(T(i))E(a)?a.slug=i:e[o]=i;else if(void 0!==i.slug||void 0!==i.paths){var s=T(a)?e[o]={slug:a}:a;void 0!==i.slug&&(s.slug=i.slug),void 0!==i.paths&&(s.paths=u.__mergePaths(s.paths,i.paths))}}else e[o]=E(i)?C.clone(i,{objects:!0}):i}else delete e[o]}return e},u.prototype._resolvePath=function(e){for(var t=e.split("."),r=[],n="",o=this._settings&&this._settings.paths;t.length;){var i=t.shift();r.push(i);var a=o?o[i]:null;if(!a)throw new un('The path "'+r.join(".")+"\" hasn't been declared.");var s=T(a)?a:a.slug;if(!s)throw new un('The path "'+r.join(".")+"\" doesn't have a slug set.");n=k.resolve(n,s),o=E(a)?a.paths:void 0}return this.resolve(n)},u.prototype._extendPaths=function(e){this._settings.paths=u.__mergePaths(this._settings.paths,e)},u.prototype._extendsSettings=function(e){this._extendPaths(e.paths),delete e.paths,C.extend(this._settings,e)},u}(tr),Ac=Object.freeze({AbstractError:A,IDAlreadyInUseError:L,IllegalActionError:Ao,IllegalArgumentError:M,IllegalStateError:un,InvalidJSONLDSyntaxError:Me,NotImplementedError:ke});(Zu=Ku||(Ku={}))[Zu.CONTINUE=100]="CONTINUE",Zu[Zu.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",Zu[Zu.OK=200]="OK",Zu[Zu.CREATED=201]="CREATED",Zu[Zu.ACCEPTED=202]="ACCEPTED",Zu[Zu.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",Zu[Zu.NO_CONTENT=204]="NO_CONTENT",Zu[Zu.RESET_CONTENT=205]="RESET_CONTENT",Zu[Zu.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",Zu[Zu.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",Zu[Zu.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",Zu[Zu.FOUND=302]="FOUND",Zu[Zu.SEE_OTHER=303]="SEE_OTHER",Zu[Zu.NOT_MODIFIED=304]="NOT_MODIFIED",Zu[Zu.USE_PROXY=305]="USE_PROXY",Zu[Zu.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",Zu[Zu.BAD_REQUEST=400]="BAD_REQUEST",Zu[Zu.UNAUTHORIZED=401]="UNAUTHORIZED",Zu[Zu.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",Zu[Zu.FORBIDDEN=403]="FORBIDDEN",Zu[Zu.NOT_FOUND=404]="NOT_FOUND",Zu[Zu.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",Zu[Zu.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",Zu[Zu.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",Zu[Zu.REQUEST_TIME_OUT=408]="REQUEST_TIME_OUT",Zu[Zu.CONFLICT=409]="CONFLICT",Zu[Zu.GONE=410]="GONE",Zu[Zu.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",Zu[Zu.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",Zu[Zu.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",Zu[Zu.REQUEST_URI_TOO_LARGE=414]="REQUEST_URI_TOO_LARGE",Zu[Zu.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",Zu[Zu.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",Zu[Zu.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",Zu[Zu.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",Zu[Zu.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",Zu[Zu.BAD_GATEWAY=502]="BAD_GATEWAY",Zu[Zu.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",Zu[Zu.GATEWAY_TIME_OUT=504]="GATEWAY_TIME_OUT",Zu[Zu.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED";var Mc=Object.freeze({Errors:ht,Header:ft,get HTTPMethod(){return lt},JSONParser:Ae,RequestService:wt,RequestUtils:_t,Response:dt,get StatusCode(){return Ku},StringParser:ti}),kc=Object.freeze({JSONLDConverter:Se,JSONLDParser:Et,JSONLDProcessor:Tt,_guessXSDType:Ee}),Lc={TYPE:Jt.TYPE,is:function(e){return Jt.is(e)&&Qt.is(e)},create:Jt.create,createFrom:Jt.createFrom},Nc=Object.freeze({AddMemberAction:ii,Error:sc,Map:cc,MapEntry:lc,DirectContainer:Lc,TransientDirectContainer:Jt,DocumentMetadata:ic,ErrorResponse:Ct,RemoveMemberAction:si,ResponseMetadata:ci,ValidationError:hc,VolatileResource:Xo}),$c=Object.freeze({DeltaCreator:vi,LDPatchToken:li,PrefixToken:pi,AddToken:hi,DeleteToken:fi,UpdateListToken:di,SliceToken:gi}),Uc=Object.freeze({ChildCreatedEvent:fc,DocumentCreatedEventDetails:gc,DocumentDeletedEvent:yc,DocumentModifiedEvent:vc,get Event(){return It},EventMessage:tc,MemberAddedEvent:mc,MemberAddedEventDetails:wc,MemberEventDetails:bc,MemberRemovedEvent:_c,MemberRemovedEventDetails:Pc,MessagingService:nc,_validateEventType:cr,_parseURIPattern:lr,_createDestination:pr}),qc=Object.freeze({RDFDocument:xt,RDFList:Q,Serializers:we,RDFLiteral:_e,RDFNode:Pe,URI:k,RDFValue:Te}),Yc=Object.freeze({ValidationReport:Sc,ValidationResult:Cc}),Vc=Object.freeze({SPARQLService:ni,SPARQLBuilder:Wi,SPARQLRawResultsParser:ri}),Hc=Object.freeze({PlatformMetadata:Fc,PlatformInstance:Rc}),Bc=Object.freeze({C:St,LDP:Nt,RDF:{namespace:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"},SHACL:Tc,XSD:be});return function(o){function e(e){var t,r,n=o.call(this,T(t=e)?function(e){if(!k.hasProtocol(e))throw new M('The URL must contain a valid protocol: "http://", "https://".');return e.endsWith("/")?e:e+"/"}(t):function(e){if(!T(e.host))throw new M("The settings object must contains a valid host string.");if(a(e.host))throw new M("The host must not contain a protocol.");if(e.host.includes(":"))throw new M("The host must not contain a port.");var t=!1===e.ssl?"http://":"https://",r=e.host.endsWith("/")?e.host.slice(0,-1):e.host,n=""+t+r+"/";return f(e.port)?n.slice(0,-1)+":"+e.port+"/":n}(t))||this;return n._settings={vocabulary:"vocabularies/main/#",paths:{system:{slug:".system/",paths:{platform:"platform/",credentials:"credentials/",roles:"roles/"}},users:{slug:"users/",paths:{me:"me/"}}}},n._extendsSettings(T(r=e)?{}:Object.assign({},r,{ssl:null,host:null,port:null})),n.documents=n.registry.getPointer(n._baseURI,!0),n}return i(e,o),Object.defineProperty(e,"version",{get:function(){return"5.2.0"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return e.version},enumerable:!0,configurable:!0}),e.prototype.getPlatformMetadata=function(){var t=this;return S(function(){var e=t._resolvePath("system.platform");return t.documents.$get(e)})},e.AbstractContext=tr,e.AccessPoint=Zt,e.TransientAccessPoint=Kt,e.Errors=Ac,e.FreeResources=De,e.HTTP=Mc,e.JSONLD=kc,e.LDP=Nc,e.LDPatch=$c,e.Messaging=Uc,e.Vocabularies=Bc,e.ObjectSchemaUtils=Ce,e.ObjectSchemaDigester=Pt,e.DigestedObjectSchemaProperty=Oe,e.PointerType=mt,e.ContainerType=z,e.DigestedObjectSchema=xe,e.Document=Qt,e.Fragment=Lt,e.TransientFragment=kt,e.Pointer=N,e.RDF=qc,e.Resource=Ie,e.GlobalContext=Ic,e.SHACL=Yc,e.SPARQL=Vc,e.System=Hc,e.Utils=I,e}(Dc)});