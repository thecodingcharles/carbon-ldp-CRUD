{"version":3,"sources":["Resource/Resource.ts"],"names":[],"mappings":"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","file":"Resource.js","sourcesContent":["import { Context } from \"../Context/Context\";\n\nimport { GeneralRegistry } from \"../GeneralRegistry/GeneralRegistry\";\n\nimport { JSONLDConverter } from \"../JSONLD/JSONLDConverter\";\n\nimport { ModelDecorator } from \"../Model/ModelDecorator\";\nimport { ModelFactoryOptional } from \"../Model/ModelFactoryOptional\";\nimport { ModelPrototype } from \"../Model/ModelPrototype\";\nimport { ModelTypeGuard } from \"../Model/ModelTypeGuard\";\n\nimport { DigestedObjectSchema } from \"../ObjectSchema/DigestedObjectSchema\";\n\nimport { Pointer } from \"../Pointer/Pointer\";\n\nimport { RDFNode } from \"../RDF/Node\";\nimport { URI } from \"../RDF/URI\";\n\nimport { RegisteredPointer } from \"../Registry/RegisteredPointer\";\nimport { $Registry, Registry } from \"../Registry/Registry\";\n\nimport { isObject } from \"../Utils\";\n\nimport { BaseResource } from \"./BaseResource\";\n\n\n/**\n * Interface that represents any resource in the SDK.\n */\nexport interface Resource extends RegisteredPointer {\n\t/**\n\t * Types of the resource.\n\t */\n\ttypes:string[];\n\n\t/**\n\t * Optional associated registry of the resource.\n\t */\n\t$registry:Registry<RegisteredPointer> | $Registry<RegisteredPointer> | undefined;\n\t/**\n\t * Slug of the URI of the resource.\n\t * Depending of the URI, the value returned would be:\n\t * 1. For blank nodes the same $id of the resource would be returned\n\t * 2. For named fragments, the content after the `#` symbol would be returned\n\t * 3. For documents, it's the last part URI e.g. `https://example.com/resource-1/` => `resource-1`\n\t */\n\t$slug:string;\n\n\n\t/**\n\t * Adds a type to the current resource.\n\t * @param type The type to be added.\n\t */\n\t$addType( type:string ):void;\n\n\t/**\n\t * Returns true if the current resource contains the type specified.\n\t * @param type The type to look for.\n\t */\n\t$hasType( type:string ):boolean;\n\n\t/**\n\t * Remove the type specified from the current resource.\n\t * @param type The type to be removed.\n\t */\n\t$removeType( type:string ):void;\n\n\n\t/**\n\t * Returns the JSON-LD Node representation of the current resource.\n\t * @param contextOrKey A specific context to use for expand the data into JSON-LD Node instead of the internal one.\n\t */\n\ttoJSON( contextOrKey?:Context | string ):RDFNode;\n}\n\n\nfunction __getContext( registry:$Registry<any> | Registry<any> | GeneralRegistry<any> | undefined ):Context | undefined {\n\tif( ! registry ) return;\n\tif( \"context\" in registry && registry.context ) return registry.context;\n\n\treturn __getContext( \"$id\" in registry ? registry.$registry : registry.registry );\n}\n\nfunction __resolveURI( resource:Resource, uri:string ):string {\n\tif( URI.isAbsolute( uri ) ) return uri;\n\n\tconst context:Context | undefined = __getContext( resource.$registry );\n\tif( ! context ) return uri;\n\n\treturn context\n\t\t.getObjectSchema()\n\t\t.resolveURI( uri, { vocab: true } );\n}\n\n/**\n * Factory, decorator and utils for {@link Resource}.\n */\nexport type ResourceFactory =\n\t& ModelPrototype<Resource, RegisteredPointer>\n\t& ModelDecorator<Resource, BaseResource>\n\t& ModelFactoryOptional<Resource>\n\t& ModelTypeGuard<Resource>\n\t;\n\n/**\n * Constant that implements {@link ResourceFactory}.\n */\nexport const Resource:ResourceFactory = {\n\tPROTOTYPE: {\n\t\tget types():string[] { return []; },\n\n\t\tget $slug( this:Resource ):string {\n\t\t\tif( URI.isBNodeID( this.$id ) ) return this.$id;\n\t\t\treturn URI.getSlug( this.$id );\n\t\t},\n\t\tset $slug( this:Resource, slug:string ) {},\n\n\n\t\t$addType( this:Resource, type:string ):void {\n\t\t\ttype = __resolveURI( this, type );\n\n\t\t\tif( this.types.indexOf( type ) !== - 1 ) return;\n\n\t\t\tthis.types.push( type );\n\t\t},\n\n\t\t$hasType( this:Resource, type:string ):boolean {\n\t\t\ttype = __resolveURI( this, type );\n\t\t\treturn this.types.indexOf( type ) !== - 1;\n\t\t},\n\n\t\t$removeType( this:Resource, type:string ):void {\n\t\t\ttype = __resolveURI( this, type );\n\n\t\t\tconst index:number = this.types.indexOf( type );\n\t\t\tif( index !== - 1 ) this.types.splice( index, 1 );\n\t\t},\n\n\n\t\ttoJSON( this:Resource, contextOrKey?:Context | string ):RDFNode {\n\t\t\tconst context:Context | undefined = typeof contextOrKey === \"object\" ?\n\t\t\t\tcontextOrKey : __getContext( this.$registry );\n\n\t\t\tconst generalSchema:DigestedObjectSchema = context ?\n\t\t\t\tcontext.registry.getGeneralSchema() : new DigestedObjectSchema();\n\n\t\t\tconst resourceSchema:DigestedObjectSchema = context && context.registry ?\n\t\t\t\tcontext.registry.getSchemaFor( this ) : generalSchema;\n\n\t\t\tconst jsonldConverter:JSONLDConverter = context ?\n\t\t\t\tcontext.jsonldConverter : new JSONLDConverter();\n\n\t\t\treturn jsonldConverter.expand( this, generalSchema, resourceSchema );\n\t\t},\n\t},\n\n\tisDecorated( object:object ):object is Resource {\n\t\treturn isObject( object )\n\t\t\t&& ModelDecorator\n\t\t\t\t.hasPropertiesFrom( Resource.PROTOTYPE, object );\n\t},\n\n\tis( value:any ):value is Resource {\n\t\treturn Pointer.is( value )\n\t\t\t&& Resource.isDecorated( value );\n\t},\n\n\tcreate<T extends object>( data?:T & BaseResource ):T & Resource {\n\t\tconst clone:T = Object.assign( {}, data );\n\t\treturn Resource.createFrom<T>( clone );\n\t},\n\n\tcreateFrom<T extends object>( object:T & BaseResource ):T & Resource {\n\t\treturn Resource.decorate<T>( object );\n\t},\n\n\tdecorate<T extends BaseResource>( object:T ):T & Resource {\n\t\tif( Resource.isDecorated( object ) ) return object;\n\n\t\tif( ! object.hasOwnProperty( \"$registry\" ) ) object.$registry = void 0;\n\n\t\tconst resource:T & RegisteredPointer = ModelDecorator\n\t\t\t.decorateMultiple( object as T & { $registry:undefined }, RegisteredPointer );\n\n\t\treturn ModelDecorator\n\t\t\t.definePropertiesFrom( Resource.PROTOTYPE, resource );\n\t},\n};\n"],"sourceRoot":"../../src"}